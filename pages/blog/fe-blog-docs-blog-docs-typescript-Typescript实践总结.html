<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="referrer" content="no-referrer">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typescript实践总结 - FrontendHub</title>
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="../../css/content.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="content-page">
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <a href="../../index.html" style="color: inherit; text-decoration: none; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-code"></i>
                    <span>FrontendHub</span>
                </a>
            </div>
            <button class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-menu" id="navMenu">
                <li><a href="../../index.html">首页</a></li>
                <li><a href="../index.html#features">特色</a></li>
                <li><a href="../index.html#courses">课程</a></li>
                <li><a href="../index.html#resources">资源</a></li>
            </ul>
        </div>
    </nav>

    <!-- 面包屑导航 -->
    <div class="breadcrumb">
        <div class="container">
            <a href="../../index.html"><i class="fas fa-home"></i> 首页</a>
            <i class="fas fa-chevron-right"></i>
            <span>Typescript实践总结</span>
        </div>
    </div>

    <!-- 主要内容区 -->
    <main class="content-main">
        <div class="container">
            <div class="content-layout">
                <!-- 侧边栏目录 -->
                <aside class="sidebar">
                    <div class="sidebar-sticky">
                        <h3><i class="fas fa-list"></i> 目录</h3>
                        <nav class="toc" id="toc">
                            <!-- 目录将通过JavaScript自动生成 -->
                        </nav>
                    </div>
                </aside>

                <!-- 文章内容 -->
                <article class="article">
                    <header class="article-header">
                        <h1>Typescript实践总结</h1>
                        <div class="article-meta">
                            <span><i class="far fa-calendar"></i> 更新时间：2025-12-23</span>
                            <span><i class="far fa-clock"></i> 阅读时长：约 15 分钟</span>
                        </div>
                    </header>

                    <div class="article-content">
<div class="content__default"><h1 id="第一章-基础篇"><a href="#第一章-基础篇" class="header-anchor">#</a> 第一章 基础篇</h1> <blockquote><p>TS基础篇</p></blockquote> <p><img src="https://s.poetries.top/gitee/20190903/base-1.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/base-2.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/base-3.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/base-4.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/base-5.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/base-6.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/base-7.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/base-8.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/base-9.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/base-10.webp" alt=""></p> <h2 id="一、基本类型"><a href="#一、基本类型" class="header-anchor">#</a> 一、基本类型</h2> <ul><li><code>JavaScript</code> 的类型分为两种：原始数据类型和对象类型。</li> <li>原始数据类型包括：布尔值、数值、字符串、<code>null</code>、<code>undefined</code> 以及 ES6 中的新类型 <code>Symbol</code></li> <li>本节主要介绍前五种原始数据类型在 <code>TypeScript</code> 中的应用。</li> <li>布尔值是最基础的数据类型，在 <code>TypeScript</code> 中，使用 <code>boolean</code> 定义布尔值类型</li></ul> <p><strong>ES6数据类型</strong></p> <ul><li><code>Boolean</code></li> <li><code>Number</code></li> <li><code>String</code></li> <li><code>Array</code></li> <li><code>Function</code></li> <li><code>Object</code></li> <li><code>Symbol</code></li> <li><code>undefined</code></li> <li><code>null</code></li></ul> <p><strong>Typescript数据类型</strong></p> <ul><li><code>Boolean</code></li> <li><code>Number</code></li> <li><code>String</code></li> <li><code>Array</code></li> <li><code>Function</code></li> <li><code>Object</code></li> <li><code>Symbol</code></li> <li><code>undefined</code></li> <li><code>null</code></li> <li><code>void</code></li> <li><code>any</code></li> <li><code>never</code></li> <li>元组</li> <li>枚举</li> <li>高级类型</li></ul> <p><strong>正确的写法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>➖➖➖➖➖➖➖➖➖布尔➖➖➖➖➖➖➖➖➖
<span class="token comment">// 布尔值</span>
<span class="token keyword">let</span> <span class="token literal-property property">isDone</span><span class="token operator">:</span> boolean <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  

<span class="token comment">// 事实上 `new Boolean()` 返回的是一个 `Boolean` 对象</span>
<span class="token keyword">let</span> <span class="token literal-property property">createdByNewBoolean</span><span class="token operator">:</span> Boolean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Boolean</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//(直接调用 `Boolean` 也可以返回一个 `boolean` 类型) </span>
<span class="token keyword">let</span> <span class="token literal-property property">createdByBoolean</span><span class="token operator">:</span> boolean <span class="token operator">=</span> <span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

➖➖➖➖➖➖➖➖➖数值➖➖➖➖➖➖➖➖➖
<span class="token comment">// 数值</span>
<span class="token keyword">let</span> <span class="token literal-property property">decLiteral</span><span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token literal-property property">hexLiteral</span><span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">0xf00d</span><span class="token punctuation">;</span>

<span class="token comment">// ES6 中的二进制表示法</span>
<span class="token keyword">let</span> <span class="token literal-property property">binaryLiteral</span><span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">0b1010</span><span class="token punctuation">;</span>

<span class="token comment">// ES6 中的八进制表示法</span>
<span class="token keyword">let</span> <span class="token literal-property property">octalLiteral</span><span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">0o744</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token literal-property property">notANumber</span><span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">NaN</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token literal-property property">infinityNumber</span><span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">Infinity</span><span class="token punctuation">;</span>
➖➖➖➖➖➖➖➖➖字符串➖➖➖➖➖➖➖➖➖
<span class="token keyword">let</span> <span class="token literal-property property">myName</span><span class="token operator">:</span> string <span class="token operator">=</span> <span class="token string">'Tom'</span><span class="token punctuation">;</span>
➖➖➖➖➖➖➖➖➖空值➖➖➖➖➖➖➖➖➖
<span class="token comment">// 没有返回值的函数为void</span>
<span class="token keyword">function</span> <span class="token function">alertName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'My name is Tom'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//声明一个 void 类型的只能将它赋值为 undefined 和 null</span>
<span class="token keyword">let</span> <span class="token literal-property property">unusable</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
➖➖➖➖➖➖➖➖➖Null 和 Undefined➖➖➖➖➖➖➖➖➖
<span class="token comment">// undefined 类型的变量只能被赋值为 undefined，null 类型的变量只能被赋值为 null</span>
<span class="token keyword">let</span> <span class="token literal-property property">u</span><span class="token operator">:</span> <span class="token keyword">undefined</span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token literal-property property">n</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>错误的写法</strong></p> <blockquote><p>注意:正确的很好记,大多数人都会写正确的,关键是要记住这些错误的!!!</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>➖➖➖➖➖➖➖➖➖布尔➖➖➖➖➖➖➖➖➖
<span class="token comment">// 注意，使用构造函数 `Boolean` 创造的对象不是布尔值</span>
<span class="token keyword">let</span> <span class="token literal-property property">createdByNewBoolean</span><span class="token operator">:</span> boolean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Boolean</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>❌

➖➖➖➖➖➖➖➖➖数值➖➖➖➖➖➖➖➖➖
<span class="token keyword">let</span> <span class="token literal-property property">decLiteral</span><span class="token operator">:</span> number <span class="token operator">=</span> <span class="token string">"6"</span><span class="token punctuation">;</span>❌

➖➖➖➖➖➖➖➖➖字符串➖➖➖➖➖➖➖➖➖
<span class="token keyword">let</span> <span class="token literal-property property">myName</span><span class="token operator">:</span> string <span class="token operator">=</span> <span class="token number">999</span><span class="token punctuation">;</span>❌

➖➖➖➖➖➖➖➖➖空值➖➖➖➖➖➖➖➖➖
<span class="token comment">// 没有返回值的函数为void</span>
<span class="token keyword">function</span> <span class="token function">alertName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>❌
   <span class="token keyword">return</span> <span class="token number">666</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//声明一个 void 类型的只能将它赋值为 undefined 和 null</span>
<span class="token keyword">let</span> <span class="token literal-property property">unusable</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token operator">=</span> <span class="token string">'I love you'</span><span class="token punctuation">;</span>❌

➖➖➖➖➖➖➖➖➖Null 和 Undefined➖➖➖➖➖➖➖➖➖
<span class="token comment">// undefined 类型的变量只能被赋值为 undefined，null 类型的变量只能被赋值为 null</span>
<span class="token keyword">let</span> <span class="token literal-property property">u</span><span class="token operator">:</span> <span class="token keyword">undefined</span> <span class="token operator">=</span> <span class="token number">888</span><span class="token punctuation">;</span>❌
<span class="token keyword">let</span> <span class="token literal-property property">n</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token number">999</span><span class="token punctuation">;</span>❌
</code></pre></div><h2 id="二、任意值"><a href="#二、任意值" class="header-anchor">#</a> 二、任意值</h2> <p><strong>正确的写法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 顾名思义,可以被任何值赋值</span>
<span class="token keyword">let</span> <span class="token literal-property property">anyThing</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token literal-property property">anyThing</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token number">888</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token literal-property property">anyThing</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token literal-property property">anyThing</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token literal-property property">anyThing</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>

<span class="token comment">// 变量如果在声明的时候，未指定其类型，那么它会被识别为任意值类型：</span>
<span class="token keyword">let</span> any<span class="token punctuation">;</span>
any <span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="三、类型推论"><a href="#三、类型推论" class="header-anchor">#</a> 三、类型推论</h2> <p><strong>正确的写法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 如果没有明确的指定类型，那么 TypeScript 会依照类型推论（Type Inference）的规则推断出一个类型。</span>
<span class="token keyword">let</span> myFavoriteNumber <span class="token operator">=</span> <span class="token string">'seven'</span><span class="token punctuation">;</span>  
<span class="token comment">//等价于</span>
<span class="token keyword">let</span> <span class="token literal-property property">myFavoriteNumber</span> <span class="token operator">:</span>string<span class="token operator">=</span> <span class="token string">'seven'</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>错误的写法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 第一句已经被推论为String类型了</span>
<span class="token keyword">let</span> myFavoriteNumber <span class="token operator">=</span> <span class="token string">'seven'</span><span class="token punctuation">;</span>
myFavoriteNumber <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>❌
</code></pre></div><h2 id="四、联合类型"><a href="#四、联合类型" class="header-anchor">#</a> 四、联合类型</h2> <p><strong>正确的写法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 联合类型（Union Types）表示取值可以为多种类型中的一种。</span>
<span class="token comment">// 当你允许某个变量被赋值多种类型的时候,使用联合类型,管道符进行连接</span>
<span class="token keyword">let</span> <span class="token literal-property property">myFavoriteNumber</span><span class="token operator">:</span> string <span class="token operator">|</span> number<span class="token punctuation">;</span>
myFavoriteNumber <span class="token operator">=</span> <span class="token string">'seven'</span><span class="token punctuation">;</span>
myFavoriteNumber <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>

<span class="token comment">// 也可用于方法的参数定义, 都有toString方法,访问 string 和 number 的共有属性是没问题的</span>
<span class="token keyword">function</span> <span class="token function">getString</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">something</span><span class="token operator">:</span> string <span class="token operator">|</span> number</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
    <span class="token keyword">return</span> something<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>错误的写法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// number类型没有length属性.所以编译错误,因为我们只能访问此联合类型的所有类型里共有的属性或方法：</span>
<span class="token keyword">function</span> <span class="token function">getLength</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">something</span><span class="token operator">:</span> string <span class="token operator">|</span> number</span><span class="token punctuation">)</span><span class="token operator">:</span> number <span class="token punctuation">{</span>❌
    <span class="token keyword">return</span> something<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="五、对象的类型-接口"><a href="#五、对象的类型-接口" class="header-anchor">#</a> 五、对象的类型——接口</h2> <p><strong>正确的写法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 赋值的时候，变量的形状必须和接口的形状保持一致(不能多也不能少,类型还必须一致)</span>
<span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token literal-property property">tom</span><span class="token operator">:</span> Person <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Tom'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


IUserInfo<span class="token punctuation">{</span>
  <span class="token literal-property property">age</span> <span class="token operator">:</span> any<span class="token punctuation">;</span><span class="token comment">//定义一个任何变量的 age.</span>
  <span class="token literal-property property">userName</span> <span class="token operator">:</span>string<span class="token punctuation">;</span><span class="token comment">//定义一个 username.</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">user</span> <span class="token operator">:</span> IUserInfo</span><span class="token punctuation">)</span><span class="token operator">:</span>string<span class="token punctuation">{</span>
    <span class="token keyword">return</span> user<span class="token punctuation">.</span>age<span class="token operator">+</span><span class="token string">"======"</span><span class="token operator">+</span>user<span class="token punctuation">.</span>userName<span class="token punctuation">;</span> 	
<span class="token punctuation">}</span>
  ➖➖➖➖➖➖➖➖➖可选属性➖➖➖➖➖➖➖➖➖

<span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    age<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">;</span> <span class="token comment">// 表示这个属性可有可无</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token literal-property property">tom</span><span class="token operator">:</span> Person <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Tom'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 可索引签名</span>
<span class="token keyword">interface</span> <span class="token class-name">StringArrary</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token operator">:</span> string <span class="token comment">// 数字索引。通过数字索引，返回string类型</span>
  <span class="token punctuation">[</span>string<span class="token punctuation">]</span><span class="token operator">:</span> string <span class="token comment">// 字符串索引签名。两者不能混用，一起使用的前提是数字索引是字符串索引的子集</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token literal-property property">myArr</span><span class="token operator">:</span> StringArrary
myArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'test1'</span><span class="token punctuation">,</span><span class="token string">'test2'</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> myString <span class="token operator">=</span> myArr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>


  ➖➖➖➖➖➖➖➖➖任意属性➖➖➖➖➖➖➖➖➖

<span class="token comment">//希望一个接口允许有任意的属性，可以使用如下方式：旦定义了任意属性，那么确定属性和可选属性的类型都必须是它的类型的子集</span>
<span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    age<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
    <span class="token punctuation">[</span>propName<span class="token operator">:</span> string<span class="token punctuation">]</span><span class="token operator">:</span> any<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token literal-property property">tom</span><span class="token operator">:</span> Person <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Tom'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">gender</span><span class="token operator">:</span> <span class="token string">'male'</span> <span class="token comment">// 可以加其他的属性</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

➖➖➖➖➖➖➖➖➖只读属性➖➖➖➖➖➖➖➖➖
<span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    readonly id<span class="token operator">:</span> number<span class="token punctuation">;</span> <span class="token comment">// </span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    age<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
    <span class="token punctuation">[</span>propName<span class="token operator">:</span> string<span class="token punctuation">]</span><span class="token operator">:</span> any<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token literal-property property">tom</span><span class="token operator">:</span> Person <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">89757</span><span class="token punctuation">,</span> <span class="token comment">// 只读</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Tom'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">gender</span><span class="token operator">:</span> <span class="token string">'male'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>错误的写法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 一旦定义了任意属性，那么确定属性和可选属性的类型都必须是它的类型的子集</span>
<span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    age<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
    <span class="token punctuation">[</span>propName<span class="token operator">:</span> string<span class="token punctuation">]</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token literal-property property">tom</span><span class="token operator">:</span> Person <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Tom'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span>
    <span class="token literal-property property">gender</span><span class="token operator">:</span> <span class="token string">'male'</span>❌
<span class="token punctuation">}</span><span class="token punctuation">;</span>
上例中，任意属性的值允许是 string，但是可选属性 age 的值却是 number，number 不是 string 的子属性，所以报错了。

➖➖➖➖➖➖➖➖➖只读属性➖➖➖➖➖➖➖➖➖
<span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    readonly id<span class="token operator">:</span> number<span class="token punctuation">;</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    age<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
    <span class="token punctuation">[</span>propName<span class="token operator">:</span> string<span class="token punctuation">]</span><span class="token operator">:</span> any<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token literal-property property">tom</span><span class="token operator">:</span> Person <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Tom'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">gender</span><span class="token operator">:</span> <span class="token string">'male'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

tom<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">89757</span><span class="token punctuation">;</span> <span class="token comment">// 不能被二次赋值❌</span>
</code></pre></div><p><strong>数组只读属性</strong></p> <div class="language- extra-class"><pre class="language-text"><code>let myARr:readonlyArrary&lt;number&gt; = [1,2,3]
</code></pre></div><h2 id="六、数组的类型"><a href="#六、数组的类型" class="header-anchor">#</a> 六、数组的类型</h2> <p><strong>正确的做法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token literal-property property">fibonacci</span><span class="token operator">:</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token literal-property property">fibonacci</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>number<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

➖➖➖➖➖➖➖➖➖用接口表示数组➖➖➖➖➖➖➖➖➖
<span class="token keyword">interface</span> <span class="token class-name">NumberArray</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>index<span class="token operator">:</span> number<span class="token punctuation">]</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> <span class="token literal-property property">fibonacci</span><span class="token operator">:</span> NumberArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

➖➖➖➖➖➖➖➖➖any 在数组中的应用➖➖➖➖➖➖➖➖➖
<span class="token keyword">let</span> <span class="token literal-property property">list</span><span class="token operator">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Xcat Liu'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">website</span><span class="token operator">:</span> <span class="token string">'http://xcatliu.com'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

➖➖➖➖➖➖➖➖➖类数组➖➖➖➖➖➖➖➖➖
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token literal-property property">args</span><span class="token operator">:</span> IArguments <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>错误的做法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 数组的项中不允许出现其他的类型：</span>
<span class="token keyword">let</span> <span class="token literal-property property">fibonacci</span><span class="token operator">:</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>❌

<span class="token comment">// push 方法只允许传入 number 类型的参数，但是却传了一个 string 类型的参数，所以报错了。</span>
<span class="token keyword">let</span> <span class="token literal-property property">fibonacci</span><span class="token operator">:</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
fibonacci<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>❌


<span class="token comment">// 类数组（Array-like Object）不是数组类型，比如 arguments</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>❌
    <span class="token keyword">let</span> <span class="token literal-property property">args</span><span class="token operator">:</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="七、函数的类型"><a href="#七、函数的类型" class="header-anchor">#</a> 七、函数的类型</h2> <p><strong>正确的做法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 需要把输入和输出都考虑到</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">x</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span><span class="token operator">:</span> number <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

➖➖➖➖➖➖➖➖➖函数表达式➖➖➖➖➖➖➖➖➖
<span class="token keyword">let</span> <span class="token function-variable function">mySum</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">x</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span><span class="token operator">:</span> number <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 不要混淆了 TypeScript 中的 =&gt; 和 ES6 中的 =&gt;</span>
<span class="token keyword">let</span> <span class="token function-variable function">mySum</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">x</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function-variable function">number</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">x</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span><span class="token operator">:</span> number <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
➖➖➖➖➖➖➖➖➖接口定义函数的形状➖➖➖➖➖➖➖➖➖
<span class="token keyword">interface</span> <span class="token class-name">SearchFunc</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>source<span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">subString</span><span class="token operator">:</span> string<span class="token punctuation">)</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token literal-property property">mySearch</span><span class="token operator">:</span> SearchFunc<span class="token punctuation">;</span>
<span class="token function-variable function">mySearch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">,</span> subString</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> source<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>subString<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

➖➖➖➖➖➖➖➖➖可选参数➖➖➖➖➖➖➖➖➖
<span class="token keyword">function</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">firstName</span><span class="token operator">:</span> string<span class="token punctuation">,</span> lastName<span class="token operator">?</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>lastName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> firstName <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> lastName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> firstName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> tomcat <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">'Tom'</span><span class="token punctuation">,</span> <span class="token string">'Cat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> tom <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">'Tom'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


➖➖➖➖➖➖➖➖➖参数默认值➖➖➖➖➖➖➖➖➖
<span class="token keyword">function</span> <span class="token function">buildName</span><span class="token punctuation">(</span>firstName<span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">lastName</span><span class="token operator">:</span> string <span class="token operator">=</span> <span class="token string">'Cat'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> firstName <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> lastName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

➖➖➖➖➖➖➖➖➖剩余参数➖➖➖➖➖➖➖➖➖
<span class="token comment">// rest 参数只能是最后一个参数，关于 rest 参数,是一个数组</span>
<span class="token keyword">function</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">array</span><span class="token operator">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">...</span>items<span class="token operator">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    items<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        array<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">push</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>错误的做法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 输入多余的（或者少于要求的）参数，是不被允许的：</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">x</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span><span class="token operator">:</span> number <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ❌
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>❌

<span class="token comment">// 输入多余的（或者少于要求的）参数，是不被允许的：</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">x</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span><span class="token operator">:</span> number <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 可选参数后面不允许再出现必须参数了：</span>
<span class="token keyword">function</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token parameter">firstName<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">lastName</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>❌
    <span class="token keyword">if</span> <span class="token punctuation">(</span>firstName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> firstName <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> lastName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> lastName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> tomcat <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token string">'Tom'</span><span class="token punctuation">,</span> <span class="token string">'Cat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> tom <span class="token operator">=</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token string">'Tom'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_7-1-函数相关知识点梳理"><a href="#_7-1-函数相关知识点梳理" class="header-anchor">#</a> 7.1 函数相关知识点梳理</h3> <p><strong>四种声明方式：</strong></p> <ul><li>通过<code>function</code></li> <li>通过变量</li> <li>通过接口</li> <li>通过类型别名</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 函数定义</span>
<span class="token keyword">function</span> <span class="token function">add1</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">x</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y
<span class="token punctuation">}</span>

<span class="token comment">// 通过变量</span>
<span class="token keyword">let</span> <span class="token function-variable function">add2</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">x</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> number

<span class="token comment">// 通过类型别名</span>
<span class="token keyword">let</span> <span class="token function-variable function">add3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">x</span><span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> number

<span class="token comment">// 通过类型别名</span>
<span class="token keyword">interface</span> <span class="token class-name">add4</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>x<span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token operator">:</span> number
<span class="token punctuation">}</span>
</code></pre></div><p><strong>用interface定义函数和用type定义函数有区别?</strong></p> <ul><li><code>type</code>：不是创建新的类型，只是为一个给定的类型起一个名字。<code>type</code>还可以进行联合、交叉等操作，引用起来更简洁</li> <li><code>interface</code>：创建新的类型，接口之间还可以继承、声明合并</li> <li>如果可能，建议优先使用 <code>interface</code>。</li> <li>混合接口一般是为第三方类库写声明文件时会用到，很多类库名称可以直接当函数调用，也可以有些属性和方法。例子可以看一下<code>@types/jest/index.d.ts</code> 里面有一些混合接口。</li> <li>用混合接口声明函数和用接口声明类的区别是，接口不能声明类的构造函数（既不带名称的函数），但混合接口可以，其他都一样。</li></ul> <p><strong>函数重载</strong></p> <p>函数名相同，返回类型不同</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">add8</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>rest<span class="token operator">:</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">add8</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>rest<span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">add8</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>rest<span class="token operator">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span><span class="token operator">:</span> any <span class="token punctuation">{</span>
    <span class="token keyword">let</span> first <span class="token operator">=</span> rest<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> first <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> rest<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> first <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> rest<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pre<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> pre <span class="token operator">+</span> cur<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="八、类型断言"><a href="#八、类型断言" class="header-anchor">#</a> 八、类型断言</h2> <ul><li>有时候你会遇到这样的情况，你会比 <code>TypeScript</code> 更了解某个值的详细信息。 通常这会发生在你清楚地知道一个实体具有比它现有类型更确切的类型。</li> <li>通过类型断言这种方式可以告诉编译器，“相信我，我知道自己在干什么”。 类型断言好比其它语言里的类型转换，但是不进行特殊的数据检查和解构。 它没有运行时的影响，只是在编译阶段起作用。 <code>TypeScript</code> 会假设你，程序员，已经进行了必须的检查。</li></ul> <p>类型断言有两种形式。 其一是“尖括号”语法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token literal-property property">someValue</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token string">'this is a string'</span>

<span class="token keyword">let</span> <span class="token literal-property property">strLength</span><span class="token operator">:</span> number <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>someValue<span class="token punctuation">)</span><span class="token punctuation">.</span>length
</code></pre></div><blockquote><p>另一个为 <code>as</code> 语法：</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token literal-property property">someValue</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token string">'this is a string'</span>

<span class="token keyword">let</span> <span class="token literal-property property">strLength</span><span class="token operator">:</span> number <span class="token operator">=</span> <span class="token punctuation">(</span>someValue <span class="token keyword">as</span> string<span class="token punctuation">)</span><span class="token punctuation">.</span>length
</code></pre></div><blockquote><p>两种形式是等价的。 至于使用哪个大多数情况下是凭个人喜好；然而，当你在 <code>TypeScript</code> 里使用 <code>JSX</code> 时，只有<code>as</code> 语法断言是被允许</p></blockquote> <p><strong>正确的做法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 可以使用类型断言，将 something 断言成 string</span>
<span class="token keyword">function</span> <span class="token function">getLength</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">something</span><span class="token operator">:</span> string <span class="token operator">|</span> number</span><span class="token punctuation">)</span><span class="token operator">:</span> number <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>something<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>something<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> something<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>错误的做法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 只能访问此联合类型的所有类型里共有的属性或方法</span>
<span class="token keyword">function</span> <span class="token function">getLength</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">something</span><span class="token operator">:</span> string <span class="token operator">|</span> number</span><span class="token punctuation">)</span><span class="token operator">:</span> number <span class="token punctuation">{</span> ❌
    <span class="token keyword">return</span> something<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="九、类型别名"><a href="#九、类型别名" class="header-anchor">#</a> 九、类型别名</h2> <p><strong>正确的做法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用 type 创建类型别名,类型别名常用于联合类型</span>
type Name <span class="token operator">=</span> string<span class="token punctuation">;</span>
type <span class="token function-variable function">NameResolver</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> string<span class="token punctuation">;</span>
type NameOrResolver <span class="token operator">=</span> Name <span class="token operator">|</span> NameResolver<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">n</span><span class="token operator">:</span> NameOrResolver</span><span class="token punctuation">)</span><span class="token operator">:</span> Name <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> n <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> n<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">n</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="十、枚举"><a href="#十、枚举" class="header-anchor">#</a> 十、枚举</h2> <p><strong>正确的做法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 枚举（Enum）类型用于取值被限定在一定范围内的场景，比如一周只能有七天	</span>
<span class="token comment">// 枚举就是枚举值到枚举名进行反向映射</span>

<span class="token keyword">enum</span> Days <span class="token punctuation">{</span>Sun<span class="token punctuation">,</span> Mon<span class="token punctuation">,</span> Tue<span class="token punctuation">,</span> Wed<span class="token punctuation">,</span> Thu<span class="token punctuation">,</span> Fri<span class="token punctuation">,</span> Sat<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Days<span class="token punctuation">[</span><span class="token string">"Sun"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Days<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'Sun'</span>

<span class="token keyword">enum</span> Days <span class="token punctuation">{</span>Sun <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> Mon <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Tue<span class="token punctuation">,</span> Wed<span class="token punctuation">,</span> Thu<span class="token punctuation">,</span> Fri<span class="token punctuation">,</span> Sat<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Days<span class="token punctuation">[</span><span class="token string">"Sun"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 7</span>
</code></pre></div><h2 id="十一、类"><a href="#十一、类" class="header-anchor">#</a> 十一、类</h2> <p><strong>正确的做法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>➖➖➖➖➖➖➖➖➖类➖➖➖➖➖➖➖➖➖
<span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">My name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token string">'Jack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// My name is Jack</span>
➖➖➖➖➖➖➖➖➖继承➖➖➖➖➖➖➖➖➖
<span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用父类的 constructor(name)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">'Meow, '</span> <span class="token operator">+</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用父类的 sayHi()</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token string">'Tom'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Tom</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Meow, My name is Tom</span>
➖➖➖➖➖➖➖➖➖存储器➖➖➖➖➖➖➖➖➖
<span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">get</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">'Jack'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">set</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setter: '</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token string">'Kitty'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// setter: Kitty</span>
a<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Tom'</span><span class="token punctuation">;</span> <span class="token comment">// setter: Tom</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Jack</span>
➖➖➖➖➖➖➖➖➖静态方法➖➖➖➖➖➖➖➖➖
<span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token function">isAnimal</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a <span class="token keyword">instanceof</span> <span class="token class-name">Animal</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token string">'Jack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Animal<span class="token punctuation">.</span><span class="token function">isAnimal</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token comment">// 只能通过类名调用</span>
a<span class="token punctuation">.</span><span class="token function">isAnimal</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TypeError: a.isAnimal is not a function ❌</span>
➖➖➖➖➖➖➖➖➖抽象类➖➖➖➖➖➖➖➖➖
<span class="token comment">// 只能被继承，不能被实例化</span>
abstract <span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'eat'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  abstract <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>
<span class="token comment">// 子类必须实现抽象类的抽象方法</span>
<span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">name</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token punctuation">}</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'dog sleep'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> dog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'wang'</span><span class="token punctuation">)</span>
dog<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_11-1类与接口的关系"><a href="#_11-1类与接口的关系" class="header-anchor">#</a> 11.1类与接口的关系</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">Human</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 实现接口中声明的属性</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">implements</span> <span class="token class-name">Human</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">name</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token punctuation">}</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 接口可以像类一样实现继承</span>
<span class="token keyword">interface</span> <span class="token class-name">Man</span> <span class="token keyword">extends</span> <span class="token class-name">Human</span> <span class="token punctuation">{</span>
    <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> voild
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Child</span> <span class="token punctuation">{</span>
    <span class="token function">cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> voild
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Boy</span> <span class="token keyword">extends</span> <span class="token class-name">Man</span><span class="token punctuation">,</span>Child <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 添加被继承过来的属性</span>
<span class="token keyword">let</span> <span class="token literal-property property">body</span><span class="token operator">:</span> Boy <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'xx'</span><span class="token punctuation">,</span>
    <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">cry</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="十二、public-private-和-protected"><a href="#十二、public-private-和-protected" class="header-anchor">#</a> 十二、public private 和 protected</h2> <ul><li><code>public</code> 修饰的属性或方法是公有的，可以在任何地方被访问到，默认所有的属性和方法都是 <code>public</code> 的</li> <li><code>private</code> 修饰的属性或方法是私有的，不能在声明它的类的外部访问</li> <li><code>protected</code> 修饰的属性或方法是受保护的，它和 <code>private</code> 类似，区别是它在子类中也是允许被访问的</li></ul> <h2 id="十三、泛型"><a href="#十三、泛型" class="header-anchor">#</a> 十三、泛型</h2> <blockquote><p>更多详情 http://blog.poetries.top/ts-axios/chapter2/generic.html</p></blockquote> <blockquote><p>泛型就是解决 类 接口 方法的复用性、以及对不特定数据类型的支持。<strong>泛型理解为代表类型的参数，只是另一个维度的参数</strong></p></blockquote> <p><strong>正确的做法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//只能返回string类型的数据</span>
<span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span>string</span><span class="token punctuation">)</span><span class="token operator">:</span>string<span class="token punctuation">{</span>
  <span class="token keyword">return</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//同时返回 string类型 和number类型  （代码冗余）</span>
<span class="token keyword">function</span> <span class="token function">getData1</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span>string</span><span class="token punctuation">)</span><span class="token operator">:</span>string<span class="token punctuation">{</span>
  <span class="token keyword">return</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getData2</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span>number</span><span class="token punctuation">)</span><span class="token operator">:</span>number<span class="token punctuation">{</span>
  <span class="token keyword">return</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;&gt;&gt;</span><span class="token operator">&gt;</span>使用泛型后就可以解决这个问题
<span class="token comment">// T表示泛型，具体什么类型是调用这个方法的时候决定的</span>
<span class="token comment">// 表示参数是什么类型就返回什么类型~~~</span>
<span class="token keyword">function</span> getData<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>value<span class="token operator">:</span><span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token constant">T</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
getData<span class="token operator">&lt;</span>number<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
getData<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">'1214231'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 定义接口</span>
<span class="token keyword">interface</span> <span class="token class-name">ConfigFn</span><span class="token punctuation">{</span>
    <span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>value<span class="token operator">:</span><span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token literal-property property">getData</span><span class="token operator">:</span><span class="token function-variable function">ConfigFn</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>value<span class="token operator">:</span><span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token constant">T</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
getData<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
getData<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token number">1243</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//错误</span>
</code></pre></div><h3 id="_13-1-泛型函数和接口"><a href="#_13-1-泛型函数和接口" class="header-anchor">#</a> 13.1 泛型函数和接口</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 这两个等价的，使用时无需指定类型</span>
type Log <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token constant">T</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token comment">// 只约束改成员</span>
<span class="token keyword">interface</span> <span class="token class-name">Log</span> <span class="token punctuation">{</span>
  <span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token constant">T</span>
<span class="token punctuation">}</span>

<span class="token comment">// 这两个等价的，使用时必须指定类型</span>
type Log<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token constant">T</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token comment">// 约束接口的所有成员</span>
<span class="token keyword">interface</span> <span class="token class-name">Log</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token constant">T</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_13-2-泛型类与泛型约束"><a href="#_13-2-泛型类与泛型约束" class="header-anchor">#</a> 13.2 泛型类与泛型约束</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 把泛型放到类的后面，就可以约束所有成员</span>
<span class="token keyword">class</span> <span class="token class-name">Log</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">run</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token constant">T</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> value
    <span class="token punctuation">}</span>
    <span class="token comment">// 不能约束静态成员</span>
   <span class="token comment">// static eat() // 报错</span>
<span class="token punctuation">}</span>

<span class="token comment">// 实例化类 传入类型</span>
<span class="token keyword">let</span> log1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Log</span><span class="token operator">&lt;</span>number<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
log1<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment">// 不指定类型参数传任意都允许</span>
<span class="token keyword">let</span> log2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
log2<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>类型约束</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">Length</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">length</span><span class="token operator">:</span> number
<span class="token punctuation">}</span>

<span class="token comment">// T继承了接口 约束了不是任意类型都可传。传入的参数必须有length属性</span>
<span class="token keyword">function</span> log<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">Length</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> value<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    <span class="token keyword">return</span> value
<span class="token punctuation">}</span>
<span class="token comment">// 如数组、字符串、对象都有length属性</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>函数和类可以轻松支持多种类型，增强程序的扩展性</li> <li>不必写多条函数重载</li> <li>灵活控制类型之间的约束</li></ul> <p><strong>对象属性约束</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 泛型约束对象中的属性</span>
<span class="token keyword">function</span> getProp<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span><span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token class-name">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>obj<span class="token operator">:</span><span class="token constant">T</span><span class="token punctuation">,</span><span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="十四、类型检查机制"><a href="#十四、类型检查机制" class="header-anchor">#</a> 十四、类型检查机制</h2> <h3 id="_14-1-类型检查机制"><a href="#_14-1-类型检查机制" class="header-anchor">#</a> 14.1 类型检查机制</h3> <blockquote><p>编译器在做类型检查时，秉承的一些原则，表现出的一些行为</p></blockquote> <p>作用：辅助开发，提高开发效率</p> <ul><li>类型推断</li> <li>类型兼容性</li> <li>类型保护</li></ul> <blockquote><p>所谓类型推断：不需要指定变量的类型（函数的返回值类型），TS可以根据某些规则自动的为其推断出一个类型</p></blockquote> <ul><li>基础类型推断</li> <li>最佳通用类型推断</li> <li>上下文类型推断</li></ul> <blockquote><p>基础类型推断，从右向左。但是有些是从左向右推断</p></blockquote> <p>如事件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ts 根据onkeydown推断出类型</span>
window<span class="token punctuation">.</span><span class="token function-variable function">onkeydown</span> <span class="token operator">=</span> <span class="token parameter">event</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>通过类型断言阻断TS的类型推断</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">bar</span><span class="token operator">:</span> number
<span class="token punctuation">}</span>

<span class="token comment">//let foo = {} as Foo</span>
<span class="token comment">//foo.bar = 1</span>

<span class="token keyword">let</span> <span class="token literal-property property">foo</span><span class="token operator">:</span> Foo <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">bar</span><span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_14-2-类型保护机制"><a href="#_14-2-类型保护机制" class="header-anchor">#</a> 14.2 类型保护机制</h3> <blockquote><p>联合类型适合于那些值可以为不同类型的情况。 但当我们想确切地了解是否为 Fish 或者是 Bird 时怎么办？ JavaScript 里常用来区分这 2 个可能值的方法是检查成员是否存在。如之前提及的，我们只能访问联合类型中共同拥有的成员</p></blockquote> <p><strong>不同的判断方法有不同的使用场景：</strong></p> <ul><li><code>typeof</code>：判断一个变量的类型</li> <li><code>instanceof</code>：判断一个实例是否属于某个类</li> <li><code>in</code>：判断一个属性是否属于某个对象</li> <li>类型保护函数：某些判断可能不是一条语句能够搞定的，需要更多复杂的逻辑，适合封装到一个函数内</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getLanguage</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">type</span><span class="token operator">:</span> Type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> lang <span class="token operator">=</span> type <span class="token operator">===</span> type<span class="token punctuation">.</span>Strong <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">Java</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Javascript</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment">// 类型保护instanceof</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>lang <span class="token keyword">instanceof</span> <span class="token class-name">Java</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        lang<span class="token punctuation">.</span><span class="token function">hellJava</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        lang<span class="token punctuation">.</span><span class="token function">hellJavaScript</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// in</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">'java'</span> <span class="token keyword">in</span> lang<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lang<span class="token punctuation">.</span><span class="token function">hellJava</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        lang<span class="token punctuation">.</span><span class="token function">hellJavaScript</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 类型保护函数方式</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isJava</span><span class="token punctuation">(</span>lang<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        lang<span class="token punctuation">.</span><span class="token function">hellJava</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
        lang<span class="token punctuation">.</span><span class="token function">hellJavaScript</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 创建一种类型保护函数</span>
<span class="token keyword">function</span> <span class="token function">isJava</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">lang</span><span class="token operator">:</span> Java <span class="token operator">|</span> Javascript</span><span class="token punctuation">)</span><span class="token operator">:</span> lang is Java <span class="token punctuation">{</span>
    <span class="token comment">// 类型断言</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>lang <span class="token keyword">as</span> Java<span class="token punctuation">)</span><span class="token punctuation">.</span>lang<span class="token punctuation">.</span>helloJava <span class="token operator">!==</span> <span class="token keyword">undefined</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> pet <span class="token operator">=</span> <span class="token function">getSmallPet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 每一个成员访问都会报错</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>pet<span class="token punctuation">.</span>swim<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  pet<span class="token punctuation">.</span><span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>pet<span class="token punctuation">.</span>fly<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  pet<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>为了让这段代码工作，我们要使用类型断言</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> pet <span class="token operator">=</span> <span class="token function">getSmallPet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pet <span class="token keyword">as</span> Fish<span class="token punctuation">)</span><span class="token punctuation">.</span>swim<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span>pet <span class="token keyword">as</span> Fish<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span>pet <span class="token keyword">as</span> Bird<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_14-2-1-用户自定义的类型保护"><a href="#_14-2-1-用户自定义的类型保护" class="header-anchor">#</a> 14.2.1 用户自定义的类型保护</h4> <ul><li>这里可以注意到我们不得不多次使用类型断言。如果我们一旦检查过类型，就能在之后的每个分支里清楚地知道 <code>pet</code> 的类型的话就好了。</li> <li><code>TypeScript</code> 里的类型保护机制让它成为了现实。 类型保护就是一些表达式，它们会在运行时检查以确保在某个作用域里的类型。定义一个类型保护，我们只要简单地定义一个函数，它的返回值是一个类型谓词</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isFish</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">pet</span><span class="token operator">:</span> Fish <span class="token operator">|</span> Bird</span><span class="token punctuation">)</span><span class="token operator">:</span> pet is Fish <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>pet <span class="token keyword">as</span> Fish<span class="token punctuation">)</span><span class="token punctuation">.</span>swim <span class="token operator">!==</span> <span class="token keyword">undefined</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>在这个例子里，<code>pet is Fish</code> 就是类型谓词。谓词为 <code>parameterName is Type</code> 这种形式， <code>parameterName</code> 必须是来自于当前函数签名里的一个参数名。</li> <li>每当使用一些变量调用 <code>isFish</code> 时，TypeScript 会将变量缩减为那个具体的类型</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isFish</span><span class="token punctuation">(</span>pet<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  pet<span class="token punctuation">.</span><span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span> <span class="token punctuation">{</span>
  pet<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>注意 TypeScript 不仅知道在 <code>if</code> 分支里 <code>pet</code> 是 <code>Fish</code> 类型；它还清楚在<code>else</code> 分支里，一定不是 <code>Fish</code>类型而是 <code>Bird</code> 类型</p></blockquote> <h4 id="_14-2-2-typeof-类型保护"><a href="#_14-2-2-typeof-类型保护" class="header-anchor">#</a> 14.2.2 typeof 类型保护</h4> <p>我们可以像下面这样利用类型断言来写</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isNumber</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">x</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span><span class="token operator">:</span>x is string <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'number'</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">isString</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">x</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span><span class="token operator">:</span> x is string <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">typeof</span> x <span class="token operator">===</span> <span class="token string">'string'</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">padLeft</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">padding</span><span class="token operator">:</span> string <span class="token operator">|</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNumber</span><span class="token punctuation">(</span>padding<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Array</span><span class="token punctuation">(</span>padding <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token operator">+</span> value
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isString</span><span class="token punctuation">(</span>padding<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> padding <span class="token operator">+</span> value
  <span class="token punctuation">}</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Expected string or number, got '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>padding<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>然而，你必须要定义一个函数来判断类型是否是原始类型，但这并不必要。其实我们不必将 <code>typeof x === 'number'</code>抽象成一个函数，因为 TypeScript 可以将它识别为一个类型保护。 也就是说我们可以直接在代码里检查类型了</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">padLeft</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">padding</span><span class="token operator">:</span> string <span class="token operator">|</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> padding <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Array</span><span class="token punctuation">(</span>padding <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token operator">+</span> value
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> padding <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> padding <span class="token operator">+</span> value
  <span class="token punctuation">}</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Expected string or number, got '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>padding<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>这些 <code>typeof</code> 类型保护只有两种形式能被识别：<code>typeof v === "typename"</code> 和 <code>typeof v !== "typename"</code>， <code>"typename"</code>必须是 <code>"number"</code>， <code>"string"</code>，<code>"boolean"</code> 或 <code>"symbol"</code>。 但是 TypeScript 并不会阻止你与其它字符串比较，只是 TypeScript 不会把那些表达式识别为类型保护。</p></blockquote> <h4 id="_14-2-3-instanceof-类型保护"><a href="#_14-2-3-instanceof-类型保护" class="header-anchor">#</a> 14.2.3 instanceof 类型保护</h4> <ul><li>如果你已经阅读了 <code>typeof</code> 类型保护并且对 JavaScript 里的 <code>instanceof</code> 操作符熟悉的话，你可能已经猜到了这节要讲的内容。</li> <li><code>instanceof</code> 类型保护是通过构造函数来细化类型的一种方式。我们把之前的例子做一个小小的改造：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Bird</span> <span class="token punctuation">{</span>
  <span class="token function">fly</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'bird fly'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">layEggs</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'bird lay eggs'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Fish</span> <span class="token punctuation">{</span>
  <span class="token function">swim</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fish swim'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">layEggs</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fish lay eggs'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getRandomPet</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0.5</span> <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">Bird</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Fish</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> pet <span class="token operator">=</span> <span class="token function">getRandomPet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>pet <span class="token keyword">instanceof</span> <span class="token class-name">Bird</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  pet<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>pet <span class="token keyword">instanceof</span> <span class="token class-name">Fish</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  pet<span class="token punctuation">.</span><span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="十五、高级类型"><a href="#十五、高级类型" class="header-anchor">#</a> 十五、高级类型</h2> <h3 id="_15-1-交叉类型-取并集"><a href="#_15-1-交叉类型-取并集" class="header-anchor">#</a> 15.1 交叉类型（取并集）</h3> <blockquote><p>交叉类型是将多个类型合并为一个类型。这让我们可以把现有的多种类型叠加到一起成为一种类型，它包含了所需的所有类型的特性。 例如，<code>Person &amp; Loggable</code> 同时是 <code>Person</code> 和 <code>Loggable</code>。就是说这个类型的对象同时拥有了这两种类型的成员。</p></blockquote> <blockquote><p>我们大多是在混入（mixins）或其它不适合典型面向对象模型的地方看到交叉类型的使用。 （在 JavaScript里发生这种情况的场合很多！）下面是如何创建混入的一个简单例子</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> extend<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span>first<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> <span class="token literal-property property">second</span><span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token constant">U</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">as</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token constant">U</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> id <span class="token keyword">in</span> first<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token keyword">as</span> any
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> id <span class="token keyword">in</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> second<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token keyword">as</span> any
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> <span class="token literal-property property">name</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Loggable</span> <span class="token punctuation">{</span>
  <span class="token function">log</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ConsoleLogger</span> <span class="token keyword">implements</span> <span class="token class-name">Loggable</span> <span class="token punctuation">{</span>
  <span class="token function">log</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> jim <span class="token operator">=</span> <span class="token function">extend</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Jim'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ConsoleLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> n <span class="token operator">=</span> jim<span class="token punctuation">.</span>name
jim<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">DogInterface</span> <span class="token punctuation">{</span>
    <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">CatInterface</span> <span class="token punctuation">{</span>
    <span class="token function">jump</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>

<span class="token comment">// pet 具备两个接口的所有方法</span>
<span class="token keyword">let</span> <span class="token literal-property property">pet</span><span class="token operator">:</span> DogInterface <span class="token operator">&amp;</span> CatInterface <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">jump</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 联合类型</span>
<span class="token keyword">let</span> <span class="token literal-property property">a</span><span class="token operator">:</span> number <span class="token operator">|</span> string <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">let</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token string">'a'</span> <span class="token operator">|</span> <span class="token string">'b'</span> <span class="token operator">|</span> <span class="token string">'c'</span> <span class="token comment">// 字面量联合类型</span>
<span class="token keyword">let</span> <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token number">2</span> <span class="token operator">|</span> <span class="token number">3</span> <span class="token comment">// 数字联合类型</span>


<span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token keyword">implements</span> <span class="token class-name">DogInterface</span> <span class="token punctuation">{</span>
    <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Cat</span>  <span class="token keyword">implements</span> <span class="token class-name">CatInterface</span> <span class="token punctuation">{</span>
    <span class="token function">jump</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">enum</span> Master <span class="token punctuation">{</span> Boy<span class="token punctuation">,</span> Girl <span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getPet</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">master</span><span class="token operator">:</span> Master</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> pet <span class="token operator">=</span> master <span class="token operator">===</span> Master<span class="token punctuation">.</span>Boy <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// pet.run()</span>
    <span class="token comment">// pet.jump()</span>
    pet<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> pet
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Square</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">kind</span><span class="token operator">:</span> <span class="token string">"square"</span><span class="token punctuation">;</span>
    <span class="token literal-property property">size</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">kind</span><span class="token operator">:</span> <span class="token string">"rectangle"</span><span class="token punctuation">;</span>
    <span class="token literal-property property">width</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
    <span class="token literal-property property">height</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Circle</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">kind</span><span class="token operator">:</span> <span class="token string">"circle"</span><span class="token punctuation">;</span>
    <span class="token literal-property property">radius</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

type Shape <span class="token operator">=</span> Square <span class="token operator">|</span> Rectangle <span class="token operator">|</span> Circle

<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">s</span><span class="token operator">:</span> Shape</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>kind<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">"square"</span><span class="token operator">:</span>
            <span class="token keyword">return</span> s<span class="token punctuation">.</span>size <span class="token operator">*</span> s<span class="token punctuation">.</span>size<span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">"rectangle"</span><span class="token operator">:</span>
            <span class="token keyword">return</span> s<span class="token punctuation">.</span>height <span class="token operator">*</span> s<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'circle'</span><span class="token operator">:</span>
            <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> s<span class="token punctuation">.</span>radius <span class="token operator">**</span> <span class="token number">2</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">e</span><span class="token operator">:</span> never</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">kind</span><span class="token operator">:</span> <span class="token string">'circle'</span><span class="token punctuation">,</span> <span class="token literal-property property">radius</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_15-2-索引类型"><a href="#_15-2-索引类型" class="header-anchor">#</a> 15.2 索引类型</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span>

<span class="token comment">// function getValues(obj: any, keys: string[]) {</span>
<span class="token comment">//     return keys.map(key =&gt; obj[key])</span>
<span class="token comment">// }</span>
<span class="token keyword">function</span> getValues<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token class-name">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>obj<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> <span class="token literal-property property">keys</span><span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> keys<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getValues</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// console.log(getValues(obj, ['d', 'e']))</span>

<span class="token comment">// keyof T</span>
<span class="token keyword">interface</span> <span class="token class-name">Obj</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> <span class="token literal-property property">key</span><span class="token operator">:</span> keyof Obj

<span class="token comment">// T[K]</span>
<span class="token keyword">let</span> <span class="token literal-property property">value</span><span class="token operator">:</span> Obj<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span>

<span class="token comment">// T extends U</span>
</code></pre></div><h3 id="_15-3-映射类型"><a href="#_15-3-映射类型" class="header-anchor">#</a> 15.3 映射类型</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">Obj</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使得每个成员属性变为只读</span>
type ReadonlyObj <span class="token operator">=</span> Readonly<span class="token operator">&lt;</span>Obj<span class="token operator">&gt;</span>

<span class="token comment">// 把一个接口属性变为可选</span>
type PartialObj <span class="token operator">=</span> Partial<span class="token operator">&lt;</span>Obj<span class="token operator">&gt;</span>

<span class="token comment">// 抽取obj的子集</span>
type PickObj <span class="token operator">=</span> Pick<span class="token operator">&lt;</span>Obj<span class="token punctuation">,</span> <span class="token string">'a'</span> <span class="token operator">|</span> <span class="token string">'b'</span><span class="token operator">&gt;</span>

type RecordObj <span class="token operator">=</span> Record<span class="token operator">&lt;</span><span class="token string">'x'</span> <span class="token operator">|</span> <span class="token string">'y'</span><span class="token punctuation">,</span> Obj<span class="token operator">&gt;</span>
</code></pre></div><h3 id="_15-4-条件类型"><a href="#_15-4-条件类型" class="header-anchor">#</a> 15.4 条件类型</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// T extends U ? X : Y</span>

type TypeName<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=</span>
    <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">string</span> <span class="token operator">?</span> <span class="token string">"string"</span> <span class="token operator">:</span>
    <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">number</span> <span class="token operator">?</span> <span class="token string">"number"</span> <span class="token operator">:</span>
    <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">boolean</span> <span class="token operator">?</span> <span class="token string">"boolean"</span> <span class="token operator">:</span>
    <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">undefined</span> <span class="token operator">?</span> <span class="token string">"undefined"</span> <span class="token operator">:</span>
    <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">Function</span> <span class="token operator">?</span> <span class="token string">"function"</span> <span class="token operator">:</span>
    <span class="token string">"object"</span><span class="token punctuation">;</span>
type <span class="token constant">T1</span> <span class="token operator">=</span> TypeName<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span>
type <span class="token constant">T2</span> <span class="token operator">=</span> TypeName<span class="token operator">&lt;</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span>

<span class="token comment">// (A | B) extends U ? X : Y</span>
<span class="token comment">// (A extends U ? X : Y) | (B extends U ? X : Y)</span>
type <span class="token constant">T3</span> <span class="token operator">=</span> TypeName<span class="token operator">&lt;</span>string <span class="token operator">|</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span>

type Diff<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">U</span> <span class="token operator">?</span> never <span class="token operator">:</span> <span class="token constant">T</span>
type <span class="token constant">T4</span> <span class="token operator">=</span> Diff<span class="token operator">&lt;</span><span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"e"</span><span class="token operator">&gt;</span>
<span class="token comment">// Diff&lt;"a", "a" | "e"&gt; | Diff&lt;"b", "a" | "e"&gt; | Diff&lt;"c", "a" | "e"&gt;</span>
<span class="token comment">// never | "b" | "c"</span>
<span class="token comment">// "b" | "c"</span>

type NotNull<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=</span> Diff<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span>
type <span class="token constant">T5</span> <span class="token operator">=</span> NotNull<span class="token operator">&lt;</span>string <span class="token operator">|</span> number <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span>

<span class="token comment">// Exclude&lt;T, U&gt;</span>
<span class="token comment">// NonNullable&lt;T&gt;</span>

<span class="token comment">// Extract&lt;T, U&gt;</span>
type <span class="token constant">T6</span> <span class="token operator">=</span> Extract<span class="token operator">&lt;</span><span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"e"</span><span class="token operator">&gt;</span>

<span class="token comment">// ReturnType&lt;T&gt;</span>
type <span class="token constant">T8</span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> string<span class="token operator">&gt;</span>
</code></pre></div><h3 id="_15-5-联合类型"><a href="#_15-5-联合类型" class="header-anchor">#</a> 15.5 联合类型</h3> <blockquote><p>联合类型与交叉类型很有关联，但是使用上却完全不同。 偶尔你会遇到这种情况，一个代码库希望传入 <code>number</code> 或 <code>string</code> 类型的参数。 例如下面的函数</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">padLeft</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">padding</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> padding <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Array</span><span class="token punctuation">(</span>padding <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token operator">+</span> value
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> padding <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> padding <span class="token operator">+</span> value
  <span class="token punctuation">}</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Expected string or number, got '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>padding<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">padLeft</span><span class="token punctuation">(</span><span class="token string">'Hello world'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">// returns "    Hello world"</span>
</code></pre></div><blockquote><p>padLeft 存在一个问题，padding 参数的类型指定成了 any。 这就是说我们可以传入一个既不是 number 也不是 string 类型的参数，但是 TypeScript 却不报错</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> indentedString <span class="token operator">=</span> <span class="token function">padLeft</span><span class="token punctuation">(</span><span class="token string">'Hello world'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// 编译阶段通过，运行时报错</span>
</code></pre></div><blockquote><p>为了解决这个问题，我们可以使用 联合类型做为 <code>padding</code> 的参数</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">padLeft</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">padding</span><span class="token operator">:</span> string <span class="token operator">|</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> indentedString <span class="token operator">=</span> <span class="token function">padLeft</span><span class="token punctuation">(</span><span class="token string">'Hello world'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// 编译阶段报错</span>
</code></pre></div><ul><li>联合类型表示一个值可以是几种类型之一。我们用竖线（<code>|</code>）分隔每个类型，所以 <code>number | string</code> 表示一个值可以是 <code>number</code>或<code>string</code>。</li></ul> <blockquote><p>如果一个值是联合类型，<strong>我们只能访问此联合类型的所有类型里共有的成员</strong></p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">Bird</span> <span class="token punctuation">{</span>
  <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">layEggs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Fish</span> <span class="token punctuation">{</span>
  <span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">layEggs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getSmallPet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Fish <span class="token operator">|</span> Bird <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> pet <span class="token operator">=</span> <span class="token function">getSmallPet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
pet<span class="token punctuation">.</span><span class="token function">layEggs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// okay</span>
pet<span class="token punctuation">.</span><span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">// error</span>
</code></pre></div><blockquote><p>这里的联合类型可能有点复杂：如果一个值的类型是 <code>A | B</code>，我们能够确定的是它包含了 <code>A</code> 和 <code>B</code> 中共有的成员。这个例子里，Fish 具有一个 <code>swim</code> 方法，我们不能确定一个 <code>Bird | Fish</code>类型的变量是否有 <code>swim</code>方法。 如果变量在运行时是 Bird 类型，那么调用 <code>pet.swim()</code>就出错了</p></blockquote> <h2 id="十六、初学者的困惑"><a href="#十六、初学者的困惑" class="header-anchor">#</a> 十六、初学者的困惑</h2> <h3 id="_16-1-如何优雅的声明类型"><a href="#_16-1-如何优雅的声明类型" class="header-anchor">#</a> 16.1 如何优雅的声明类型</h3> <h4 id="_16-1-1-基础"><a href="#_16-1-1-基础" class="header-anchor">#</a> 16.1.1 基础</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">Basic</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">num</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
  <span class="token literal-property property">str</span><span class="token operator">:</span> string <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  bol<span class="token operator">?</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>五种 JS 值类型就声明好了。那数组、函数呢？</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">Func</span> <span class="token punctuation">{</span>
  <span class="token function">func</span><span class="token punctuation">(</span>str<span class="token operator">:</span> string<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Arr</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">str</span><span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token literal-property property">mixed</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>string <span class="token operator">|</span> number<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token literal-property property">fixedStructure</span><span class="token operator">:</span> <span class="token punctuation">[</span>string<span class="token punctuation">,</span> number<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token literal-property property">basics</span><span class="token operator">:</span> Basic<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>枚举类型也是很常用的，比如声明一个状态机的各个状态</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">enum</span> Status <span class="token punctuation">{</span>
  Draft<span class="token punctuation">,</span>
  Published
<span class="token punctuation">}</span>

<span class="token comment">// 也可指定值</span>
<span class="token keyword">enum</span> Status <span class="token punctuation">{</span>
  Draft <span class="token operator">=</span> <span class="token string">'Draft'</span><span class="token punctuation">,</span>
  Published <span class="token operator">=</span> <span class="token string">'Published'</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_16-1-2-糅合"><a href="#_16-1-2-糅合" class="header-anchor">#</a> 16.1.2 糅合</h4> <p><strong>独立声明</strong></p> <blockquote><p>一个 <code>ts</code> 文件只声明一个类型或者接口，文件名为需要暴露的类型名称，方便检索和管理</p></blockquote> <p><strong>就近声明</strong></p> <blockquote><p>当一个声明没有被外部引用或者依赖时，可以考虑就近放在使用的地方，典型的场景是 <code>React</code> 组件的 <code>Props</code> 和 <code>State</code> 的类型声明</p></blockquote> <p><strong>按职责分组</strong></p> <ul><li>在项目中，需要声明类型的可大致分为两类：一类是 <code>model</code>，也就是接口请求相关的，包括入参和出参；另一类是 <code>view</code>，界面渲染相关的。因此，我在 独立声明 的基础上，可以类型按照<code>model</code> 和 <code>view</code> 的维度进行分组，相互独立。</li> <li>那么问题来了，如果是独立的类型声明的话，怎么把 model 的数据应用到 <code>view</code> 呢？ 可能你需要一个 <code>adapter</code> 来做类型的的转换：<code>DTOTypes</code> -&gt; <code>adapter</code> -&gt; <code>ViewTypes</code>, 完成类似于将接口中的字符串映射成枚举类型这之类的转换</li></ul> <p><strong>any</strong></p> <blockquote><p>当遇到确实解决不了的类型报错的时候，<code>as any</code> 能带给你不一样的快感，但是不建议使用啊</p></blockquote> <h3 id="_16-2-如何引用外部库"><a href="#_16-2-如何引用外部库" class="header-anchor">#</a> 16.2 如何引用外部库</h3> <blockquote><p>在 <code>JS</code> 中，<code>npm</code> 上有丰富的海量的库帮我们完成日常的编码，可能并不是所有的库都能完全被应用到 <code>TS</code> 中，因为有些缺少类型声明</p></blockquote> <p>比如，在 <code>TS</code> 中使用 <code>react</code>, 你会得到这样的一个类型检查错误：</p> <p><img src="https://pic2.zhimg.com/80/v2-fdfb8e5f2be67d8c978e216254b80a9d_hd.jpg" alt=""></p> <ul><li>因为 react 的库中并没有类型声明</li> <li>现在比较通用的做法是，实现和类型实现独立成两个库，也就是你需要再安装类型声明的库: <code>@types/react</code></li> <li>当遇到上述问题的时候，尝试安装一下 <code>@types/[package]</code></li> <li>然而，并不是所有的库都有类型声明的实现，也会有很多不支持 TS 的存在，然而又必须得使用这个库的时候该怎么办？</li></ul> <p><strong>自己写声明</strong></p> <blockquote><p>以 <code>progressbar.js</code>为例，基本使用方法</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ProgressBar <span class="token keyword">from</span> <span class="token string">'progressbar.js'</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">ProgressBar<span class="token punctuation">.</span>Circle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$progress<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">strokeWidth</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
  <span class="token literal-property property">trailColor</span><span class="token operator">:</span> <span class="token string">'#e5e4e5'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">trailWidth</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
  <span class="token literal-property property">easing</span><span class="token operator">:</span> <span class="token string">'easeInOut'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>我们需要对库中暴露出的 api 去做声明，对上述例子做个分解：暴露了 Circle 类，Circle 构造函数包含两个参数，一个 HTMLElement，一个 options. OK</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 首先声明一下模块：</span>
declare module <span class="token string">'progressbar.js'</span> <span class="token punctuation">{</span>
  <span class="token comment">// 模块中暴露了 Circle 类</span>
  <span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>container<span class="token operator">:</span> HTMLElement<span class="token punctuation">,</span> <span class="token literal-property property">options</span><span class="token operator">:</span> Options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 构造函数的 Options 需要单独声明 </span>
  <span class="token keyword">interface</span> <span class="token class-name">Options</span> <span class="token punctuation">{</span>
    easing<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    strokeWidth<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
    trailColor<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    trailWidth<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>如此我们便完成了一个简单的声明，当然实际使用中的 API 肯定比上述情况复杂，根据使用情况，用了哪些 API 或者参数，就补充那些的声明即可</p></blockquote> <h3 id="_16-3-如何组织一个-ts-项目"><a href="#_16-3-如何组织一个-ts-项目" class="header-anchor">#</a> 16.3 如何组织一个 TS 项目</h3> <ul><li>TS 项目的目录组织上，跟 JS 项目一样，补充好 types 的声明就可以了</li> <li>需要注意的是，将你希望对外暴露的能力相关的类型声明都暴露出去，不友好的声明会让接入你项目的人非常的痛苦，同时，在 package.json 中需要指定 type 的 path, 比如："types": "dist/types/index.d.ts"</li> <li>另外，务必加上 tslint, 更规范的去用 TS 实现功能，对于入门而言尤为重要</li></ul> <h3 id="_16-4-tsx-和-jsx"><a href="#_16-4-tsx-和-jsx" class="header-anchor">#</a> 16.4 TSX 和 JSX</h3> <ul><li>之前我们在用 <code>JavaScript</code> 写 <code>React</code> 时，对文件的扩展名没有什么特别的要求，<code>.js</code> 或者 <code>.jsx</code> 都行。</li> <li>但在 <code>TypeScript</code> 中，如果你要使用 <code>JSX</code> 语法，就不能使用 <code>.ts</code>，必须使用 <code>.tsx</code>。如果你不知道，或者忘了这么做，那么你会在使用了 <code>JSX</code> 代码的地方收到类型报错，但代码本身怎么看都没有问题。这也是刚上手 <code>TypeScript + React</code> 时几乎每个人都会遇到的坑。</li> <li>关于这一点，<code>TypeScript</code> 只是在官方教程的示例代码中直接用了 <code>*.tsx</code>，但并没有明确说明这一问题</li></ul> <h3 id="_16-5-变量的-type-怎么找"><a href="#_16-5-变量的-type-怎么找" class="header-anchor">#</a> 16.5 变量的 Type 怎么找</h3> <ul><li>上手 <code>TypeScript</code> 之后很快我们就发现，即便是原生的 <code>DOM</code>、或是 <code>React</code> 的 <code>API</code>，也经常会要我们手动指定类型。但这些结构并不是简单的 <code>JavaScript</code>原始类型，在使用 <code>JavaScript</code> 编写相关代码时候由于没有这种需要，我们也没关心过这些东西的类型，突然问起来，还真不知道这些类型叫什么名字。</li> <li>不光是这些标准类型，同样的问题在很多第三方的库中也会遇到，比如一些组件库会检查你传入的 <code>Props</code></li> <li>在我看来，这中间其实缺少了一部分的文档，来指导新用户如何找到所需要的类型。既然社区没有提供，那就我来吧。</li> <li>当然，让每个开发者都熟记所有的类型肯定是不现实的，总不能每接触一个新的库，就要去记一堆类型吧。放心，世界还是美好的，这种事情，当然是有方法的。</li> <li>最直白的方法就是去看库的 <code>Types Definition</code>，也就是那些 <code>.*d.ts</code> 文件。如果你刚好有在用 <code>VS Code</code> 的话，有一个非常方便的操作：把鼠标移动到你想知道它类型的代码上（比如某个变量、某个函数调用，或是某个 JSX 标签、某个组件的 props），右键选择「Go to Definition」（或者光标选中后按 F12），就可以跳转到它的类型定义文件了。</li> <li>如果你更习惯使用 VS Code 之外的编辑器，我相信时至今日，它们应该也都早就对 <code>TypeScript</code> 提供了支持。具体操作我不太熟悉，你可以自己探索下（我一直用 VS Code，其它的不太熟）</li> <li>一般来说，这个操作可以直接把你带到你想要的地方，但考虑到类型是可以继承的，有时候一次跳转可能不太够，遇到这种情况，那就需要你随机应变一下，沿着继承关系多跳几次，直到找到你想要的内容。</li> <li>对于不熟悉的类型，可以通过这个方法去寻找，慢慢熟悉以后，你会发现，一些常见的类型还是很好找的，稍微联想一下英文的表达方式，配合自动补全的提示，一般都不难找到</li></ul> <h3 id="_16-6-常见-types-之-dom"><a href="#_16-6-常见-types-之-dom" class="header-anchor">#</a> 16.6 常见 Types 之 DOM</h3> <ul><li><code>TypeScript</code> 自带了一些基本的类型定义，包括 ECMAScript 和 DOM 的类型定义，所有你需要的类型都可以从这里找到。如果你想做一些「纯 TypeScript 开发」的话，有这些就够了</li> <li>比如下面这张截图，就是对 <code>&lt;div&gt;</code> 标签的类型定义。我们可以看到，它继承了更加通用的 <code>HTMLElement</code> 类型，并且扩展了一个即将被废弃的 <code>align</code> 属性，以及两组 <code>addEventListener</code> 和 <code>removeEventListener</code>，注意这里使用了重载。</li></ul> <p><img src="https://s.poetries.top/gitee/20190903/3.png" alt=""></p> <blockquote><p>这里的命名也不是随便起的，都是在 MDN 上可以查到的。还是以 <code>&lt;div&gt;</code> 为例，我们已经知道它继承自 <code>HTMLElement</code>，其实再往上，<code>HTMLElement</code> 继承自 <code>Element</code>，<code>Element</code> 又继承自 <code>Node</code>，顺着这条路，你可以挖掘出所有 <code>HTML</code> 标签的类型</p></blockquote> <p><img src="https://s.poetries.top/gitee/20190903/4.png" alt=""></p> <blockquote><p>对于一些 DOM 相关的属性，比如 <code>onclick</code>、<code>onchange</code> 等，你都可以如法炮制，找到它们的定义。</p></blockquote> <h3 id="_16-7-常见-types-之-react"><a href="#_16-7-常见-types-之-react" class="header-anchor">#</a> 16.7 常见 Types 之 React</h3> <ul><li>关于 TypeScript 的问题，有不少其实是在使用第三方库的时候遇到的，React 就是其中比较典型的一个</li> <li>其实方法都一样，只不过相关的类型定义不在 <code>TypeScript</code> 中，而是在 <code>@types/react</code> 中。</li> <li><code>React</code> 的类型定义的名称其实也很直观，比如我们常见的 <code>React.Component</code>，在定义 <code>Class</code> 组件时，我们需要对 <code>Props</code> 和 <code>State</code> 预先进行类型定义，为什么呢？答案就在它的类型定义中</li></ul> <p><img src="https://s.poetries.top/gitee/20190903/5.png" alt=""></p> <ul><li>再比如，当我们在写一些组件时，我们可能会需要向下传递 <code>this.props.children</code>，但 <code>children</code> 并没有被设为默认值，需要我们自己定义到 <code>props</code> 上，那么它的类型应该是什么呢</li> <li>到类型定义中搜一下关键字 <code>children</code>，很快我们就找到了下面的定义</li></ul> <p><img src="https://s.poetries.top/gitee/20190903/6.png" alt=""></p> <blockquote><p>所有 <code>React</code> 中 <code>JSX</code> 所代表的内容，无论是 <code>render()</code> 的返回，还是 <code>children</code>，我们都可以定义为一个 <code>ReactNode</code>。那这个 <code>ReactNode</code> 长什么样呢？我们通过右键继续寻找</p></blockquote> <p><img src="https://s.poetries.top/gitee/20190903/7.png" alt=""></p> <blockquote><p>看到这里，我们不光找到了我们想要的类型，还顺带明白了为什么 <code>render()</code> 可以返回 <code>boolean</code>、<code>null</code>、<code>undefined</code> 表示不渲染任何内容。
那么事件呢？当我们给组件定义事件处理函数的时候，也经常会被要求指定类型。还是老办法，找不到咱就搜，比如 <code>onClick</code> 不清楚，那我们就以它为关键字去搜</p></blockquote> <p><img src="https://s.poetries.top/gitee/20190903/8.png" alt=""></p> <blockquote><p>据此我们找到一个叫 <code>MouseEventHandler</code> 的定义，这名字，够直白吧。好了，我们找到想要的了。不过既然来了，不如继续看一下，看看还能发现什么。我们右键 <code>MouseEventHandler</code> 急需往下看：</p></blockquote> <p><img src="https://s.poetries.top/gitee/20190903/9.png" alt=""></p> <blockquote><p>看到了吗，所有的事件处理函数都有对应的定义，每个都需要一个泛型参数，传递了事件的类型，名称也挺直白的</p></blockquote> <p><img src="https://s.poetries.top/gitee/20190903/10.png" alt=""></p> <blockquote><p>事件的类型也被我们挖出来了，以后如果需要单独定义一个事件相关的类型，就可以直接用了。以此类推，不管是什么东西的类型，都可以去它们对应的 <code>@types/xxx</code>里，按关键字搜</p></blockquote> <h3 id="_16-8-多重-extends"><a href="#_16-8-多重-extends" class="header-anchor">#</a> 16.8 多重 extends</h3> <ul><li>我们知道 <code>Interface</code> 是可以多继承的，<code>extends</code> 后面可以跟多个其它 <code>Interface</code>，我们不能保证被继承的多个 <code>Interface</code> 一定没有重复的属性，那么当属性重复，但类型定义不同时，最终的结果会怎么样呢？</li> <li>在 <code>TypeScript</code> 中，<code>Interface</code> 会按照从右往左的顺序去合并多个被继承的 <code>Interface</code>，也就是说，同名属性，左边的会覆盖右边的</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
  value<span class="token operator">?</span><span class="token operator">:</span> string
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">B</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> string
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">C</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> number
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">D</span> <span class="token keyword">extends</span> <span class="token class-name">A</span><span class="token punctuation">,</span> <span class="token constant">B</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token comment">// value?: string</span>
<span class="token keyword">interface</span> <span class="token class-name">E</span> <span class="token keyword">extends</span> <span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token constant">C</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token comment">// value: string</span>
</code></pre></div><h3 id="_16-9-obj-prop-无法访问怎么办"><a href="#_16-9-obj-prop-无法访问怎么办" class="header-anchor">#</a> 16.9 obj[prop] 无法访问怎么办</h3> <ul><li>有时候我们会定义一些集合型的数据，例如对象、枚举等，但在调用的时候，我们未必会直接通过 <code>obj.prop</code> 的形式去调用，可能会是以 <code>obj[prop]</code> 这种动态索引的形式去访问，但通过动态索引的方式就无法确定最终访问的元素是否存在，因此在 <code>TypeScript</code> 中，默认是不允许这种操作的</li> <li>但这又是个非常合理，而且非常常见的场景，怎么办呢？<code>TypeScript</code> 允许为类型添加索引，以实现这一点。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">x</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  <span class="token literal-property property">y</span><span class="token operator">:</span> number
  <span class="token punctuation">[</span>index<span class="token operator">:</span> string<span class="token punctuation">]</span><span class="token operator">:</span> string <span class="token operator">|</span> number
<span class="token punctuation">}</span>
</code></pre></div><ul><li>这个方法虽然有效，但每次都要手动为类型加索引，重复多了也挺心累的。包括在一些「配置对象」中，我们甚至无法确定有哪些类型，有没有一种更加通用、更加一劳永逸的方法。</li> <li>其实在 <code>TypeScript</code>的官方文档中就有提到这个方案，官方管它叫 <code>OptionBag</code>，大概就是指 <code>config</code>、o<code>ption</code> 等用于提供配置信息的这么一类参数。我不是很确定这到底是个常规的英文单词，还是 <code>TypeScript</code> 中特定的术语（个人感觉是前者），反正就这么个意思吧。
简单说来，我们可以定义下面这样一个类型：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">interface</span> <span class="token class-name">OptionBag</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>index<span class="token operator">:</span> string<span class="token punctuation">]</span><span class="token operator">:</span> any
<span class="token punctuation">}</span>
</code></pre></div><ul><li>这是一个非常通用的结构，以字符串为键，值可以是任何类型，并且支持索引 —— 这不就是 <code>Object</code> 么。</li> <li>之后所有需要动态索引的结构，或是作为配置对象的结构，都可以直接指定为，或是继承 <code>OptionBag</code>。这个方案以牺牲一定的类型检查为代价，换取了操作上的便利。</li> <li>理论上讲，<code>OptionBag</code> 可以适用于所有类似对象这样的结构，但不建议各位真就这么做。这个方案只能是用在一些对类型要求不那么严格，或是无法预知类型的场景中，能够确定的类型还是尽可能地写一下，否则就失去了使用 <code>TypeScript</code> 意义了</li></ul> <h2 id="十七、其他技巧"><a href="#十七、其他技巧" class="header-anchor">#</a> 十七、其他技巧</h2> <p><strong>1. 安全导航操作符 ( ?. )和非空断言操作符（!.）</strong></p> <ul><li><strong>安全导航操作符 ( ?. ) 和空属性路径</strong>：</li></ul> <blockquote><p>为了解决导航时变量值为null时，页面运行时出错的问题</p></blockquote> <ul><li><strong>非空断言操作符</strong></li></ul> <blockquote><p>能确定变量值一定不为空时使用。与安全导航操作符不同的是，非空断言操作符不会防止出现 <code>null</code> 或 <code>undefined</code></p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>let s = e!.name; // 断言e是非空并访问name属性
</code></pre></div><h1 id="第二章-工程篇"><a href="#第二章-工程篇" class="header-anchor">#</a> 第二章 工程篇</h1> <p><img src="https://s.poetries.top/gitee/20190903/gongcheng-1.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/gongcheng-2.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/gongcheng-3.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/gongcheng-4.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/gongcheng-5.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/gongcheng-6.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/gongcheng-7.webp" alt=""> <img src="https://s.poetries.top/gitee/20190903/gongcheng-8.webp" alt=""></p> <h2 id="一、使用命名空间"><a href="#一、使用命名空间" class="header-anchor">#</a> 一、使用命名空间</h2> <blockquote><p>不要在一个模块中使用命名空间，最好在一个全局中使用</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.ts</span>
namespace Shape <span class="token punctuation">{</span>
    <span class="token keyword">const</span> pi <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span>
    <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">cricle</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">r</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> pi <span class="token operator">*</span> r <span class="token operator">**</span> <span class="token number">2</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// b.ts</span>

<span class="token comment">// 三斜线引用a</span>
<span class="token comment">/// &lt;reference path="a.ts" /&gt;</span>
namespace Shape <span class="token punctuation">{</span>
    <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">x</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> x <span class="token operator">*</span> x
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Shape<span class="token punctuation">.</span><span class="token function">cricle</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Shape<span class="token punctuation">.</span><span class="token function">square</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// 更方便使用 不是es6中的import</span>
<span class="token keyword">import</span> cricle <span class="token operator">=</span> Shape<span class="token punctuation">.</span>cricle
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">cricle</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="二、理解联合声明"><a href="#二、理解联合声明" class="header-anchor">#</a> 二、理解联合声明</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 接口声明合并</span>
<span class="token keyword">interface</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">x</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
    <span class="token comment">// y: string;</span>
    <span class="token function">foo</span><span class="token punctuation">(</span>bar<span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token operator">:</span> number<span class="token punctuation">;</span> <span class="token comment">// 5</span>
    <span class="token function">foo</span><span class="token punctuation">(</span>bar<span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">)</span><span class="token operator">:</span> string<span class="token punctuation">;</span> <span class="token comment">// 2</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">y</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
    <span class="token function">foo</span><span class="token punctuation">(</span>bar<span class="token operator">:</span> string<span class="token punctuation">)</span><span class="token operator">:</span> string<span class="token punctuation">;</span> <span class="token comment">// 3</span>
    <span class="token function">foo</span><span class="token punctuation">(</span>bar<span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>
    <span class="token function">foo</span><span class="token punctuation">(</span>bar<span class="token operator">:</span> <span class="token string">'b'</span><span class="token punctuation">)</span><span class="token operator">:</span> string<span class="token punctuation">;</span> <span class="token comment">// 1</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token constant">A</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">bar</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> bar
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 命名空间和类声明合并--命名空间需要放到后面</span>
<span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
namespace <span class="token constant">C</span> <span class="token punctuation">{</span>
    <span class="token keyword">export</span> <span class="token keyword">let</span> state <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">C</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span>

<span class="token comment">// 命名空间和函数声明合并--命名空间需要放到后面</span>
<span class="token keyword">function</span> <span class="token function">Lib</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
namespace Lib <span class="token punctuation">{</span>
    <span class="token keyword">export</span> <span class="token keyword">let</span> version <span class="token operator">=</span> <span class="token string">'1.0'</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Lib<span class="token punctuation">.</span>version<span class="token punctuation">)</span>

<span class="token comment">// 命名空间和枚举声明合并--位置没有要求</span>
<span class="token keyword">enum</span> Color <span class="token punctuation">{</span>
    Red<span class="token punctuation">,</span>
    Yellow<span class="token punctuation">,</span>
    Blue
<span class="token punctuation">}</span>
namespace Color <span class="token punctuation">{</span>
    <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">mix</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Color<span class="token punctuation">)</span>
</code></pre></div><h2 id="三、如何编写声明文件-引入类库"><a href="#三、如何编写声明文件-引入类库" class="header-anchor">#</a> 三、如何编写声明文件--引入类库</h2> <blockquote><p>类库分为三类：全局类库、模块类库、<code>UMD</code>类库</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>declare <span class="token keyword">var</span> <span class="token comment">// 声明全局变量</span>
declare <span class="token keyword">function</span> <span class="token comment">// 声明全局方法</span>
declare <span class="token keyword">class</span> <span class="token comment">// 声明全局类</span>
declare <span class="token keyword">enum</span> <span class="token comment">// 声明全局枚举类型</span>
declare global <span class="token comment">// 扩展全局变量</span>
declare module <span class="token comment">// 扩展模块</span>
</code></pre></div><blockquote><p>大多数的声明文件社区已经帮我们安装好了，使用<code>@types/包名</code>声明文件即可</p></blockquote> <blockquote><p>Typescript声明文件查找 https://microsoft.github.io/TypeSearch/</p></blockquote> <p><strong>以jquery为例子</strong></p> <div class="language- extra-class"><pre class="language-text"><code>yarn add @types/jquery 
</code></pre></div><p><strong>引入了一个JS类库，但是社区又没有提供类型声明文件，我该如何去编写它的类型声明文件</strong></p> <blockquote><p>先确定这个库的类型，全局库、模块库、还是UMD库，然后参照下面介绍的方法，把它的<code>API</code>声明逐步添加进来（暂时用不到的<code>API</code>也可以不写）</p></blockquote> <h3 id="_3-1-三种类库声明文件写法"><a href="#_3-1-三种类库声明文件写法" class="header-anchor">#</a> 3.1 三种类库声明文件写法</h3> <h4 id="_3-1-1-全局库"><a href="#_3-1-1-全局库" class="header-anchor">#</a> 3.1.1 全局库</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// global-lib.d.ts</span>
    
declare <span class="token keyword">function</span> <span class="token function">globalLib</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">options</span><span class="token operator">:</span> globalLib<span class="token punctuation">.</span>Options</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token comment">// 函数和命名空间的声明合并 为这个函数提供了一些属性</span>
declare namespace globalLib <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token literal-property property">version</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    <span class="token keyword">interface</span> <span class="token class-name">Options</span> <span class="token punctuation">{</span>
        <span class="token punctuation">[</span>key<span class="token operator">:</span> string<span class="token punctuation">]</span><span class="token operator">:</span> any
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// global-lib.js</span>
<span class="token comment">// 和声明文件对应</span>
<span class="token keyword">function</span> <span class="token function">globalLib</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

globalLib<span class="token punctuation">.</span>version <span class="token operator">=</span> <span class="token string">'1.0.0'</span><span class="token punctuation">;</span>

globalLib<span class="token punctuation">.</span><span class="token function-variable function">doSomething</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'globalLib do something'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 全局使用 index.ts</span>
<span class="token function">globalLib</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
globalLib<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_3-1-2-模块类库"><a href="#_3-1-2-模块类库" class="header-anchor">#</a> 3.1.2 模块类库</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module-lib.d.ts</span>
declare <span class="token keyword">function</span> <span class="token function">moduleLib</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">options</span><span class="token operator">:</span> Options</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>

<span class="token keyword">interface</span> <span class="token class-name">Options</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>key<span class="token operator">:</span> string<span class="token punctuation">]</span><span class="token operator">:</span> any
<span class="token punctuation">}</span>

declare namespace moduleLib <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token literal-property property">version</span><span class="token operator">:</span> string
    <span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token operator">=</span> moduleLib
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module-lib.js</span>
<span class="token keyword">const</span> version <span class="token operator">=</span> <span class="token string">'1.0.0'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'moduleLib do something'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">moduleLib</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

moduleLib<span class="token punctuation">.</span>version <span class="token operator">=</span> version<span class="token punctuation">;</span>
moduleLib<span class="token punctuation">.</span>doSomething <span class="token operator">=</span> doSomething<span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> moduleLib<span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.ts 使用</span>
<span class="token keyword">import</span> umdLib <span class="token keyword">from</span> <span class="token string">'./umd-lib'</span>

umdLib<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_3-1-3-umd类库"><a href="#_3-1-3-umd类库" class="header-anchor">#</a> 3.1.3 UMD类库</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// umd-lib.d.ts</span>

declare namespace umdLib <span class="token punctuation">{</span>
    <span class="token comment">// 省略了export</span>
    <span class="token keyword">const</span> <span class="token literal-property property">version</span><span class="token operator">:</span> string
    <span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>

<span class="token comment">// UMD库不可缺少的语句</span>
<span class="token keyword">export</span> <span class="token keyword">as</span> namespace umdLib

<span class="token keyword">export</span> <span class="token operator">=</span> umdLib
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// umd-lib.js</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> factory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">"function"</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">define</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> module <span class="token operator">===</span> <span class="token string">"object"</span> <span class="token operator">&amp;&amp;</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        root<span class="token punctuation">.</span>umdLib <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token comment">// 需要为这两个成员编写声明文件</span>
        <span class="token literal-property property">version</span><span class="token operator">:</span> <span class="token string">'1.0.0'</span><span class="token punctuation">,</span>
        <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'umdLib do something'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.ts使用</span>
<span class="token keyword">import</span> umdLib <span class="token keyword">from</span> <span class="token string">'./umd-lib'</span>
<span class="token comment">// 可以不用导入umd-lib模块。但是需要打开tsconfig.tson中的umd配置</span>
umdLib<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_3-2-两种插件声明文件写法"><a href="#_3-2-两种插件声明文件写法" class="header-anchor">#</a> 3.2 两种插件声明文件写法</h3> <h4 id="_3-2-1-模块化插件declare-module"><a href="#_3-2-1-模块化插件declare-module" class="header-anchor">#</a> 3.2.1 模块化插件declare module</h4> <blockquote><p><code>declare module</code> 可以给类库添加一些自定义方法。 扩展模块</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 模块插件</span>
<span class="token keyword">import</span> m <span class="token keyword">from</span> <span class="token string">'moment'</span><span class="token punctuation">;</span>
declare module <span class="token string">'moment'</span> <span class="token punctuation">{</span>
    <span class="token comment">// 给moment自定义一些方法</span>
    <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">myFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
m<span class="token punctuation">.</span><span class="token function-variable function">myFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-2-2-全局插件declare-global"><a href="#_3-2-2-全局插件declare-global" class="header-anchor">#</a> 3.2.2 全局插件declare global</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 全局插件</span>
declare global <span class="token punctuation">{</span>
    namespace globalLib <span class="token punctuation">{</span>
        <span class="token keyword">function</span> <span class="token function">doAnyting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 在全局变量添加方法</span>
<span class="token comment">// 会对全局变量造成污染 一般不这么做</span>
globalLib<span class="token punctuation">.</span><span class="token function-variable function">doAnyting</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-3-jquery声明文件示例"><a href="#_3-3-jquery声明文件示例" class="header-anchor">#</a> 3.3 jquery声明文件示例</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// index.d.ts入口</span>

<span class="token comment">// Type definitions for jquery 3.3</span>
<span class="token comment">// Project: https://jquery.com</span>
<span class="token comment">// Definitions by: Leonard Thieu &lt;https://github.com/leonard-thieu&gt;</span>
<span class="token comment">//                 Boris Yankov &lt;https://github.com/borisyankov&gt;</span>
<span class="token comment">//                 Christian Hoffmeister &lt;https://github.com/choffmeister&gt;</span>
<span class="token comment">//                 Steve Fenton &lt;https://github.com/Steve-Fenton&gt;</span>
<span class="token comment">//                 Diullei Gomes &lt;https://github.com/Diullei&gt;</span>
<span class="token comment">//                 Tass Iliopoulos &lt;https://github.com/tasoili&gt;</span>
<span class="token comment">//                 Jason Swearingen &lt;https://github.com/jasons-novaleaf&gt;</span>
<span class="token comment">//                 Sean Hill &lt;https://github.com/seanski&gt;</span>
<span class="token comment">//                 Guus Goossens &lt;https://github.com/Guuz&gt;</span>
<span class="token comment">//                 Kelly Summerlin &lt;https://github.com/ksummerlin&gt;</span>
<span class="token comment">//                 Basarat Ali Syed &lt;https://github.com/basarat&gt;</span>
<span class="token comment">//                 Nicholas Wolverson &lt;https://github.com/nwolverson&gt;</span>
<span class="token comment">//                 Derek Cicerone &lt;https://github.com/derekcicerone&gt;</span>
<span class="token comment">//                 Andrew Gaspar &lt;https://github.com/AndrewGaspar&gt;</span>
<span class="token comment">//                 Seikichi Kondo &lt;https://github.com/seikichi&gt;</span>
<span class="token comment">//                 Benjamin Jackman &lt;https://github.com/benjaminjackman&gt;</span>
<span class="token comment">//                 Poul Sorensen &lt;https://github.com/s093294&gt;</span>
<span class="token comment">//                 Josh Strobl &lt;https://github.com/JoshStrobl&gt;</span>
<span class="token comment">//                 John Reilly &lt;https://github.com/johnnyreilly&gt;</span>
<span class="token comment">//                 Dick van den Brink &lt;https://github.com/DickvdBrink&gt;</span>
<span class="token comment">//                 Thomas Schulz &lt;https://github.com/King2500&gt;</span>
<span class="token comment">//                 Terry Mun &lt;https://github.com/terrymun&gt;</span>
<span class="token comment">// Definitions: https://github.com/DefinitelyTyped/DefinitelyTyped</span>
<span class="token comment">// TypeScript Version: 2.3</span>

<span class="token comment">// 三斜线引入模块</span>

<span class="token comment">/// &lt;reference types="sizzle" /&gt;</span>
<span class="token comment">/// &lt;reference path="JQueryStatic.d.ts" /&gt;</span>
<span class="token comment">/// &lt;reference path="JQuery.d.ts" /&gt;</span>
<span class="token comment">/// &lt;reference path="misc.d.ts" /&gt;</span>
<span class="token comment">/// &lt;reference path="legacy.d.ts" /&gt;</span>

<span class="token keyword">export</span> <span class="token operator">=</span> jQuery<span class="token punctuation">;</span>
</code></pre></div><h2 id="四、配置tsconfig-json"><a href="#四、配置tsconfig-json" class="header-anchor">#</a> 四、配置tsconfig.json</h2> <h3 id="_4-1-基础配置"><a href="#_4-1-基础配置" class="header-anchor">#</a> 4.1 基础配置</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token comment">// ===与文件相关的选项===</span>
  <span class="token string-property property">"files"</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'src/index.ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 编译的文件列表</span>
  <span class="token string-property property">"include"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'src'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 指定编译文件</span>
  <span class="token string-property property">"exclude"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'src/lib'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 排除编译文件</span>
  
  <span class="token comment">// ====与编译相关的选项====</span>
  <span class="token string-property property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// "incremental": true,                // 增量编译，再次编译会增量编译</span>
      <span class="token comment">// "tsBuildInfoFile": "./buildFile",   // 增量编译文件的存储位置</span>
      <span class="token comment">// "diagnostics": true,                // 打印诊断信息</span>

      <span class="token comment">// "target": "es5",           // 目标语言的版本</span>
      <span class="token comment">// "module": "commonjs",      // 生成代码的模块标准</span>
      <span class="token comment">// "outFile": "./app.js",     // 将多个相互依赖的文件生成一个文件，可以用在 AMD 模块中</span>
        
       <span class="token comment">// 比如你需要使用es2019方法 需要在这里导入模块 "lib": ['es2019.arrary']</span>
      <span class="token comment">// "lib": [],                 // TS 需要引用的库，即声明文件，es5 默认 "dom", "es5", "scripthost"</span>

      <span class="token comment">// "allowJs": true,           // 允许编译 JS 文件（js、jsx）</span>
      <span class="token comment">// "checkJs": true,           // 允许在 JS 文件中报错，通常与 allowJS 一起使用</span>
      <span class="token comment">// "outDir": "./out",         // 指定输出目录</span>
      <span class="token comment">// "rootDir": "./",           // 指定输入文件目录（用于输出）</span>

      <span class="token comment">// "declaration": true,         // 生成声明文件</span>
      <span class="token comment">// "declarationDir": "./d",     // 声明文件的路径</span>
      <span class="token comment">// "emitDeclarationOnly": true, // 只生成声明文件</span>
      <span class="token comment">// "sourceMap": true,           // 生成目标文件的 sourceMap</span>
      <span class="token comment">// "inlineSourceMap": true,     // 生成目标文件的 inline sourceMap</span>
      <span class="token comment">// "declarationMap": true,      // 生成声明文件的 sourceMap</span>
      <span class="token comment">// "typeRoots": [],             // 声明文件目录，默认 node_modules/@types</span>
      <span class="token comment">// "types": [],                 // 声明文件包</span>

      <span class="token comment">// "removeComments": true,    // 删除注释</span>

      <span class="token comment">// "noEmit": true,            // 不输出文件</span>
      <span class="token comment">// "noEmitOnError": true,     // 发生错误时不输出文件</span>

      <span class="token comment">// "noEmitHelpers": true,     // 不生成 helper 函数，需额外安装 ts-helpers</span>
      <span class="token comment">// "importHelpers": true,     // 通过 tslib 引入 helper 函数，文件必须是模块</span>

      <span class="token comment">// "downlevelIteration": true,    // 降级遍历器的实现（es3/5）</span>

      <span class="token comment">// "strict": true,                        // 开启所有严格的类型检查</span>
      <span class="token comment">// "alwaysStrict": false,                 // 在代码中注入 "use strict";</span>
      <span class="token comment">// "noImplicitAny": false,                // 不允许隐式的 any 类型</span>
      <span class="token comment">// "strictNullChecks": false,             // 不允许把 null、undefined 赋值给其他类型变量</span>
      <span class="token comment">// "strictFunctionTypes": false           // 不允许函数参数双向协变</span>
      <span class="token comment">// "strictPropertyInitialization": false, // 类的实例属性必须初始化</span>
      <span class="token comment">// "strictBindCallApply": false,          // 严格的 bind/call/apply 检查</span>
      <span class="token comment">// "noImplicitThis": false,               // 不允许 this 有隐式的 any 类型</span>

      <span class="token comment">// "noUnusedLocals": true,                // 检查只声明，未使用的局部变量</span>
      <span class="token comment">// "noUnusedParameters": true,            // 检查未使用的函数参数</span>
      <span class="token comment">// "noFallthroughCasesInSwitch": true,    // 防止 switch 语句贯穿</span>
      <span class="token comment">// "noImplicitReturns": true,             // 每个分支都要有返回值</span>

      <span class="token comment">// "esModuleInterop": true,               // 允许 export = 导出，由import from 导入</span>
      <span class="token comment">// "allowUmdGlobalAccess": true,          // 允许在模块中访问 UMD 全局变量</span>
      <span class="token comment">// "moduleResolution": "node",            // 模块解析策略</span>
      <span class="token comment">// "baseUrl": "./",                       // 解析非相对模块的基地址</span>
      <span class="token comment">// "paths": {                             // 路径映射，相对于 baseUrl</span>
      <span class="token comment">//   "jquery": ["node_modules/jquery/dist/jquery.slim.min.js"]</span>
      <span class="token comment">// },</span>
      <span class="token comment">// "rootDirs": ["src", "out"],            // 将多个目录放在一个虚拟目录下，用于运行时</span>

      <span class="token comment">// "listEmittedFiles": true,        // 打印输出的文件</span>
      <span class="token comment">// "listFiles": true,               // 打印编译的文件（包括引用的声明文件）</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>也可以把公共的抽离出来</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// tsconfig.base.json</span>

<span class="token punctuation">{</span>
  <span class="token string-property property">"files"</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'src/index.ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 编译的文件列表</span>
  <span class="token string-property property">"include"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'src'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 指定编译文件</span>
  <span class="token string-property property">"exclude"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'src/lib'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 排除编译文件</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token string-property property">"extends"</span><span class="token operator">:</span> <span class="token string">'./tsconfig.base'</span><span class="token punctuation">,</span>
<span class="token string-property property">"exclude"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 覆盖之前的</span>
</code></pre></div><h3 id="_4-2-工程引用配置多个项目"><a href="#_4-2-工程引用配置多个项目" class="header-anchor">#</a> 4.2 工程引用配置多个项目</h3> <blockquote><p>每个项目都有一份独立的<code>tsconfig.json</code>，继承一份公共的配置，最后可单独构建每个子项目工程</p></blockquote> <blockquote><p>参考学习<code>typescript</code>项目 https://github.com/microsoft/TypeScript/tree/master/src</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 示例 项目入口</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">"target"</span><span class="token operator">:</span> <span class="token string">"es5"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"module"</span><span class="token operator">:</span> <span class="token string">"commonjs"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"strict"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string-property property">"composite"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string-property property">"declaration"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 子工程1</span>
<span class="token comment">// src/client/tsconfig.json</span>
<span class="token punctuation">{</span>
    <span class="token string-property property">"extends"</span><span class="token operator">:</span> <span class="token string">"../../tsconfig.json"</span><span class="token punctuation">,</span> <span class="token comment">//继承基础配置</span>
    <span class="token string-property property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">"outDir"</span><span class="token operator">:</span> <span class="token string">"../../dist/client"</span><span class="token punctuation">,</span> <span class="token comment">// 输出文件</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">"references"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token string-property property">"path"</span><span class="token operator">:</span> <span class="token string">"../common"</span> <span class="token punctuation">}</span> <span class="token comment">// 依赖文件</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 子工程2</span>
<span class="token comment">// src/server/tsconfig.json</span>

<span class="token punctuation">{</span>
    <span class="token string-property property">"extends"</span><span class="token operator">:</span> <span class="token string">"../../tsconfig.json"</span><span class="token punctuation">,</span>
    <span class="token string-property property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">"outDir"</span><span class="token operator">:</span> <span class="token string">"../../dist/server"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">"references"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token string-property property">"path"</span><span class="token operator">:</span> <span class="token string">"../common"</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="五、编译工具ts-loader、ts-lint"><a href="#五、编译工具ts-loader、ts-lint" class="header-anchor">#</a> 五、编译工具ts-loader、ts-lint</h2> <p><strong>如何选择Typescript编译器</strong></p> <blockquote><ul><li>如果没有使用过<code>babel</code>，首选<code>Typescript</code>自身编译器(可配合<code>Ts-loader</code>使用)</li> <li>如果项目中已经使用<code>babel</code>，安装<code>@babel/preset-typescript</code>(可配合tsc做类型检查)</li> <li>两种编译工具不要混用</li></ul></blockquote> <p><strong>typescript-eslint与babel-eslint区别</strong></p> <blockquote><ul><li><code>babel-eslint</code>支持<code>typescript</code>没有额外的语法检查，抛弃<code>typescript</code>,不支持类型检查</li> <li><code>typescript-eslint</code>基础typescript的AST,基于创建基于类型信息的规则（<code>tsconfig.json</code>）</li></ul></blockquote> <ul><li>两者底层机制不一样，不要一起使用</li> <li><code>babel</code>体系建议使用<code>babel-eslint</code>，否则使用<code>typescript-eslint</code></li></ul> <p><strong>总结</strong></p> <ul><li><p>编译工具</p> <ul><li><code>ts-loader</code></li> <li><code>@babel/preset-typescript</code></li></ul></li> <li><p>代码检查工具</p> <ul><li><code>babel-eslint</code></li> <li><code>typescript-eslint</code></li></ul></li></ul> <h2 id="六、使用jest进行单元测试"><a href="#六、使用jest进行单元测试" class="header-anchor">#</a> 六、使用jest进行单元测试</h2> <ul><li>单元测试工具
<ul><li><code>ts-jest</code> -- 能够在测试用例中进行类型检查</li> <li><code>babel-jest</code> -- 没有进行类型检查</li></ul></li></ul> <blockquote><p>生成配置文件 <code>ts-jest config:init</code></p></blockquote> <h1 id="第三章-项目实战"><a href="#第三章-项目实战" class="header-anchor">#</a> 第三章 项目实战</h1> <h2 id="一、思维导图"><a href="#一、思维导图" class="header-anchor">#</a> 一、思维导图</h2> <p><img src="https://s.poetries.top/gitee/20190903/1.png" alt=""> <img src="https://s.poetries.top/gitee/20190903/2.png" alt=""></p> <h2 id="二、react项目实践"><a href="#二、react项目实践" class="header-anchor">#</a> 二、React项目实践</h2> <h3 id="_2-1-手动创建react项目"><a href="#_2-1-手动创建react项目" class="header-anchor">#</a> 2.1 手动创建react项目</h3> <blockquote><p>项目代码 https://github.com/poetries/typescript-in-action/tree/master/ts-react</p></blockquote> <p><strong>1. 安装依赖文件</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>yarn add @types<span class="token operator">/</span>react @types<span class="token operator">/</span>react<span class="token operator">-</span>dom
</code></pre></div><p><strong>2. 修改tsconfig.json</strong>配置</p> <blockquote><p>修改 <code>compilerOptions</code>中的<code>jsx</code>为<code>react</code></p></blockquote> <h3 id="_2-2-使用脚手架安装"><a href="#_2-2-使用脚手架安装" class="header-anchor">#</a> 2.2 使用脚手架安装</h3> <blockquote><p>项目代码 https://github.com/poetries/typescript-in-action/tree/master/ts-react-app</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>create-react-app ts-react-app --typescript
</code></pre></div><h4 id="_2-2-1-函数组件"><a href="#_2-2-1-函数组件" class="header-anchor">#</a> 2.2.1 函数组件</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">Greeting</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token literal-property property">firstName</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token literal-property property">lastName</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">Hello</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">props</span><span class="token operator">:</span> Greeting</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>Button<span class="token operator">&gt;</span>Hello <span class="token punctuation">{</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span>

<span class="token comment">// const Hello: React.FC&lt;Greeting&gt; = ({</span>
<span class="token comment">//     name,</span>
<span class="token comment">//     firstName,</span>
<span class="token comment">//     lastName,</span>
<span class="token comment">//     children</span>
<span class="token comment">// }) =&gt; &lt;Button&gt;Hello {name}&lt;/Button&gt;</span>

Hello<span class="token punctuation">.</span>defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">''</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Hello<span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-2-类组件"><a href="#_2-2-2-类组件" class="header-anchor">#</a> 2.2.2 类组件</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">Greeting</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    firstName<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    lastName<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">HelloState</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">count</span><span class="token operator">:</span> number
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">HelloClass</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token operator">&lt;</span>Greeting<span class="token punctuation">,</span> HelloState<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">state</span><span class="token operator">:</span> HelloState <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>你点击了 <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span> 次<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
                    Hello <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> HelloClass<span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-3-高阶组件"><a href="#_2-2-3-高阶组件" class="header-anchor">#</a> 2.2.3 高阶组件</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> HelloClass <span class="token keyword">from</span> <span class="token string">'./HelloClass'</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">Loading</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">loading</span><span class="token operator">:</span> boolean
<span class="token punctuation">}</span>

<span class="token keyword">function</span> HelloHOC<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>WrappedComponent<span class="token operator">:</span> React<span class="token punctuation">.</span>ComponentType<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> Component<span class="token operator">&lt;</span><span class="token constant">P</span> <span class="token operator">&amp;</span> Loading<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> <span class="token punctuation">{</span> loading<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>
            <span class="token keyword">return</span> loading <span class="token operator">?</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Loading<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span> <span class="token operator">:</span> <span class="token operator">&lt;</span>WrappedComponent <span class="token punctuation">{</span> <span class="token operator">...</span>props <span class="token keyword">as</span> <span class="token constant">P</span> <span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">HelloHOC</span><span class="token punctuation">(</span>HelloClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-4-hooks组件"><a href="#_2-2-4-hooks组件" class="header-anchor">#</a> 2.2.4 Hooks组件</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">Greeting</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token literal-property property">firstName</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token literal-property property">lastName</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">HelloHooks</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">props</span><span class="token operator">:</span> Greeting</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> setText<span class="token punctuation">]</span> <span class="token operator">=</span> useState<span class="token operator">&lt;</span>string <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">'休息一下'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>你点击了 <span class="token punctuation">{</span>count<span class="token punctuation">}</span> 次 <span class="token punctuation">{</span>text<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
                Hello <span class="token punctuation">{</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

HelloHooks<span class="token punctuation">.</span>defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">''</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> HelloHooks<span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-5-事件处理与数据请求"><a href="#_2-2-5-事件处理与数据请求" class="header-anchor">#</a> 2.2.5 事件处理与数据请求</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Form<span class="token punctuation">,</span> Input<span class="token punctuation">,</span> Select<span class="token punctuation">,</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> FormComponentProps <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd/lib/form'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> get <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../utils/request'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">GET_EMPLOYEE_URL</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../constants/urls'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> EmployeeRequest<span class="token punctuation">,</span> EmployeeResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../interface/employee'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> Option <span class="token punctuation">}</span> <span class="token operator">=</span> Select<span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">Props</span> <span class="token keyword">extends</span> <span class="token class-name">FormComponentProps</span> <span class="token punctuation">{</span>
    <span class="token function">onDataChange</span><span class="token punctuation">(</span>data<span class="token operator">:</span> EmployeeResponse<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
<span class="token punctuation">}</span>

<span class="token comment">// Hooks version</span>
<span class="token comment">// const QueryFormHooks = (props: Props) =&gt; {</span>
<span class="token comment">//     const [name, setName] = useState('');</span>
<span class="token comment">//     const [departmentId, setDepartmentId] = useState&lt;number | undefined&gt;();</span>

<span class="token comment">//     const handleNameChange = (e: React.FormEvent&lt;HTMLInputElement&gt;) =&gt; {</span>
<span class="token comment">//         setName(e.currentTarget.value)</span>
<span class="token comment">//     }</span>

<span class="token comment">//     const handleDepartmentChange = (value: number) =&gt; {</span>
<span class="token comment">//         setDepartmentId(value)</span>
<span class="token comment">//     }</span>

<span class="token comment">//     const handleSubmit = () =&gt; {</span>
<span class="token comment">//         queryEmployee({name, departmentId});</span>
<span class="token comment">//     }</span>

<span class="token comment">//     const queryEmployee = (param: EmployeeRequest) =&gt; {</span>
<span class="token comment">//         get(GET_EMPLOYEE_URL, param).then(res =&gt; {</span>
<span class="token comment">//             props.onDataChange(res.data);</span>
<span class="token comment">//         });</span>
<span class="token comment">//     }</span>

<span class="token comment">//     useEffect(() =&gt; {</span>
<span class="token comment">//         queryEmployee({name, departmentId});</span>
<span class="token comment">//     }, [])</span>

<span class="token comment">//     return (</span>
<span class="token comment">//         &lt;&gt;</span>
<span class="token comment">//             &lt;Form layout="inline"&gt;</span>
<span class="token comment">//                 &lt;Form.Item&gt;</span>
<span class="token comment">//                     &lt;Input</span>
<span class="token comment">//                         placeholder="姓名"</span>
<span class="token comment">//                         style={{ width: 120 }}</span>
<span class="token comment">//                         allowClear</span>
<span class="token comment">//                         value={name}</span>
<span class="token comment">//                         onChange={handleNameChange}</span>
<span class="token comment">//                     /&gt;</span>
<span class="token comment">//                 &lt;/Form.Item&gt;</span>
<span class="token comment">//                 &lt;Form.Item&gt;</span>
<span class="token comment">//                 &lt;Select</span>
<span class="token comment">//                     placeholder="部门"</span>
<span class="token comment">//                     style={{ width: 120 }}</span>
<span class="token comment">//                     allowClear</span>
<span class="token comment">//                     value={departmentId}</span>
<span class="token comment">//                     onChange={handleDepartmentChange}</span>
<span class="token comment">//                 &gt;</span>
<span class="token comment">//                     &lt;Option value={1}&gt;技术部&lt;/Option&gt;</span>
<span class="token comment">//                     &lt;Option value={2}&gt;产品部&lt;/Option&gt;</span>
<span class="token comment">//                     &lt;Option value={3}&gt;市场部&lt;/Option&gt;</span>
<span class="token comment">//                     &lt;Option value={4}&gt;运营部&lt;/Option&gt;</span>
<span class="token comment">//                 &lt;/Select&gt;</span>
<span class="token comment">//                 &lt;/Form.Item&gt;</span>
<span class="token comment">//                 &lt;Form.Item&gt;</span>
<span class="token comment">//                     &lt;Button type="primary" onClick={handleSubmit}&gt;查询&lt;/Button&gt;</span>
<span class="token comment">//                 &lt;/Form.Item&gt;</span>
<span class="token comment">//             &lt;/Form&gt;</span>
<span class="token comment">//         &lt;/&gt;</span>
<span class="token comment">//     )</span>
<span class="token comment">// }</span>

<span class="token keyword">class</span> <span class="token class-name">QueryForm</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token operator">&lt;</span>Props<span class="token punctuation">,</span> EmployeeRequest<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">state</span><span class="token operator">:</span> EmployeeRequest <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        <span class="token literal-property property">departmentId</span><span class="token operator">:</span> <span class="token keyword">undefined</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">handleNameChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">e</span><span class="token operator">:</span> React<span class="token punctuation">.</span>FormEvent<span class="token operator">&lt;</span>HTMLInputElement<span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>value
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">handleDepartmentChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">departmentId</span><span class="token operator">:</span> value
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">handleSubmit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">queryEmployee</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">queryEmployee</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">queryEmployee</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">param</span><span class="token operator">:</span> EmployeeRequest</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">GET_EMPLOYEE_URL</span><span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onDataChange</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>Form layout<span class="token operator">=</span><span class="token string">"inline"</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Form<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Input
                        placeholder<span class="token operator">=</span><span class="token string">"姓名"</span>
                        style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">120</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
                        allowClear
                        value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>name<span class="token punctuation">}</span>
                        onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleNameChange<span class="token punctuation">}</span>
                    <span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>Form<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Form<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Select
                    placeholder<span class="token operator">=</span><span class="token string">"部门"</span>
                    style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">120</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
                    allowClear
                    value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>departmentId<span class="token punctuation">}</span>
                    onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleDepartmentChange<span class="token punctuation">}</span>
                <span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Option value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>技术部<span class="token operator">&lt;</span><span class="token operator">/</span>Option<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Option value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>产品部<span class="token operator">&lt;</span><span class="token operator">/</span>Option<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Option value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>市场部<span class="token operator">&lt;</span><span class="token operator">/</span>Option<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Option value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>运营部<span class="token operator">&lt;</span><span class="token operator">/</span>Option<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>Select<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>Form<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Form<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>Button type<span class="token operator">=</span><span class="token string">"primary"</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit<span class="token punctuation">}</span><span class="token operator">&gt;</span>查询<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>Form<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>Form<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> WrapQueryForm <span class="token operator">=</span> Form<span class="token punctuation">.</span>create<span class="token operator">&lt;</span>Props<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'employee_query'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>QueryForm<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> WrapQueryForm<span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-6-列表渲染"><a href="#_2-2-6-列表渲染" class="header-anchor">#</a> 2.2.6 列表渲染</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Table <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'antd'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token string">'./index.css'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> QueryForm <span class="token keyword">from</span> <span class="token string">'./QueryForm'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> employeeColumns <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./colums'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> EmployeeResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../interface/employee'</span><span class="token punctuation">;</span>

<span class="token comment">// Hooks version</span>
<span class="token comment">// const Employee = () =&gt; {</span>
<span class="token comment">//     const [employee, setEmployee] = useState&lt;EmployeeResponse&gt;(undefined);</span>

<span class="token comment">//     const getTotal = () =&gt; {</span>
<span class="token comment">//         let total: number;</span>
<span class="token comment">//         if (typeof employee !== 'undefined') {</span>
<span class="token comment">//             total = employee.length</span>
<span class="token comment">//         } else {</span>
<span class="token comment">//             total = 0</span>
<span class="token comment">//         }</span>
<span class="token comment">//         return &lt;p&gt;共 {total} 名员工&lt;/p&gt;</span>
<span class="token comment">//     }</span>

<span class="token comment">//     return (</span>
<span class="token comment">//         &lt;&gt;</span>
<span class="token comment">//             &lt;QueryForm onDataChange={setEmployee} /&gt;</span>
<span class="token comment">//             {/* {getTotal()} */}</span>
<span class="token comment">//             &lt;Table columns={employeeColumns} dataSource={employee} className="table" /&gt;</span>
<span class="token comment">//         &lt;/&gt;</span>
<span class="token comment">//     )</span>
<span class="token comment">// }</span>

<span class="token keyword">interface</span> <span class="token class-name">State</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">employee</span><span class="token operator">:</span> EmployeeResponse
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token operator">&lt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> State<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">state</span><span class="token operator">:</span> State <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">employee</span><span class="token operator">:</span> <span class="token keyword">undefined</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">setEmployee</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">employee</span><span class="token operator">:</span> EmployeeResponse</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            employee
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">getTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token literal-property property">total</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
        <span class="token comment">// 类型保护</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>employee <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            total <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>employee<span class="token punctuation">.</span>length
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            total <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>共 <span class="token punctuation">{</span>total<span class="token punctuation">}</span> 名员工<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>QueryForm onDataChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>setEmployee<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token punctuation">{</span><span class="token comment">/* {this.getTotal()} */</span><span class="token punctuation">}</span>
                <span class="token operator">&lt;</span>Table columns<span class="token operator">=</span><span class="token punctuation">{</span>employeeColumns<span class="token punctuation">}</span> dataSource<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>employee<span class="token punctuation">}</span> className<span class="token operator">=</span><span class="token string">"table"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Employee<span class="token punctuation">;</span>
</code></pre></div><h4 id="_2-2-7-redux与类型"><a href="#_2-2-7-redux与类型" class="header-anchor">#</a> 2.2.7 Redux与类型</h4> <blockquote><p>项目代码 https://github.com/poetries/typescript-in-action/tree/master/ts-redux</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Dispatch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'lodash'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> get<span class="token punctuation">,</span> post <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../utils/request'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> department<span class="token punctuation">,</span> level <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../constants/options'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span>
    <span class="token constant">GET_EMPLOYEE_URL</span><span class="token punctuation">,</span>
    <span class="token constant">CREATE_EMPLOYEE_URL</span><span class="token punctuation">,</span>
    <span class="token constant">DELETE_EMPLOYEE_URL</span><span class="token punctuation">,</span>
    <span class="token constant">UPDATE_EMPLOYEE_URL</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../constants/urls'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span>
    <span class="token constant">GET_EMPLOYEE</span><span class="token punctuation">,</span>
    <span class="token constant">CREATE_EMPLOYEE</span><span class="token punctuation">,</span>
    <span class="token constant">DELETE_EMPLOYEE</span><span class="token punctuation">,</span>
    <span class="token constant">UPDATE_EMPLOYEE</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../constants/actions'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span>
    EmployeeInfo<span class="token punctuation">,</span>
    EmployeeRequest<span class="token punctuation">,</span>
    EmployeeResponse<span class="token punctuation">,</span>
    CreateRequest<span class="token punctuation">,</span>
    DeleteRequest<span class="token punctuation">,</span>
    UpdateRequest
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../interface/employee'</span><span class="token punctuation">;</span>

type State <span class="token operator">=</span> Readonly<span class="token operator">&lt;</span><span class="token punctuation">{</span>
    <span class="token literal-property property">employeeList</span><span class="token operator">:</span> EmployeeResponse
<span class="token punctuation">}</span><span class="token operator">&gt;</span>

type Action <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token literal-property property">payload</span><span class="token operator">:</span> any<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token literal-property property">initialState</span><span class="token operator">:</span> State <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">employeeList</span><span class="token operator">:</span> <span class="token keyword">undefined</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getEmployee</span><span class="token punctuation">(</span>param<span class="token operator">:</span> EmployeeRequest<span class="token punctuation">,</span> <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">dispatch</span><span class="token operator">:</span> Dispatch</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">GET_EMPLOYEE_URL</span><span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">GET_EMPLOYEE</span><span class="token punctuation">,</span>
                <span class="token literal-property property">payload</span><span class="token operator">:</span> res<span class="token punctuation">.</span>data
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">createEmployee</span><span class="token punctuation">(</span>param<span class="token operator">:</span> CreateRequest<span class="token punctuation">,</span> <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">dispatch</span><span class="token operator">:</span> Dispatch</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">post</span><span class="token punctuation">(</span><span class="token constant">CREATE_EMPLOYEE_URL</span><span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">CREATE_EMPLOYEE</span><span class="token punctuation">,</span>
                <span class="token literal-property property">payload</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">name</span><span class="token operator">:</span> param<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
                    <span class="token literal-property property">department</span><span class="token operator">:</span> department<span class="token punctuation">[</span>param<span class="token punctuation">.</span>departmentId<span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">departmentId</span><span class="token operator">:</span> param<span class="token punctuation">.</span>departmentId<span class="token punctuation">,</span>
                    <span class="token literal-property property">hiredate</span><span class="token operator">:</span> param<span class="token punctuation">.</span>hiredate<span class="token punctuation">,</span>
                    <span class="token literal-property property">level</span><span class="token operator">:</span> level<span class="token punctuation">[</span>param<span class="token punctuation">.</span>levelId<span class="token punctuation">]</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">levelId</span><span class="token operator">:</span> param<span class="token punctuation">.</span>levelId<span class="token punctuation">,</span>
                    <span class="token operator">...</span>res<span class="token punctuation">.</span>data
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">deleteEmployee</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">param</span><span class="token operator">:</span> DeleteRequest</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">dispatch</span><span class="token operator">:</span> Dispatch</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">post</span><span class="token punctuation">(</span><span class="token constant">DELETE_EMPLOYEE_URL</span><span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">DELETE_EMPLOYEE</span><span class="token punctuation">,</span>
                <span class="token literal-property property">payload</span><span class="token operator">:</span> param<span class="token punctuation">.</span>id
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">updateEmployee</span><span class="token punctuation">(</span>param<span class="token operator">:</span> UpdateRequest<span class="token punctuation">,</span> <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">dispatch</span><span class="token operator">:</span> Dispatch</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">post</span><span class="token punctuation">(</span><span class="token constant">UPDATE_EMPLOYEE_URL</span><span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">UPDATE_EMPLOYEE</span><span class="token punctuation">,</span>
                <span class="token literal-property property">payload</span><span class="token operator">:</span> param
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> initialState<span class="token punctuation">,</span> <span class="token literal-property property">action</span><span class="token operator">:</span> Action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token constant">GET_EMPLOYEE</span><span class="token operator">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token operator">...</span>state<span class="token punctuation">,</span>
                <span class="token literal-property property">employeeList</span><span class="token operator">:</span> action<span class="token punctuation">.</span>payload
            <span class="token punctuation">}</span>
        <span class="token keyword">case</span> <span class="token constant">CREATE_EMPLOYEE</span><span class="token operator">:</span>
            <span class="token keyword">let</span> newList <span class="token operator">=</span> <span class="token punctuation">[</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>employeeList <span class="token keyword">as</span> EmployeeInfo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token operator">...</span>state<span class="token punctuation">,</span>
                <span class="token literal-property property">employeeList</span><span class="token operator">:</span> newList
            <span class="token punctuation">}</span>
        <span class="token keyword">case</span> <span class="token constant">DELETE_EMPLOYEE</span><span class="token operator">:</span>
            <span class="token keyword">let</span> reducedList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>employeeList <span class="token keyword">as</span> EmployeeInfo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            _<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>reducedList<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">item</span><span class="token operator">:</span> EmployeeInfo</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> item<span class="token punctuation">.</span>id <span class="token operator">===</span> action<span class="token punctuation">.</span>payload
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token operator">...</span>state<span class="token punctuation">,</span>
                <span class="token literal-property property">employeeList</span><span class="token operator">:</span> reducedList
            <span class="token punctuation">}</span>
        <span class="token keyword">case</span> <span class="token constant">UPDATE_EMPLOYEE</span><span class="token operator">:</span>
            <span class="token keyword">let</span> updatedList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>employeeList <span class="token keyword">as</span> EmployeeInfo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> <span class="token literal-property property">item</span><span class="token operator">:</span> UpdateRequest <span class="token operator">=</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">;</span>
            <span class="token keyword">let</span> index <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span>updatedList<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">id</span><span class="token operator">:</span> item<span class="token punctuation">.</span>id
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            updatedList<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">id</span><span class="token operator">:</span> item<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
                <span class="token literal-property property">key</span><span class="token operator">:</span> item<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
                <span class="token literal-property property">name</span><span class="token operator">:</span> item<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
                <span class="token literal-property property">department</span><span class="token operator">:</span> department<span class="token punctuation">[</span>item<span class="token punctuation">.</span>departmentId<span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token literal-property property">departmentId</span><span class="token operator">:</span> item<span class="token punctuation">.</span>departmentId<span class="token punctuation">,</span>
                <span class="token literal-property property">hiredate</span><span class="token operator">:</span> item<span class="token punctuation">.</span>hiredate<span class="token punctuation">,</span>
                <span class="token literal-property property">level</span><span class="token operator">:</span> level<span class="token punctuation">[</span>item<span class="token punctuation">.</span>levelId<span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token literal-property property">levelId</span><span class="token operator">:</span> item<span class="token punctuation">.</span>levelId
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token operator">...</span>state<span class="token punctuation">,</span>
                <span class="token literal-property property">employeeList</span><span class="token operator">:</span> updatedList
            <span class="token punctuation">}</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">return</span> state
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-3-服务端使用typescript"><a href="#_2-3-服务端使用typescript" class="header-anchor">#</a> 2.3 服务端使用Typescript</h3> <blockquote><p>项目地址 https://github.com/poetries/typescript-in-action/tree/master/ts-express</p></blockquote> <h2 id="三、vue项目实践"><a href="#三、vue项目实践" class="header-anchor">#</a> 三、Vue项目实践</h2> <blockquote><p>项目代码 https://github.com/poetries/typescript-in-action/tree/master/ts-vue</p></blockquote> <blockquote><p>TS不能识别<code>.vue</code>文件，需要声明文件</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vue-shims.d.ts</span>

declare module <span class="token string">'*.vue'</span> <span class="token punctuation">{</span>
    <span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
    <span class="token keyword">export</span> <span class="token keyword">default</span> Vue
  <span class="token punctuation">}</span>
  
</code></pre></div><blockquote><p><a href="https://github.com/poetries/poetries.github.io/edit/dev/source/_posts/ts-in-action.md" target="_blank" rel="noopener noreferrer">原文地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h1 id="更多资料"><a href="#更多资料" class="header-anchor">#</a> 更多资料</h1> <ul><li><a href="http://blog.poetries.top/ts-axios/chapter1/" target="_blank" rel="noopener noreferrer">TypeScript 从零实现 axios<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://blog.poetries.top/2018/12/29/ts-intro-and-use-in-react/" target="_blank" rel="noopener noreferrer">Typescript基础及结合React实践(一)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://blog.poetries.top/2018/12/30/ts-summary/" target="_blank" rel="noopener noreferrer">Typescript总结篇（二）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://blog.poetries.top/2018/12/31/ts-react-template/" target="_blank" rel="noopener noreferrer">Typescript+React模板搭建（三）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <!----> <div class="readMore-wrapper"><span class="readMore">阅读全文</span></div>
                    </div>
                            <p>这是一个信息提示框。</p>
                        </div>

                        <div class="note warning">
                            <div class="note-title"><i class="fas fa-exclamation-triangle"></i> 注意</div>
                            <p>这是一个警告提示框。</p>
                        </div>

                        <div class="note success">
                            <div class="note-title"><i class="fas fa-check-circle"></i> 成功</div>
                            <p>这是一个成功提示框。</p>
                        </div>

                        <h2>代码示例</h2>
                        <pre><code class="language-javascript">// 示例代码
function example() {
    console.log('Hello, FrontendHub!');
}
</code></pre>
                    </div>

                    <!-- 文章底部导航 -->
                    <nav class="article-nav">
                        <a href="#" class="prev-article">
                            <i class="fas fa-chevron-left"></i>
                            <span>上一篇</span>
                        </a>
                        <a href="#" class="next-article">
                            <span>下一篇</span>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </nav>
                </article>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4><i class="fas fa-code"></i> FrontendHub</h4>
                    <p>专注于前端技术学习与面试准备</p>
                </div>
                <div class="footer-section">
                    <h4>快速链接</h4>
                    <ul>
                        <li><a href="../../index.html">首页</a></li>
                        <li><a href="../index.html#courses">课程体系</a></li>
                        <li><a href="../index.html#resources">学习资源</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 FrontendHub. 用于个人学习使用.</p>
            </div>
        </div>
    </footer>

    <!-- 返回顶部按钮 -->
    <button class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script src="../../js/main.js"></script>
    <script src="../../js/content.js"></script>
</body>
</html>

