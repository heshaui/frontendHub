<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="referrer" content="no-referrer">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>原生JS补给(上) - FrontendHub</title>
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="../../css/content.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="content-page">
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <a href="../../index.html" style="color: inherit; text-decoration: none; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-code"></i>
                    <span>FrontendHub</span>
                </a>
            </div>
            <button class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-menu" id="navMenu">
                <li><a href="../../index.html">首页</a></li>
                <li><a href="../index.html#features">特色</a></li>
                <li><a href="../index.html#courses">课程</a></li>
                <li><a href="../index.html#resources">资源</a></li>
            </ul>
        </div>
    </nav>

    <!-- 面包屑导航 -->
    <div class="breadcrumb">
        <div class="container">
            <a href="../../index.html"><i class="fas fa-home"></i> 首页</a>
            <i class="fas fa-chevron-right"></i>
            <span>原生JS补给(上)</span>
        </div>
    </div>

    <!-- 主要内容区 -->
    <main class="content-main">
        <div class="container">
            <div class="content-layout">
                <!-- 侧边栏目录 -->
                <aside class="sidebar">
                    <div class="sidebar-sticky">
                        <h3><i class="fas fa-list"></i> 目录</h3>
                        <nav class="toc" id="toc">
                            <!-- 目录将通过JavaScript自动生成 -->
                        </nav>
                    </div>
                </aside>

                <!-- 文章内容 -->
                <article class="article">
                    <header class="article-header">
                        <h1>原生JS补给(上)</h1>
                        <div class="article-meta">
                            <span><i class="far fa-calendar"></i> 更新时间：2025-12-23</span>
                            <span><i class="far fa-clock"></i> 阅读时长：约 15 分钟</span>
                        </div>
                    </header>

                    <div class="article-content">
<div class="content__default"><h2 id="第一补-js类型基础"><a href="#第一补-js类型基础" class="header-anchor">#</a> 第一补： JS类型基础</h2> <h3 id="_1-1-tostring-为什么可以调用-1-tostring-却不行"><a href="#_1-1-tostring-为什么可以调用-1-tostring-却不行" class="header-anchor">#</a> 1. '1'.toString()为什么可以调用，1.toString()却不行？</h3> <p>我们知道如果在代码中使用：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">'1'</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 或者是</span>
<span class="token boolean">true</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>都是可以正常调用的，这是因为<code>toString</code>它是<code>Object.prototype</code>上的方法，任何能访问到<code>Object</code>原型的元素都可以调用它。</p> <p>而在此处，对于<code>'1'.toString()</code>相当于是做了一层转换，将其转为了一个<code>"对象"</code>，这样就可以调用<code>toString()</code>方法了。</p> <p>也就是这样：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
s<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
s <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>创建<code>Object</code>实例，将<code>s</code>变为了<code>String{"1"}</code>对象</li> <li>调用<code>Object.prototype</code>上的实例方法<code>toString()</code></li> <li>用完之后立即销毁这个实例</li></ul> <p>这一部分三元分析的已经挺多了，我主要是想补充一下<code>1.toString()</code>为什么就不行。</p> <p>当我们在代码中试图使用<code>1.toString()</code>，发现编辑器已经报错不允许我们这样做了。</p> <p>最开始会有这么奇怪的想法是因为我们都忽视了一件事，那就是<code>.</code>它也是属于数字里的一部分啊 😂。</p> <p>比如<code>1.2</code>、<code>1.3</code>。所以当你想要使用<code>1.toString()</code>的时候，<code>JavaScript</code>的解释器会把它作为数字的一部分，这样就相当于<code>(1.)toString</code>了，很显然这是一段错误的代码。</p> <p>既然这样的话，如果我还给代码一个<code>.</code>是不是就可以了，于是我尝试了一下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1.1</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>发现它竟然能正常打印出来：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">"1.1"</span>
</code></pre></div><p>这也就再次证明了<code>1.toString()</code>会将<code>.</code>归给<code>1</code>所属，而不是归给<code>toString()</code>。</p> <p>当然如果你用的一个变量来承载这个数字的话也是可以的：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "1"</span>

<span class="token comment">// 或者</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "1"</span>
</code></pre></div><h3 id="_2-为什么可以使用new-number却不能使用new-symbol"><a href="#_2-为什么可以使用new-number却不能使用new-symbol" class="header-anchor">#</a> 2. 为什么可以使用new Number却不能使用new Symbol?</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// Number{1}</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span> <span class="token comment">// String{'1'}</span>
<span class="token keyword">var</span> bol <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Boolean</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// Boolean{true}</span>

<span class="token keyword">var</span> symbol <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Symbol</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// TypeError</span>
</code></pre></div><p>像上面这种使用<code>new Number、new String</code>等创建的基本数据类型被称之为：<strong>围绕原始数据类型创建一个显式包装器对象</strong>。</p> <p>通俗点说就是：用<code>new</code>来创建基本类型的包装类。</p> <p>而这种做法在<code>ES6</code>之后就不被支持了，从<code>new Symbol(1)</code>报错就可以看出来，现在使用的是不带<code>new</code>的方式：<code>var symbol = Symbol(1)</code>，所以它作为构造函数来说是不完整的。</p> <p>但是因为历史遗留的原因，<code>new Number</code>仍然可以这样用，不过并不推荐。</p> <p>如果你真的想创建一个 Symbol 包装器对象 (<code>Symbol wrapper object</code>)，你可以使用 <code>Object()</code> 函数：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> sym<span class="token punctuation">)</span> <span class="token comment">// "symbol"</span>
<span class="token keyword">var</span> symObj <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span>sym<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> symObj<span class="token punctuation">)</span> <span class="token comment">// "object"</span>
</code></pre></div><h2 id="第二补-js类型检测"><a href="#第二补-js类型检测" class="header-anchor">#</a> 第二补：JS类型检测</h2> <h3 id="_1-instanceof能否判断基本数据类型"><a href="#_1-instanceof能否判断基本数据类型" class="header-anchor">#</a> 1. instanceof能否判断基本数据类型？</h3> <p>什么意思呢 🤔️？</p> <p>正常来说，<code>instanceof</code>是用来判断某个对象的原型链上是否能够查找到某个构造函数的原型对象。</p> <p>来看看通俗点的简介：</p> <p><code>a instanceof B</code></p> <p><code>实例对象a instanceof 构造函数B</code></p> <p>检测<code>a</code>的原型链<code>(__proto__)</code>上是否有<code>B.prototype</code>，有则返回<code>true</code>，否则返回<code>false</code>。</p> <p>那么它可以用来判断基本数据类型吗？</p> <p>也就是说我定义了一个<code>var num = 1</code>，我可以用<code>instanceof</code>来判断它是一个<code>number</code>类型的变量吗？</p> <p>如果你试图这样写：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num <span class="token keyword">instanceof</span> <span class="token class-name">Number</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre></div><p>发现结果是<code>false</code>。</p> <p>此时你可以用<code>Symbol.hasInstance</code>来实现一个自定义<code>instanceof</code>的行为。</p> <p>首先想想我们是要实现一个什么功能？</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>a <span class="token keyword">instanceof</span> <span class="token class-name">B</span>
</code></pre></div><p>左侧的<code>a</code>是一个变量，而右侧的<code>B</code>是一个构造函数，而<code>class</code>的本质也是一个构造函数。</p> <p>所以在这个需求中，我们可以定义一个叫做<code>MyNumber</code>的类，在其里面封装一层，暴露一个静态方法用来判断数据类型：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyNumber</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">instance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">typeof</span> instance <span class="token operator">===</span> <span class="token string">'number'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num <span class="token keyword">instanceof</span> <span class="token class-name">MyNumber</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><ul><li>在类<code>MyNumber</code>中定义了一个名为<code>Symbol.hasInstance</code>的静态方法</li> <li>这个方法接收的是一个实例对象<code>instance</code></li> <li>返回值为<code>typeof</code>判断是否是<code>number</code>类型</li></ul> <p>这里比较难理解的就是<code>Symbol.hasInstance</code>了，第一次接触它也不知道它是个啥 😂。找了一波<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol/hasInstance" target="_blank" rel="noopener noreferrer">MDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 上对它的介绍：</p> <p><code>用于判断某对象是否为某构造器的实例。</code></p> <p>然后试着写了几个案例，发现也不用把它想的那么复杂，你就简单理解，当我们在使用<code>instanceof</code>的时候，能够自定义右侧构造函数(类)它的<code>instanceof</code>验证方式就可以了。</p> <p>就像是上面👆那个案例一样，我在<code>MyNumber</code>重写了静态方法<code>Symbol.hasInstance</code>，让它的验证方式变成<code>type instance === 'number'</code>。</p> <p>那么为什么是静态方法呢(也就是在方法前面加上<code>static</code>)，通过阅读<a href="https://juejin.im/post/5e707417e51d45272054d5d3" target="_blank" rel="noopener noreferrer">《🔥【何不三连】比继承家业还要简单的JS继承题-封装篇(牛刀小试)》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>我们知道，静态方法是挂载在<code>MyNumber</code>这个类上的方法，因此我们甚至可以把下面的内容换一种写法：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num <span class="token keyword">instanceof</span> <span class="token class-name">MyNumber</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token comment">// 换成：</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>MyNumber<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p>看到了吧，它其实就是一个方法名而已，而这个方法因为是静态的，在<code>MyNumber</code>上的，因此我们可以用<code>MyNumber[Symbol.hasInstance]</code>这种方式调用。</p> <p>想想，如果没有<code>static</code>这个关键字呢？</p> <p>没有<code>static</code>的话，定义在类里的方法就相当于是挂载到类的原型对象上，那么如果我们想要使用它，一种就是直接用<code>MyNumber.prototype</code>调用，还有一种就是使用<code>new MyNumber()</code>生成一个实例来调用：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyNumber</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">instance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 没有 static</span>
        <span class="token keyword">return</span> <span class="token keyword">typeof</span> instance <span class="token operator">===</span> <span class="token string">'number'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">1</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num <span class="token keyword">instanceof</span> <span class="token class-name">new</span> <span class="token function">MyNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num <span class="token keyword">instanceof</span> <span class="token class-name">MyNumber<span class="token punctuation">.</span>prototype</span><span class="token punctuation">)</span> <span class="token comment">// true</span>

<span class="token comment">// 转化为：</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">MyNumber</span><span class="token punctuation">.</span>prototype<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MyNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p>所以现在回过头来看看：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyNumber</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">instance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">typeof</span> instance <span class="token operator">===</span> <span class="token string">'number'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num <span class="token keyword">instanceof</span> <span class="token class-name">MyNumber</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p>是不是就好理解多了呢？</p> <p>那么假如我现在想要你实现一个用<code>instanceof</code>判断是不是数组的类<code>MyArray</code>，该如何去写呢？</p> <p>思考🤔...</p> <p>唔...上答案：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">MyArray</span> <span class="token punctuation">{</span>  
  <span class="token keyword">static</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">instance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">MyArray</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h3 id="_2-instanceof的查找路线"><a href="#_2-instanceof的查找路线" class="header-anchor">#</a> 2. instanceof的查找路线？</h3> <p>上面我们说到了<code>instanceof</code>是用来判断某个对象的原型链上是否能够查找到某个构造函数的原型对象。</p> <p>并且是会沿着原型链一层一层的向上查找，直到到达原型链的末位。</p> <p>那这个过程具体是怎样的呢？让我们来看一个例子🌰：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Parent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'parent'</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'boy'</span>
<span class="token punctuation">}</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1 <span class="token keyword">instanceof</span> <span class="token class-name">Child</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1 <span class="token keyword">instanceof</span> <span class="token class-name">Parent</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1 <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span>
</code></pre></div><p>结果为：</p> <div class="language- extra-class"><pre class="language-text"><code>true
true
true
</code></pre></div><p>这里其实用到了原型链继承，<code>Chind</code>继承于<code>Parent</code>，而且三个构造函数的原型对象都存在于<code>child1</code>的原型链上。</p> <p>也就是说，左边的<code>child1</code>它会向它的原型链中不停的查找，看有没有右边那个构造函数的原型对象。</p> <p>例如<code>child1 instanceof Child</code>的查找顺序：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>child1 <span class="token operator">-</span><span class="token operator">&gt;</span> child1<span class="token punctuation">.</span>__proto__ <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token class-name">Child</span><span class="token punctuation">.</span>prototype
</code></pre></div><p><code>child1 instanceof Parent</code>的查找顺序：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>child1 <span class="token operator">-</span><span class="token operator">&gt;</span> child1<span class="token punctuation">.</span>__proto__ <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token class-name">Child</span><span class="token punctuation">.</span>prototype
<span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__ <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype
</code></pre></div><p>还不理解？</p> <p>没关系，我还有大招：</p> <p>我在上面👆原型链继承的思维导图上加了三个查找路线。</p> <p>被⭕️标记的<code>1、2、3</code>分别代表的是<code>Child、Parent、Object</code>的原型对象。</p> <p><img src="https://s.poetries.top/gitee/2020/09/13.png" alt=""></p> <p>好滴，一张图简洁明了。以后再碰到<code>instanceof</code>这种东西，按照我图上的查找路线来查找就可以了 😁 ～</p> <h3 id="_3-ispropertypeof-有什么作用"><a href="#_3-ispropertypeof-有什么作用" class="header-anchor">#</a> 3. isPropertypeOf()有什么作用？</h3> <p>既然说到了<code>instanceof</code>，那么就不得不提一下<code>isPrototypeOf</code>这个方法了。</p> <p>它属于<code>Object.prototype</code>上的方法，这点你可以将<code>Object.prototype</code>打印在控制台中看看。</p> <p><code>isPrototypeOf()</code>的用法和<code>instanceof</code>相反。</p> <p>它是用来判断指定对象<code>object1</code>是否存在于另一个对象<code>object2</code>的原型链中，是则返回<code>true</code>，否则返回<code>false</code>。</p> <p>例如还是上面👆这道题，我们将要打印的内容改一下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Parent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'parent'</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">'boy'</span>
<span class="token punctuation">}</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span>child1<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span>child1<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span>child1<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>这里输出的依然是三个<code>true</code>：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token boolean">true</span>
<span class="token boolean">true</span>
<span class="token boolean">true</span>
</code></pre></div><p>判断的方式只要把<strong>原型链继承instanceof查找思维导图</strong>这张图反过来查找即可。</p> <p>更多关于<code>instanceOf</code>的内容可以戳这里👇：</p> <p><a href="https://juejin.im/post/5e75e22951882549027687f9#heading-9" target="_blank" rel="noopener noreferrer">💦【何不三连】做完这48道题彻底弄懂JS继承(1.7w字含辛整理-返璞归真)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_4-object-is-和-的区别"><a href="#_4-object-is-和-的区别" class="header-anchor">#</a> 4. Object.is()和===的区别？</h3> <ul><li>对于<code>+0</code>和<code>-0</code>的判断不同</li> <li>对于<code>NaN</code>和<code>NaN</code>的判断不同</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">0</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">NaN</span> <span class="token operator">===</span> <span class="token number">NaN</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">,</span> <span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p>其实不需要特意的去记，你只需要理解，<code>Object.is()</code>在<code>===</code>的基础上修复了这些特殊情况的失误。</p> <p>也就是说：<code>+0</code>和<code>-0</code>本就该不相等的，这点从<code>1 / +0</code>为<code>Infinity</code>，<code>1 / -0</code>为<code>-Infinity</code>上可以看出。</p> <p>(但是<code>+0</code>和<code>0</code>是没有区别的)</p> <p>而<code>NaN</code>表示的都是非数字，所以应该是相等的。</p> <p>因此<code>Object.is()</code>的内部其实是做了一些修复的处理：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">is</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">===</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token number">1</span> <span class="token operator">/</span> x <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">/</span> y<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">!==</span> x <span class="token operator">&amp;&amp;</span> y <span class="token operator">!==</span> y<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这里可以怎样理解呢 🤔️？</p> <ul><li>当<code>x === y</code>的时候，就是用来处理<code>+0, -0, 0</code>的特殊情况。</li></ul> <p>在这个判断中，首先会判断出<code>x和y</code>是不是都是<code>+0, -0, 0</code>中的其中一个(因为我们知道不论是这三个中的哪一个和<code>0</code>进行全等比较，结果都会是<code>true</code>，所以<code>x !== 0</code>就会是<code>false</code>)，而根据<code>||</code>的短路原则，前面一项为<code>false</code>，那么最终的结果取决于后面一项。</p> <p>所以<code>x !== 0</code>相当于是把<code>x, y</code>为<code>+0, -0, 0</code>的情况推给了<code>1 / x === 1 / y</code>，用它的结果来决定最后的结果。</p> <p>(在三元的原文中这段判断是这样写的<code>return x !== 0 || y !== 0 || 1 /x === 1 / y</code>，比我这里多了一个<code>|| y !== 0</code>。经评论区小伙伴<a href="https://juejin.im/user/5c7747976fb9a049ac79d82c" target="_blank" rel="noopener noreferrer">matteokjh<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>提示，觉得可以把<code>|| y !== 0</code>的判断省略掉，另外<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/is" target="_blank" rel="noopener noreferrer">MDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>上对它的<code>polyfill</code>也是没有这一步的，我想了一下：因为能进入到<code>x === y</code>里，那么如果<code>x !== 0</code> 成立的话，那么<code>y !== 0</code>肯定也成立了，貌似是可以省去。另外我把省去的代码执行了一下，和没有省去时的执行结果一样的，所以我感觉可行。)</p> <p>而且我们又知道<code>1 / +0</code>为<code>Infinity</code>，<code>1 / -0</code>为<code>-Infinity</code>，所以如果<code>x, y</code>为<code>+0或者-0</code>的时候是不相等的，以此来实现<code>Object.is(+0, -0)的结果为false</code>。</p> <ul><li>当<code>x !== y</code>的时候，就是用来处理<code>NaN, NaN</code>的特殊情况。</li></ul> <p>因为我们知道<code>NaN !== NaN</code>的，那么如果<code>x</code>和<code>y</code>都不和它们自己相等的话，说明两个都是<code>NaN</code>了，而如果都是<code>NaN</code>的话，<code>Object.is(NaN, NaN)</code>的结果为<code>true</code>。</p> <h2 id="第三补-tostring-方法的妙用"><a href="#第三补-tostring-方法的妙用" class="header-anchor">#</a> 第三补：toString()方法的妙用</h2> <h3 id="_1-tostring-存在于哪里"><a href="#_1-tostring-存在于哪里" class="header-anchor">#</a> 1. toString()存在于哪里？</h3> <p>在此之前，我翻了很多关于<code>toString()</code>的资料，大多都是介绍了它的用法，但是它真正存在于哪里呢？</p> <p>可能比较常见的一种说法是它存在于<code>Object</code>的原型对象中，也就是<code>Object.prototype</code>上，那么对于基本数据类型，<code>Number、String、Boolean、 Symbol、BigInt</code>呢？它们自身有这个方法吗？或者它们的原型对象上有吗？</p> <p>本着一探到底的精神，我打印出了<code>Number</code>和<code>Number.prototype</code>：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Number<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Number</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
</code></pre></div><p><img src="https://s.poetries.top/gitee/2020/09/14.png" alt=""></p> <p>然后我发现了几件事：</p> <ul><li><code>Number</code>只是一个构造函数，打印出来显示的会是源代码</li> <li><code>Number.prototype</code>上确实也有<code>toString()</code></li> <li><code>Number.prototype.__proto__</code>也就是<code>Object.prototype</code>上也有<code>toString()</code></li></ul> <p>然后我又试了一下<code>String、Boolean、Symbol</code>发现结果也和上面一样。</p> <p>其实不难理解，看过<a href="https://juejin.im/post/5e75e22951882549027687f9" target="_blank" rel="noopener noreferrer">《💦【何不三连】做完这48道题彻底弄懂JS继承(1.7w字含辛整理-返璞归真)》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的小伙伴都知道，所有对象的原型链到最后都会指向<code>Object.prototype</code>，算是都"继承"了<code>Object</code>的对象实例，因此都能使用<code>toString()</code>方法，但是对于不同的内置对象为了能实现更适合自身的功能需求，都会重写该方法，所以你可以看到<code>Number.prototype</code>上也会有该方法。</p> <p><strong>所以我们可以先得出第一个结论：</strong></p> <ul><li>除了<code>null、undefined</code>以外的其它数据类型(基本数据类型+引用数据类型)，它们构造函数的原型对象上都有<code>toString()</code>方法</li> <li>基本数据类型构造函数原型对象上的<code>toString()</code>会覆盖<code>Object</code>原型对象上的<code>toString()</code>方法</li></ul> <p>（当然，等你看到后面你就会发现这种说法其实并不太准确，但是大多数时候我们都只是关心谁可以用它，而不是它存在于哪里）</p> <h3 id="_2-谁可以调用tostring"><a href="#_2-谁可以调用tostring" class="header-anchor">#</a> 2. 谁可以调用toString()？</h3> <p>这个问题，其实在上面👆已经给出答案了，所有对象除了<code>null、undefined</code>以外的任何值都可以调用<code>toString()</code>方法，通常情况下它的返回结果和<code>String</code>一样。</p> <p>其实这里，我们最容易搞混的就是<code>String</code>和<code>toString</code>。</p> <p>之前总是为了将某个类型转为字符串胡乱的用这两个属性。</p> <ul><li><code>String</code>是一个类似于<code>Function</code>这样的对象，它既可以当成对象来用，用它上面的静态方法，也可以当成一个构造函数来用，创建一个<code>String</code>对象</li> <li>而<code>toString</code>它是除了<code>null、undefined</code>之外的数据类型都有的方法，通常情况下它的返回结果和<code>String</code>一样。</li></ul> <h3 id="_3-如何用tostring-判断某个数据的具体类型"><a href="#_3-如何用tostring-判断某个数据的具体类型" class="header-anchor">#</a> 3. 如何用toString()判断某个数据的具体类型？</h3> <p>可能大家看的比较多的一种用法是这样的：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'obj'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// '[object Object]'</span>
</code></pre></div><p>先来点硬知识，<code>Object.prototype.toString</code>这个方法会根据这个对象的<code>[[class]]</code>内部属性，返回由 <code>"[object " 和 class 和 "]"</code> 三个部分组成的字符串。</p> <p>啥意思？<code>[[class]]</code>内部属性是个啥 🤔️？</p> <p>这里你还真别想多，你就按字面意思来理解它就好了，想想，<code>class</code> 英文单词的意思-&gt;<code>类</code>。</p> <p>那好，我就认为它代表的是一类事物就行了。</p> <p>就比如</p> <ul><li>数组是一类，它的<code>[[class]]</code>是<code>Array</code></li> <li>字符串是一类，它的<code>[[class]]</code>是<code>String</code></li> <li><code>arguments</code>是一类，它的<code>[[class]]</code>是<code>Arguments</code></li></ul> <p>另外，关于<code>[[class]]</code>的种类是非常多的，你也不需要记住全部，只需要知道一些常用的，基本的，好理解的就可以了。</p> <p>所以回到<code>Object.prototype.toString.call()</code>这种调用方式来，现在你可以理解它的作用了吧，<strong>它能够帮助我们准确的判断某个数据类型</strong>，也就是辨别出是数组还是数字还是函数，还是<code>NaN</code>。😊</p> <p>另外鉴于它的返回结果是<code>"[object Object]"</code>这样的字符串，而且前面的<code>"[object ]"</code>这八个字符串都是固定的(包括<code>"t"</code>后面的空格)，所以我们是不是可以封装一个方法来只拿到<code>"Object"</code>这样的字符串呢？</p> <p>很简单，上代码：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getClass</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> typeString <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "[object Object]"</span>
    <span class="token keyword">return</span> typeString<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可以看到，我给这个函数命名为<code>getClass</code>，这也就呼应了它原本的作用，是为了拿到对象的<code>[[class]]</code>内部属性。</p> <p>另外，在拿到了<code>"[object Object]"</code>字符串之后，是用了一个<code>.slice(8, -1)</code>的字符串截取功能，去除了前八个字符<code>"[object ]"</code>和最后一个<code>"]"</code>。</p> <p>现在让我们来看看一些常见的数据类型吧：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> typeString <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "[object Array]"</span>
    <span class="token keyword">return</span> typeString<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Date</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Map</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Set</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// String</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Number</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Boolean</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Number</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Null</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Symbol</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Array</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Function</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// HTMLCollection</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Arguments</span>
</code></pre></div><h3 id="_4-tostring-call-与typeof的区别"><a href="#_4-tostring-call-与typeof的区别" class="header-anchor">#</a> 4. toString.call()与typeof的区别？</h3> <p>好滴👌，通过刚刚的学习，我们了解到了，<code>toString.call</code>这种方式是为了获取某个变量更加具体的数据类型。</p> <p>咦～说到数据类型，我们原来不是有一个<code>typeof</code>吗？它和<code>toString.call()</code>又有啥区别？</p> <p>首先帮大家回顾一下<code>typeof</code>它的显示规则：</p> <ul><li>对于原始类型来说(也就是<code>number、string</code>这种)，除了<code>null</code>都可以显示正确的类型</li> <li><code>null</code>因为历史版本的原因被错误的判断为了<code>"object"</code></li> <li>对于引用类型来说(也就是<code>object、array</code>这种)，除了函数都会显示为<code>"object"</code></li> <li>函数会被显示为<code>function</code></li></ul> <p>所以呀，<code>typeof</code>的缺点很明显啊，我现在有一个对象和一个数组，或者一个日期对象，我想要仔细的区分它，用<code>typeof</code>肯定是不能实现的，因为它们得到的都是<code>"object"</code>。</p> <p>所以，采用我们封装的<code>getClass()</code>显然是一个很好的选择。</p> <h3 id="_5-不同类型的数据调用tostring-会怎么样"><a href="#_5-不同类型的数据调用tostring-会怎么样" class="header-anchor">#</a> 5. 不同类型的数据调用toString()会怎么样？</h3> <p>在不同的数据类型调用<code>toString()</code>会有什么不同呢？</p> <p>这里我主要是分为两大块来说：</p> <ul><li>基本数据类型调用</li> <li>引用类型调用</li></ul> <h4 id="_5-1-基本数据类型调用tostring"><a href="#_5-1-基本数据类型调用tostring" class="header-anchor">#</a> 5.1 基本数据类型调用toString</h4> <p>对于基本数据类型来调用它，超级简单的，你就想着就是把它的原始值换成了字符串而已：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// '1'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1.1</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// '1.1'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'true'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 'Symbol(1)'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">10n</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// '10'</span>
</code></pre></div><p>所以对于基本数据类型：</p> <ul><li>原始数据类型调用时，把它的原始值换成了字符串</li></ul> <h4 id="_5-2-引用类型调用tostring"><a href="#_5-2-引用类型调用tostring" class="header-anchor">#</a> 5.2 引用类型调用toString</h4> <p>比较难的部分是引用类型调用<code>toString()</code>，而且我们知道引用类型根据<code>[[class]]</code>的不同是分了很多类的，比如有<code>Object</code>、<code>Array</code>、<code>Date</code>等等。</p> <p>那么不同类之间的<code>toString()</code>是否也不同呢 🤔️？</p> <p>没错，不同版本的<code>toString</code>主要是分为：</p> <ul><li>数组的<code>toString</code>方法是将每一项转换为字符串然后再用<code>","</code>连接</li> <li>普通的对象(比如<code>{name: 'obj'}</code>这种)转为字符串都会变为<code>"[object Object]"</code></li> <li><code>函数(class)、正则</code>会被转为源代码字符串</li> <li><code>日期</code>会被转为本地时区的日期字符串</li> <li>原始值的包装对象调用<code>toString</code>会返回原始值的字符串</li> <li>拥有<code>Symbol.toStringTag</code>内置属性的对象在调用时会变为对应的标签<code>"[object Map]"</code></li></ul> <p>(<code>Symbol.toStringTag</code>属性下一题会问到)</p> <p>例如🌰：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// ""</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "1,2"</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "[object Object]"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'obj'</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "[object Object]"</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "class A {}"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "function () {}"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(\[|\])</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "/(\[|\])/g1"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "Fri Mar 27 2020 12:33:16 GMT+0800 (中国标准时间)"</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "true"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "1"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "10"</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "[object Map]"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "[object Set]"</span>
</code></pre></div><h3 id="_6-了解symbol-tostringtag吗"><a href="#_6-了解symbol-tostringtag吗" class="header-anchor">#</a> 6. 了解Symbol.toStringTag吗？</h3> <p><a href="https://cloud.tencent.com/developer/section/1192219" target="_blank" rel="noopener noreferrer">《Symbol.toStringTag》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>上是这样描述它的：</p> <p>该<code>Symbol.toStringTag</code>公知的符号是在创建对象的默认字符串描述中使用的字符串值属性。它由该<code>Object.prototype.toString()</code>方法在内部访问。</p> <p>看不懂没关系，你这样理解就可以了，它其实就是决定了刚刚我们提到所有数据类型中<code>[[class]]</code>这个内部属性是什么。</p> <p>比如数字，我们前面得到的<code>[[class]]</code>是<code>Number</code>，那我就可以理解为数字这个类它的<code>Symbol.toStringTag</code>返回的就是<code>Number</code>。</p> <p>只不过在之前我们用到的<code>Number、String、Boolean</code>中并没有<code>Symbol.toStringTag</code>这个内置属性，它是在我们使用<code>toString.call()</code>调用的时候才将其辨别返回。</p> <p>而刚刚我们刚刚在第五问看到的<code>new Map()</code>，让我们把它打印出来看看。</p> <div class="language- extra-class"><pre class="language-text"><code>console.log(new Map())
</code></pre></div><p><img src="https://s.poetries.top/gitee/2020/09/15.png" alt=""></p> <p>可以看到<code>Symbol.toStringTag</code>它是确确实实存在于<code>Map.prototype</code>上的，也就是说它是<code>Map、Set</code>内置的一个属性，因此当我们直接调用<code>toString()</code>的时候，就会返回<code>"[object Map]"</code>了。</p> <p>额，我们是不是就可以这样理解呢？</p> <ul><li>没有<code>Symbol.toStringTag</code>内置属性的类型在调用<code>toString()</code>的时候相当于是<code>String(obj)</code>这样调用转换为相应的字符串</li> <li>有<code>Symbol.toStringTag</code>内置属性的类型在调用<code>toString()</code>的时候会返回相应的标签(也就是<code>"[object Map]"</code>这样的字符串)</li></ul> <p>我们常用的带有<code>Symbol.toStringTag</code>内置属性的对象有：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "[object Map]"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "[object Set]"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "[object Promise]"</span>
</code></pre></div><p>而它最主要的功能就是和<code>Symbol.hasInstance</code>一样，可以允许我们自定义标签。</p> <p>(<code>Symbol.hasInsance</code>的作用是自定义<code>instanceof</code>的返回值)</p> <p>什么是自定义标签呢 🤔️？</p> <p>也就是说，假如我们现在创建了一个类，并且用<code>toString.call()</code>调用它的实例对象是会有如下结果：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Super</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "[object Object]"</span>
</code></pre></div><p>很好理解，因为产生的<code>new Super()</code>是一个对象嘛，所以打印出的会是<code>"[object Object]"</code>。</p> <p>但是现在有了<code>Symbol.toStringTag</code>之后，我们可以改后面的<code>"Object"</code>。</p> <p>比如我重写一下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Super</span> <span class="token punctuation">{</span>
  <span class="token keyword">get</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'Validator'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "[object Validator]"</span>
</code></pre></div><p>这就是<code>Symbol.toStringTag</code>的厉害之处，它能够允许我们自定义标签。</p> <p>但是有一点要注意了，<code>Symbol.toStringTag</code>重写的是<code>new Super()</code>这个实例对象的标签，而不是重写<code>Super</code>这个类的标签，也就是说这里有区别的：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Super</span> <span class="token punctuation">{</span>
  <span class="token keyword">get</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'Validator'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>Super<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "[object Function]"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "[object Validator]"</span>
</code></pre></div><p>因为<code>Super</code>它本身还是一个函数，只有<code>Super</code>产生的实例对象才会用到我们的自定义标签。</p> <p>总结一下<code>Symbol.toStringTag</code>：</p> <ul><li>它是某些特定类型的内置属性，比如<code>Map、Set、Promise</code></li> <li>主要作用是可以允许我们自定义标签，修改<code>Object.prototype.toString.call()</code>的返回结果</li></ul> <p>更多关于<code>toString</code>和<code>Symbol.toStringTag</code>的内容可以戳这里👇：</p> <p><a href="https://juejin.im/post/5e7f8314e51d4546fa4511c9#heading-24" target="_blank" rel="noopener noreferrer">【精】从206个console.log()完全弄懂数据类型转换的前世今生(上)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="第四补-js类型转换"><a href="#第四补-js类型转换" class="header-anchor">#</a> 第四补：JS类型转换</h2> <p>因为类型转换算是让人比较头疼的一部分，所以对于这一块我也专门写了系列文章，基本上覆盖了面试可能会问到的知识点，传送门：</p> <p><a href="https://juejin.im/post/5e7f8314e51d4546fa4511c9" target="_blank" rel="noopener noreferrer">【精】从206个console.log()完全弄懂数据类型转换的前世今生(上)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://juejin.im/post/5e86e73e518825739e0704b4" target="_blank" rel="noopener noreferrer">【精】从206个console.log()完全弄懂数据类型转换的前世今生(下)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>(下篇写的挺好的没人看难受😣)</p> <h3 id="_1-说一下valueof-的基本用法"><a href="#_1-说一下valueof-的基本用法" class="header-anchor">#</a> 1. 说一下valueOf()的基本用法</h3> <ul><li>基本数据类型调用，返回调用者原本的值</li> <li>非日期对象的其它引用类型调用<code>valueOf()</code>默认是返回它本身</li> <li>而日期对象会返回一个<code>1970 年 1 月 1 日以来的毫秒数</code>(类似于<code>1585370128307</code>)。</li></ul> <p>例子🌰：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// '1'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1.1</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 1.1</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// []</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// {}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// ['1']</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// ƒ () {}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(\[|\])</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// /(\[|\])/g</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 1585370128307</span>
</code></pre></div><h3 id="_2-toprimitive的具体转换流程"><a href="#_2-toprimitive的具体转换流程" class="header-anchor">#</a> 2. ToPrimitive的具体转换流程？</h3> <p>当我们在将<strong>对象转换为原始类型</strong>或者<strong>进行==比较</strong>的时候，会调用内置的<code>ToPrimitive</code>函数。</p> <p>比如：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 对象转字符串，结果为 "[object Object]"</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 对象转数字，结果为 NaN</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p>以上结果的由来都经过了<code>ToPrimitive</code>函数。</p> <p>先让我们来看看它的函数语法：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">ToPrimitive</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> PreferredType<span class="token operator">?</span><span class="token punctuation">)</span>
</code></pre></div><p>参数：</p> <ul><li>参数一：<code>input</code>，表示要处理的输入值</li> <li>参数二：<code>PerferredType</code>，期望转换的类型，可以看到语法后面有个问号，表示是非必填的。它只有两个可选值，<code>Number</code>和<code>String</code>。</li></ul> <p>而它对于传入参数的处理是比较复杂的，让我们来看看流程图：</p> <p><img src="https://s.poetries.top/gitee/2020/09/16.png" alt=""></p> <p>根据流程图，我们得出了这么几个信息：</p> <ol><li>当不传入 PreferredType 时，如果 input 是日期类型，相当于传入 String，否则，都相当于传入 Number。</li> <li>如果是 ToPrimitive(obj, Number)，处理步骤如下：</li></ol> <ul><li>如果 obj 为 基本类型，直接返回</li> <li>否则，调用 valueOf 方法，如果返回一个原始值，则 JavaScript 将其返回。</li> <li>否则，调用 toString 方法，如果返回一个原始值，则 JavaScript 将其返回。</li> <li>否则，JavaScript 抛出一个类型错误异常。</li></ul> <ol start="3"><li>如果是 ToPrimitive(obj, String)，处理步骤如下：</li></ol> <ul><li>如果 obj为 基本类型，直接返回</li> <li>否则，调用 toString 方法，如果返回一个原始值，则 JavaScript 将其返回。</li> <li>否则，调用 valueOf 方法，如果返回一个原始值，则 JavaScript 将其返回。</li> <li>否则，JavaScript 抛出一个类型错误异常。</li></ul> <p>上面👆的图其实只是看着很复杂，细心的小伙伴可能会发现，在图里红框裱起来的地方，只有<code>toString()</code>和<code>valueOf()</code>方法的执行顺序不同而已。</p> <p>如果 PreferredType 是 String 的话，就先执行 <code>toString()</code>方法</p> <p>如果 PreferredType 是 Number 的话，就先执行 <code>valueOf()</code>方法</p> <h4 id="_2-1-对象转字符串"><a href="#_2-1-对象转字符串" class="header-anchor">#</a> 2.1 对象转字符串</h4> <p>来点例子巩固一下：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "[object Object]"</span>
</code></pre></div><p>对于这个简单的转换我们可以把它换成<code>toPrimitive</code>的伪代码看看：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">toPrimitive</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'string'</span><span class="token punctuation">)</span>
</code></pre></div><p>OK👌，来回顾一下刚刚的转换规则：</p> <ol><li><code>input</code>是<code>{}</code>，是一个引用类型，<code>PerferredType</code>为<code>string</code></li> <li>所以调用<code>toString()</code>方法，也就是<code>{}.toString()</code></li> <li><code>{}.toString()</code>的结果为<code>"[object Object]"</code>，是一个字符串，为基本数据类型，然后返回，到此结束。</li></ol> <p>哇～</p> <p>是不是一切都说得通了，好像不难吧 😁。</p> <p>没错，当使用<code>String()</code>方法的时候，<code>JS</code>引擎内部的执行顺序确实是这样的，不过有一点和刚刚提到的步骤不一样，那就是最后返回结果的时候，其实会将最后的基本数据类型再转换为字符串返回。</p> <p>也就是说上面👆的第三步我们得拆成两步来：</p> <ol start="3"><li><code>{}.toString()</code>的结果为<code>"[object Object]"</code>，是一个字符串，为基本数据类型</li> <li>将这个<code>"[object Object]"</code>字符串再做一次字符串的转换然后返回。(因为<code>"[object Object]"</code>已经是字符串了，所以原样返回，这里看不出有什么区别)</li></ol> <p>将最后的结果再转换为字符串返回这一步，其实很好理解啊。你想想，我调用<code>String</code>方法那就是为了得到一个字符串啊，你要是给我返回一个<code>number、null</code>啊什么的，那不是隔壁老王干的事嘛～</p> <h4 id="_2-2-对象转数字"><a href="#_2-2-对象转数字" class="header-anchor">#</a> 2.2 对象转数字</h4> <p>刚刚我们说了对象转字符串也就是<code>toPrimitive(object, 'string')</code>的情况，</p> <p>那么对象转数字就是<code>toPrimitive(object, 'number')</code>。</p> <p>区别就是转数字会先调用<code>valueOf()</code>后调用<code>toString()</code>。</p> <p>例子🌰：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>对于<code>Number({})</code>：</p> <ul><li>传入的是一个对象<code>{}</code>，因此调用<code>valueOf()</code>方法，该方法在题<code>7.1</code>中已经提到过了，它除了日期对象的其它引用类型调用都是返回它本身，所以这里还是返回了对象<code>{}</code></li> <li><code>valueOf()</code>返回的值还是对象，所以继续调用<code>toString()</code>方法，而<code>{}</code>调用<code>toString()</code>的结果为字符串<code>"[object Object]"</code>，是一个基本数据类型</li> <li>得到基础数据类型了，该要返回了，不过在这之前还得将它在转换为数字才返回，那么<code>"[object Object]"</code>转为数字为<code>NaN</code>，所以结果为<code>NaN</code></li></ul> <p>对于<code>Number([])</code>：</p> <ul><li>传入的是一个数组<code>[]</code>，因此调用<code>valueOf()</code>方法，返回它自身<code>[]</code></li> <li><code>[]</code>继续调用<code>toString()</code>方法，而空数组转为字符串是为<code>""</code></li> <li>最后再将空字符串<code>""</code>转为数字<code>0</code>返回</li></ul> <p>对于<code>Number([0])</code>：</p> <ul><li>因为<code>[0]</code>转为字符串是为<code>"0"</code>，最后在转为数字<code>0</code> 返回</li></ul> <p>对于<code>Number([1, 2])</code>：</p> <ul><li>传入的是一个数组<code>[1, 2]</code>，所以调用<code>valueOf()</code>方法返回的是数组本身<code>[1,2]</code></li> <li>所以继续调用<code>toString()</code>方法，此时被转换为了<code>"1,2"</code>字符串</li> <li><code>"1,2"</code>字符串最后被转为数字为<code>NaN</code>，所以结果为<code>NaN</code></li></ul> <p>对于<code>Number(new Date())</code>：</p> <ul><li>传入的是一个日期类型的对象<code>new Date()</code>，因此调用<code>valueOf()</code>，在题目<code>7.2</code>中已经说了，日期类型调用<code>valueOf()</code>是会返回一个毫秒数</li> <li>毫秒数为数字类型，也就是基本数据类型，那么直接返回(其实还有一步转为数字类型的过程)，所以结果为<code>1585413652137</code></li></ul> <p>结果：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// NaN</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 0</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 0</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// NaN</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 1585413652137</span>
</code></pre></div><h3 id="_3-数组转换为字符串为什么会用-连接"><a href="#_3-数组转换为字符串为什么会用-连接" class="header-anchor">#</a> 3. 数组转换为字符串为什么会用","连接？</h3> <p>我们都知道，当数组在进行转字符串的时候，会把里面的每一项都转为字符串然后再进行<code>","</code>拼接返回。</p> <p>那么为什么会有<code>","</code>拼接这一步呢？难道<code>toString()</code>在调用的时候还会调用<code>join()</code>方法吗？</p> <p>为了验证我的想法💡，我做了一个实验，重写了一个数组的<code>join()</code>方法：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
arr<span class="token punctuation">[</span><span class="token string">'join'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> target <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">]</span>
  <span class="token keyword">return</span> target<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'~'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>重写的<code>join</code>函数中，<code>this</code>表示的就是调用的这个数组<code>arr</code>。</p> <p>然后将返回值改为<code>"~"</code>拼接，结果答案竟然是：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">"1~2"</span>
</code></pre></div><p>也就是说在<code>String(arr)</code>的过程中，它确实是隐式调用了<code>join</code>方法。</p> <p>但是当我们重写了<code>toString()</code>之后，就不会管这个重写的<code>join</code>了：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
arr<span class="token punctuation">[</span><span class="token string">'toString'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> target <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">]</span>
  <span class="token keyword">return</span> target<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
arr<span class="token punctuation">[</span><span class="token string">'join'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> target <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">]</span>
  <span class="token keyword">return</span> target<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'~'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// "1*2"</span>
</code></pre></div><p>可以看出<code>toString()</code>的优先级还是比<code>join()</code>高的。</p> <p>现在我们又可以得出一个结论：</p> <p>对象如果是数组的话，当我们不重写其<code>toString()</code>方法，在转换为字符串类型的时候，默认实现就是将调用<code>join()</code>方法的返回值作为<code>toString()</code>的返回值。</p> <h3 id="_4-知道symbol-toprimitive吗-它有什么用"><a href="#_4-知道symbol-toprimitive吗-它有什么用" class="header-anchor">#</a> 4. 知道Symbol.toPrimitive吗？它有什么用？</h3> <p>当我们在进行对象转原始值的时候，会隐式调用内部的<code>ToPrimitive</code>方法，按照前面说的那种方式进行转换。</p> <p>而<code>Symbol.toPrimitive</code>属性是能帮助我们重写<code>toPrimitive</code>，以此来更改转换的结果。</p> <p>让我们来看看它的总结：</p> <ul><li>如果重写了某个对象或者构造函数中的<code>toString、valueOf、Symbol.toPrimitive</code>方法，<code>Symbol.toPrimitive</code>的优先级是最高的</li> <li>若是<code>Symbol.toPrimitive</code>函数返回的值不是基础数据类型(也就是原始值)，就会报错</li> <li><code>Symbol.toPrimitive</code>接收一个字符串参数<code>hint</code>，它表示要转换到的原始值的预期类型，一共有<code>'number'、'string'、'default'</code>三种选项</li> <li>使用<code>String()</code>调用时，<code>hint</code>为<code>'string'</code>；使用<code>Number()</code>时，<code>hint</code>为<code>'number'</code></li> <li><code>hint</code>参数的值从开始调用的时候就已经确定了</li></ul> <p>来看个例子🌰：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">toString</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'toString'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">'1'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">valueOf</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'valueOf'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token parameter">hint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'symbol'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>hint <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'string'</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token string">'1'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>hint <span class="token operator">===</span> <span class="token string">'number'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'number'</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>hint <span class="token operator">===</span> <span class="token string">'default'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token string">'default'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>这道题重写了<code>toString、valueOf、Symbol.toPrimitive</code>三个属性，通过上面👆的题目我们已经知道了只要有<code>Symbol.toPrimitive</code>在，前面两个属性就被忽略了，所以我们不用管它们。</p> <p>而对于<code>Symbol.toPrimitive</code>，我将三种<code>hint</code>的情况都写上了，如果按照我的设想的话，在调用<code>String(b)</code>的时候应该是要打印出<code>string</code>的，调用<code>Number(b)</code>打印出<code>number</code>，结果也正如我所预想的一样：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">'string'</span>
<span class="token string">'1'</span>
<span class="token string">'number'</span>
<span class="token number">1</span>
</code></pre></div><h3 id="_5-在进行比较时的类型转换"><a href="#_5-在进行比较时的类型转换" class="header-anchor">#</a> 5. ==在进行比较时的类型转换？</h3> <p>其实在实际中我们被考的比较多的可能就是用<code>==</code>来比较判断两个不同类型的变量是否相等。</p> <p>而全等<code>===</code>的情况比较简单，一般不太会考，因为全等的条件就是：如果类型相等值也相等才认为是全等，并不会涉及到类型转换。</p> <p>但是<code>==</code>的情况就相对复杂了，先给大家看几个比较眼熟的题哈：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">==</span> <span class="token string">"[object Object]"</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p>怎样？这几题是不是经常看到呀 😁，下面就让我们一个一个来看。</p> <p>首先，我们还是得清楚几个概念，这个是硬性规定的，不看的话咱没法继续下去啊。</p> <p>当使用<code>==</code>进行比较的时候，会有以下转换规则（判断规则）：</p> <ol><li>两边类型如果相同，值相等则相等，如 <code>2 == 3</code>肯定是为<code>false</code>的了</li> <li>比较的双方都为基本数据类型：</li></ol> <ul><li>若是一方为<code>null、undefined</code>，则另一方必须为<code>null或者undefined</code>才为<code>true</code>，也就是<code>null == undefined</code>为<code>true</code>或者<code>null == null</code>为<code>true</code>，因为<code>undefined</code>派生于<code>null</code></li> <li>其中一方为<code>String</code>，是的话则把<code>String</code>转为<code>Number</code>再来比较</li> <li>其中一方为<code>Boolean</code>，是的话则将<code>Boolean</code>转为<code>Number</code>再来比较</li></ul> <ol start="3"><li>比较的一方有引用类型：</li></ol> <ul><li>将引用类型遵循<code>ToNumber</code>的转换形式来进行比较(实际上它的<code>hint</code>是<code>default</code>，也就是<code>toPrimitive(obj, 'default')</code>，但是<code>default</code>的转换规则和<code>number</code>很像)</li> <li>两方都为引用类型，则判断它们是不是指向同一个对象</li></ul> <p>在一些文章中，会说道：</p> <blockquote><p>如果其中一方为Object，且另一方为String、Number或者Symbol，会将Object转换成字符串，再进行比较</p></blockquote> <p>(摘自<a href="https://juejin.im/post/5dac5d82e51d45249850cd20#heading-20" target="_blank" rel="noopener noreferrer">《神三元-(建议收藏)原生JS灵魂之问, 请问你能接得住几个？(上)》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中的<code>3. == 和 ===有什么区别？</code>)</p> <p>这样认为其实也可以，因为想想<code>toPrimitive(obj, 'number')</code>的过程：</p> <ul><li>若是输入值为引用数据类型，则先调用<code>valueOf()</code>方法</li> <li>若是<code>valueOf()</code>方法的返回值是基本数据类型则直接返回，若不是则继续调用<code>toString()</code></li> <li>若是调用<code>toString()</code>的返回值是基本数据类型则返回，否则报错。</li></ul> <p>可以看到，首先是会执行<code>valueOf()</code>的，但是引用类型执行<code>valueOf()</code>方法，除了日期类型，其它情况都是返回它本身，也就是说执行完<code>valueOf()</code>之后，还是一个引用类型并且是它本身。那么我们是不是就可以将<code>valueOf()</code>这一步给省略掉，认为它是直接执行<code>toString()</code>的，这样做起题来也快了很多。</p> <h3 id="_6-几种一元运算符的类型转换"><a href="#_6-几种一元运算符的类型转换" class="header-anchor">#</a> 6. 几种一元运算符的类型转换？</h3> <p>对于几种常用运算符的类型转换：</p> <ol><li><code>-、*、/、%</code>这四种都会把符号两边转成数字来进行运算</li> <li><code>+</code>由于不仅是数字运算符，还是字符串的连接符，所以分为两种情况：</li></ol> <ul><li>两端都是数字则进行数字计算(一元正号<code>+b</code>这种情况相当于转换为数字)</li> <li>有一端是字符串，就会把另一端也转换为字符串进行连接</li></ul> <p>对象的<code>+</code>号类型转换：</p> <ul><li>对象在进行<code>+</code>号字符串连接的时候，<code>toPrimitive</code>的参数<code>hint</code>是<code>default</code>，但是<code>default</code>的执行顺序和<code>number</code>一样都是先判断有没有<code>valueOf</code>，有的话执行<code>valueOf</code>，然后判断<code>valueof</code>后的返回值，若是是引用类型则继续执行<code>toString</code>。(类似题<code>4.5</code>和<code>4.6</code>)</li> <li>日期在进行<code>+</code>号字符串连接的时候，优先调用<code>toString()</code>方法。(类似题<code>4.7</code>)</li> <li><strong>一元正号是转换其他对象到数值的最快方法</strong>,也是最推荐的做法，因为 <strong>它不会对数值执行任何多余操作</strong>。</li></ul> <h3 id="_7-你会几种让if-a-1-a-2-a-3-条件成立的办法"><a href="#_7-你会几种让if-a-1-a-2-a-3-条件成立的办法" class="header-anchor">#</a> 7. 你会几种让if(a == 1 &amp;&amp; a == 2 &amp;&amp; a == 3)条件成立的办法？</h3> <p>这道题相信大家看的不会少，除了重写<code>valueOf()</code>你还会哪些解法呢？</p> <p><strong>解法一：重写<code>valueOf()</code></strong></p> <p>这个解法是利用了：当对象在进行<code>==</code>比较的时候实际是会先执行<code>valueOf()</code>，若是<code>valueOf()</code>的返回值是基本数据类型就返回，否则还是引用类型的话就会继续调用<code>toString()</code>返回，然后判断<code>toString()</code>的返回值，若是返回值为基本数据类型就返回，否则就报错。</p> <p>现在<code>valueOf()</code>每次返回的是一个数字类型，所以会直接返回。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 1</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token function">valueOf</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">++</span><span class="token keyword">this</span><span class="token punctuation">.</span>value
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成立'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>解法二：重写<code>valueOf()</code>和<code>toString()</code></strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token function">valueOf</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toString</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">++</span><span class="token keyword">this</span><span class="token punctuation">.</span>value
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成立'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>原理就是解法一的原理，只不过用到了当<code>valueOf()</code>的返回值是引用类型的时候会继续调用<code>toString()</code>。</p> <p>这里你甚至都可以不用重写<code>valueOf()</code>，因为除了日期对象其它对象在调用<code>valueOf()</code>的时候都是返回它本身。</p> <p>也就是说你也可以这样做：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token function">toString</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">++</span><span class="token keyword">this</span><span class="token punctuation">.</span>value
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成立'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>解法三：重写<code>Symbol.toPrimitive</code></strong></p> <p>想想是不是还可以用<code>Symbol.toPrimitive</code>来解呢？</p> <p>结合题<code>3.10</code>我们知道，当对象在进行<code>==</code>比较的时候，<code>Symbol.toPrimitive</code>接收到的参数<code>hint</code>是<code>"defalut"</code>，那么我们只需要这样重写：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token parameter">hint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>hint <span class="token operator">===</span> <span class="token string">'default'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token operator">++</span><span class="token keyword">this</span><span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成立'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样结果也是可以的。</p> <p><strong>解法四：定义class并重写valueOf()</strong></p> <p>当然你还可以用<code>class</code>来写：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
  <span class="token function">valueOf</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">++</span><span class="token keyword">this</span><span class="token punctuation">.</span>value
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成立'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>解法五：利用数组转为字符串会隐式调用<code>join()</code></strong></p> <p>什么 ？ 还有别的解法吗？而且我看解法五的题目有点没看懂啊。</p> <p>让我们回过头去看看题<code>4.3</code>，那里提到了当数组在进行转字符串的时候，调用<code>toString()</code>的结果其实就是调用<code>join</code>的结果。</p> <p>那和这道题有什么关系？来看看答案：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
a<span class="token punctuation">[</span><span class="token string">'join'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成立'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>因为我们知道，对象如果是数组的话，当我们不重写其<code>toString()</code>方法，在转换为字符串类型的时候，默认实现就是将调用<code>join()</code>方法的返回值作为<code>toString()</code>的返回值。</p> <p>所以这里我们重写了<code>a</code>的<code>join</code>方法，而这次重写做了两件事情：</p> <ol><li>将数组<code>a</code>执行<code>a.shift()</code>方法，我们知道这会影响原数组<code>a</code>的，将第一项去除</li> <li>将刚刚去除的第一项返回回去</li></ol> <p>所以当我们在执行<code>a == 1</code>这一步的时候，由于隐式调用了<code>a['join']</code>方法，所以会执行上面👆说的那两件事情，后面的<code>a == 2</code>和<code>a == 3</code>同理。</p> <p><strong>解法六：定义class继承Array并重写join()</strong></p> <p>对于解法五我们同样可以用<code>class</code>来实现</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token keyword">extends</span> <span class="token class-name">Array</span> <span class="token punctuation">{</span>
  join <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>shift
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成立'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这种写法比较酷🆒，但是第一次看可能不太能懂。</p> <ul><li>首先<code>A</code>这个类通过<code>extends</code>继承于<code>Array</code>，这样通过<code>new A</code>创建的就是一个数组</li> <li>然后<code>A</code>重写了<code>join</code>方法，<code>join = this.shift</code>就相当于是<code>join = function () { return this.shift() }</code></li> <li>这样当每次调用<code>a == xxx</code>的时候，都会隐式调用我们自定义的<code>join</code>方法，执行和解法五一样的操作。</li></ul> <h3 id="_8-让if-a-1-a-2-a-3-条件成立"><a href="#_8-让if-a-1-a-2-a-3-条件成立" class="header-anchor">#</a> 8. 让if (a === 1 &amp;&amp; a === 2 &amp;&amp; a === 3)条件成立？</h3> <p>这道题看着和上面那道有点像，不过这里判断的条件是全等的。</p> <p>我们知道全等的条件：</p> <ol><li>左右两边的类型要相等，如果类型不相等则直接返回<code>false</code>，这点和<code>==</code>不同，<code>==</code>会发生隐式类型转换</li> <li>再判断值相不相等</li></ol> <p>而对于上面👆一题的解法我们都是利用了<code>==</code>会发生隐式类型转换这一点，显然如果再用它来解决这道题是不能实现的。</p> <p>想想当我们在进行<code>a === xxx</code>判断的时候，实际上就是调用了<code>a</code>这个数据而已，也就是说我们要在调用这个数据之前，做一些事情，来达到我们的目的。</p> <p>想想在<code>Vue2.x</code>中不就是利用了<code>Object.defineProperty()</code>方法重新定义<code>data</code>中的所有属性，那么在这里我们同样也可以利用它来劫持<code>a</code>，修改<code>a</code>变量的<code>get</code>属性。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">===</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成立'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这里实际就做了这么几件事情：</p> <ul><li>使用<code>Object.defineProperty()</code>方法劫持全局变量<code>window</code>上的属性<code>a</code></li> <li>当每次调用<code>a</code>的时候将<code>value</code>自增，并返回自增后的值</li></ul> <p>（其实我还想着用<code>Proxy</code>来进行数据劫持，代理一下<code>window</code>，将它用<code>new Proxy()</code>处理一下，但是对于<code>window</code>对象好像没有效果...）</p> <p><strong>解法二</strong></p> <p>怎么办 😂，一碰到这种题我又想到了数组...</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>arr<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">===</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">===</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'成立'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>中了<code>shift()</code>的毒...当然，这样也是可以实现的。</p> <p><strong>解法三</strong></p> <p>还有就是<a href="https://juejin.im/user/584c7f44ac502e0069275cd7" target="_blank" rel="noopener noreferrer">EnoYao<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>大佬那里看来的骚操作：</p> <p>原文链接：https://juejin.im/post/5e66dc416fb9a07cab3aaa0a</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> aﾠ <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ﾠa <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>aﾠ <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> ﾠa <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"成立"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>说来惭愧...<code>a</code>的前后隐藏的字符我打不来 😂...</p> <h3 id="_9-控制台输入-会怎样"><a href="#_9-控制台输入-会怎样" class="header-anchor">#</a> 9. 控制台输入{}+[]会怎样？</h3> <p>这道有趣的题是从<a href="https://juejin.im/user/5cd2341ce51d456e5c5baba3" target="_blank" rel="noopener noreferrer">LINGLONG<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的一篇<a href="https://juejin.im/post/5e605528518825495c659769" target="_blank" rel="noopener noreferrer">《【js小知识】[]+ {} =？/{} +[] =?（关于加号的隐式类型转换）》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>那里看来的。</p> <p>(PS: pick一波玲珑，这位小姐姐的文章写的都挺好的，不过热度都不高，大家可以支持一下呀 😁)</p> <p>OK👌，来看看题目是这样的：</p> <p>在控制台(比如浏览器的控制台)输入:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre></div><p>的结果会是什么 🤔️？</p> <p>咦～这道题应该很简单吧，根据前面的类型转换原则，<code>+</code>两边都转换为字符串，<code>{}</code>转为<code>"[object Object]"</code>，<code>[]</code>转为<code>""</code>，拼接的结果就是：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// "[object Object]"</span>
</code></pre></div><p>但是注意这里的题目，是要在控制台输出哦。</p> <p>此时我把这段代码在控制台输出结果发现答案竟然和预期的不一样：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token number">0</span>
</code></pre></div><p>也就是说<code>{}</code>被忽略了，直接执行了<code>+[]</code>，结果为<code>0</code>。</p> <p>知道原因的我眼泪掉了下来，原来它和之前提到的<code>1.toString()</code>有点像，也是因为<code>JS</code>对于代码解析的原因，在控制台或者终端中，<code>JS</code>会认为大括号<code>{}</code>开头的是一个空的代码块，这样看着里面没有内容就会忽略它了。</p> <p>所以只执行了<code>+[]</code>，将其转换为<code>0</code>。</p> <p>如果我们换个顺序的话就不会有这种问题：</p> <p><img src="https://s.poetries.top/gitee/2020/09/17.png" alt=""></p> <p>(图片来源：https://juejin.im/post/5e605528518825495c659769#heading-12)</p> <p>为了证实这一点，我们可以把<code>{}</code>当成空对象来调用一些对象的方法，看会有什么效果：</p> <p>（控制台或者终端）</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>现在的<code>{}</code>依旧被认为是代码块而不是一个对象，所以会报错：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Uncaught SyntaxError<span class="token operator">:</span> Unexpected token <span class="token string">'.'</span>
</code></pre></div><p>解决办法可以用一个<code>()</code>将它扩起来：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>toString
</code></pre></div><p>不过这东西在实际中用的不多，我能想到的一个就是在项目中(比如我用的<code>vue</code>)，然后定义<code>props</code>的时候，如果其中一个属性的默认值你是想要定义为一个空对象的话，就会用到：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> Object<span class="token punctuation">,</span>
        <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="第五补-八种js继承"><a href="#第五补-八种js继承" class="header-anchor">#</a> 第五补：八种JS继承</h2> <p>对于<code>JS</code>继承我也写了一个系列「封装|继承|多态」，这里是传送门：</p> <ul><li><a href="https://juejin.im/post/5e707417e51d45272054d5d3" target="_blank" rel="noopener noreferrer">封装<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.im/post/5e75e22951882549027687f9" target="_blank" rel="noopener noreferrer">继承<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>多态(缓一缓还在写😂)</li></ul> <p>具体的例子还有题目在文章中都已经说的很清楚了，这里我就只列举一下各个继承的优缺点以及伪代码。</p> <h4 id="_1-原型链继承"><a href="#_1-原型链继承" class="header-anchor">#</a> 1. 原型链继承</h4> <p><code>伪代码：</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><code>思维导图：</code></p> <p><img src="https://s.poetries.top/gitee/2020/09/18.png" alt=""></p> <p><strong>优点：</strong></p> <ul><li>继承了父类的模板，又继承了父类的原型对象</li></ul> <p><strong>缺点：</strong></p> <ul><li>如果要给子类的原型上新增属性和方法，就必须放在<code>Child.prototype = new Parent()</code>这样的语句后面</li> <li>无法实现多继承(因为已经指定了原型对象了)</li> <li>来自原型对象的所有属性都被共享了，这样如果不小心修改了原型对象中的引用类型属性，那么所有子类创建的实例对象都会受到影响</li> <li>创建子类时，无法向父类构造函数传参数</li></ul> <h4 id="_2-构造继承"><a href="#_2-构造继承" class="header-anchor">#</a> 2. 构造继承</h4> <p><code>伪代码：</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">...</span>arguments<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>思维导图：</code></p> <p><img src="https://s.poetries.top/gitee/2020/09/19.png" alt=""></p> <p><strong>优点：</strong></p> <ul><li>解决了原型链继承中子类实例共享父类引用对象的问题，实现多继承，创建子类实例时，可以向父类传递参数</li></ul> <p><strong>缺点：</strong></p> <ul><li>构造继承<strong>只能</strong>继承父类的实例属性和方法，<strong>不能</strong>继承父类原型的属性和方法</li> <li>实例并不是父类的实例，只是子类的实例</li> <li><strong>无法实现函数复用</strong>，每个子类都有父类实例函数的副本，影响性能</li></ul> <h4 id="_3-组合继承"><a href="#_3-组合继承" class="header-anchor">#</a> 3. 组合继承</h4> <p><code>伪代码：</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 构造继承</span>
<span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">...</span>arguments<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 原型链继承</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 修正constructor</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Child
</code></pre></div><p><code>思维导图：</code></p> <p><img src="https://s.poetries.top/gitee/2020/09/20.png" alt=""></p> <p><strong>实现方式：</strong></p> <ul><li>使用<strong>原型链继承</strong>来保证子类能继承到父类原型中的属性和方法</li> <li>使用<strong>构造继承</strong>来保证子类能继承到父类的实例属性和方法</li></ul> <p><strong>优点：</strong></p> <ul><li>可以继承父类实例属性和方法，也能够继承父类原型属性和方法</li> <li>弥补了原型链继承中引用属性共享的问题</li> <li>可传参，可复用</li></ul> <p><strong>缺点：</strong></p> <ul><li>使用组合继承时，父类构造函数会被调用两次</li> <li>并且生成了两个实例，子类实例中的属性和方法会覆盖子类原型(父类实例)上的属性和方法，所以增加了不必要的内存。</li></ul> <h4 id="_4-寄生组合继承"><a href="#_4-寄生组合继承" class="header-anchor">#</a> 4. 寄生组合继承</h4> <p><code>伪代码：</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 构造继承</span>
<span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">...</span>arguments<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 原型式继承</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
<span class="token comment">// 修正constructor</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Child
</code></pre></div><p><code>思维导图：</code></p> <p><img src="https://s.poetries.top/gitee/2020/09/21.png" alt=""></p> <p><strong>寄生组合继承</strong>算是<code>ES6</code>之前一种比较完美的继承方式吧。</p> <p>它避免了<strong>组合继承</strong>中调用两次父类构造函数，初始化两次实例属性的缺点。</p> <p>所以它拥有了上述所有继承方式的优点：</p> <ul><li>只调用了一次父类构造函数，只创建了一份父类属性</li> <li>子类可以用到父类原型链上的属性和方法</li> <li>能够正常的使用<code>instanceOf</code>和<code>isPrototypeOf</code>方法</li></ul> <h4 id="_5-原型式继承"><a href="#_5-原型式继承" class="header-anchor">#</a> 5. 原型式继承</h4> <p><code>伪代码：</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> child <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span>
</code></pre></div><p><strong>实现方式：</strong></p> <p>该方法的原理是创建一个构造函数，构造函数的原型指向对象，然后调用 new 操作符创建实例，并返回这个实例，本质是一个浅拷贝。</p> <p>在<code>ES5</code>之后可以直接使用<code>Object.create()</code>方法来实现，而在这之前就只能手动实现一个了(如题目<code>6.2</code>)。</p> <p><strong>优点：</strong></p> <ul><li>再不用创建构造函数的情况下，实现了原型链继承，代码量减少一部分。</li></ul> <p><strong>缺点：</strong></p> <ul><li>一些引用数据操作的时候会出问题，两个实例会公用继承实例的引用数据类</li> <li>谨慎定义方法，以免定义方法也继承对象原型的方法重名</li> <li>无法直接给父级构造函数使用参数</li></ul> <h4 id="_6-寄生式继承"><a href="#_6-寄生式继承" class="header-anchor">#</a> 6. 寄生式继承</h4> <p><code>伪代码：</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createAnother</span> <span class="token punctuation">(</span><span class="token parameter">original</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> clone <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span> <span class="token comment">// 通过调用 Object.create() 函数创建一个新对象</span>
    clone<span class="token punctuation">.</span><span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 以某种方式来增强对象</span>
    <span class="token keyword">return</span> clone<span class="token punctuation">;</span> <span class="token comment">// 返回这个对象</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>实现方式：</strong></p> <ul><li>在<strong>原型式继承</strong>的基础上再封装一层，来增强对象，之后将这个对象返回。</li></ul> <p><strong>优点：</strong></p> <ul><li>再不用创建构造函数的情况下，实现了原型链继承，代码量减少一部分。</li></ul> <p><strong>缺点：</strong></p> <ul><li>一些引用数据操作的时候会出问题，两个实例会公用继承实例的引用数据类</li> <li>谨慎定义方法，以免定义方法也继承对象原型的方法重名</li> <li>无法直接给父级构造函数使用参数</li></ul> <h4 id="_7-混入方式继承"><a href="#_7-混入方式继承" class="header-anchor">#</a> 7. 混入方式继承</h4> <p><code>伪代码：</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token function">OtherParent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token class-name">OtherParent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Child
</code></pre></div><p><code>思维导图：</code></p> <p><img src="https://s.poetries.top/gitee/2020/09/22.png" alt=""></p> <h4 id="_8-class中的继承"><a href="#_8-class中的继承" class="header-anchor">#</a> 8. class中的继承</h4> <p><code>伪代码：</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token keyword">extends</span> <span class="token class-name">Parent</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>ES6中的继承：</strong></p> <ul><li>主要是依赖<code>extends</code>关键字来实现继承，且继承的效果类似于<strong>寄生组合继承</strong></li> <li>使用了<code>extends</code>实现继承不一定要<code>constructor</code>和<code>super</code>，因为没有的话会默认产生并调用它们</li> <li><code>extends</code>后面接着的目标不一定是<code>class</code>，只要是个有<code>prototype</code>属性的函数就可以了</li></ul> <p><strong>ES5继承和ES6继承的区别：</strong></p> <ul><li>在<code>ES5</code>中的继承(例如<strong>构造继承、寄生组合继承</strong>) ，实质上是先创造子类的实例对象<code>this</code>，然后再将父类的属性和方法添加到<code>this</code>上(使用的是<code>Parent.call(this)</code>)。</li> <li>而在<code>ES6</code>中却不是这样的，它实质是<strong>先创造父类的实例对象<code>this</code>(也就是使用<code>super()</code>)，然后再用子类的构造函数去修改<code>this</code></strong></li></ul></div> <!----> <div class="readMore-wrapper"><span class="readMore">阅读全文</span></div>
                    </div>
                            <p>这是一个信息提示框。</p>
                        </div>

                        <div class="note warning">
                            <div class="note-title"><i class="fas fa-exclamation-triangle"></i> 注意</div>
                            <p>这是一个警告提示框。</p>
                        </div>

                        <div class="note success">
                            <div class="note-title"><i class="fas fa-check-circle"></i> 成功</div>
                            <p>这是一个成功提示框。</p>
                        </div>

                        <h2>代码示例</h2>
                        <pre><code class="language-javascript">// 示例代码
function example() {
    console.log('Hello, FrontendHub!');
}
</code></pre>
                    </div>

                    <!-- 文章底部导航 -->
                    <nav class="article-nav">
                        <a href="#" class="prev-article">
                            <i class="fas fa-chevron-left"></i>
                            <span>上一篇</span>
                        </a>
                        <a href="#" class="next-article">
                            <span>下一篇</span>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </nav>
                </article>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4><i class="fas fa-code"></i> FrontendHub</h4>
                    <p>专注于前端技术学习与面试准备</p>
                </div>
                <div class="footer-section">
                    <h4>快速链接</h4>
                    <ul>
                        <li><a href="../../index.html">首页</a></li>
                        <li><a href="../index.html#courses">课程体系</a></li>
                        <li><a href="../index.html#resources">学习资源</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 FrontendHub. 用于个人学习使用.</p>
            </div>
        </div>
    </footer>

    <!-- 返回顶部按钮 -->
    <button class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script src="../../js/main.js"></script>
    <script src="../../js/content.js"></script>
</body>
</html>

