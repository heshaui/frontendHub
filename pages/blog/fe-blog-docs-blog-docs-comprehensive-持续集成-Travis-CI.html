<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="referrer" content="no-referrer">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>持续集成 Travis CI - FrontendHub</title>
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="../../css/content.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="content-page">
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <a href="../../index.html" style="color: inherit; text-decoration: none; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-code"></i>
                    <span>FrontendHub</span>
                </a>
            </div>
            <button class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-menu" id="navMenu">
                <li><a href="../../index.html">首页</a></li>
                <li><a href="../index.html#features">特色</a></li>
                <li><a href="../index.html#courses">课程</a></li>
                <li><a href="../index.html#resources">资源</a></li>
            </ul>
        </div>
    </nav>

    <!-- 面包屑导航 -->
    <div class="breadcrumb">
        <div class="container">
            <a href="../../index.html"><i class="fas fa-home"></i> 首页</a>
            <i class="fas fa-chevron-right"></i>
            <span>持续集成 Travis CI</span>
        </div>
    </div>

    <!-- 主要内容区 -->
    <main class="content-main">
        <div class="container">
            <div class="content-layout">
                <!-- 侧边栏目录 -->
                <aside class="sidebar">
                    <div class="sidebar-sticky">
                        <h3><i class="fas fa-list"></i> 目录</h3>
                        <nav class="toc" id="toc">
                            <!-- 目录将通过JavaScript自动生成 -->
                        </nav>
                    </div>
                </aside>

                <!-- 文章内容 -->
                <article class="article">
                    <header class="article-header">
                        <h1>持续集成 Travis CI</h1>
                        <div class="article-meta">
                            <span><i class="far fa-calendar"></i> 更新时间：2025-12-23</span>
                            <span><i class="far fa-clock"></i> 阅读时长：约 15 分钟</span>
                        </div>
                    </header>

                    <div class="article-content">
<div class="content__default"><h4 id="一、什么是持续集成"><a href="#一、什么是持续集成" class="header-anchor">#</a> 一、什么是持续集成？</h4> <ul><li><code>Travis CI</code> 提供的是持续集成服务（<code>Continuous Integration</code>，简称 <code>CI</code>）。它绑定 <code>Github</code> 上面的项目，只要有新的代码，就会自动抓取。然后，提供一个运行环境，执行测试，完成构建，还能部署到服务器。</li> <li>持续集成指的是只要代码有变更，就自动运行构建和测试，反馈运行结果。确保符合预期以后，再将新代码"集成"到主干。</li> <li>持续集成的好处在于，每次代码的小幅变更，就能看到运行结果，从而不断累积小的变更，而不是在开发周期结束时，一下子合并一大块代码</li></ul> <h4 id="二、-travis-yml"><a href="#二、-travis-yml" class="header-anchor">#</a> 二、.travis.yml</h4> <blockquote><p>Travis 要求项目的根目录下面，必须有一个<code>.travis.yml</code>文件。这是配置文件，指定了 <code>Travis</code> 的行为。该文件必须保存在 <code>Github</code> 仓库里面，一旦代码仓库有新的 <code>Commit</code>，<code>Travis</code>就会去找这个文件，执行里面的命令</p></blockquote> <ul><li>这个文件采用 <code>YAML</code> 格式。下面是一个最简单的 <code>Python</code> 项目的<code>.travis.yml</code>文件</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>language: python
script: <span class="token boolean">true</span>
</code></pre></div><ul><li><code>language</code>字段指定了默认运行环境，这里设定使用 <code>Python</code> 环境</li> <li><code>script</code>字段指定要运行的脚本，<code>script: true</code>表示不执行任何脚本，状态直接设为成功</li></ul> <p><strong>面是一个稍微复杂一点的.travis.yml</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>language: python
sudo: required
before_install: <span class="token function">sudo</span> pip <span class="token function">install</span> foo
script: py.test
</code></pre></div><h4 id="三、运行流程"><a href="#三、运行流程" class="header-anchor">#</a> 三、运行流程</h4> <ul><li><code>Travis</code> 的运行流程很简单，任何项目都会经过两个阶段
<ul><li><code>install</code>  阶段：安装依赖</li> <li><code>script</code> 阶段：运行脚本</li></ul></li></ul> <h5 id="_3-1-install-阶段"><a href="#_3-1-install-阶段" class="header-anchor">#</a> 3.1 install 阶段</h5> <blockquote><p><code>install</code>字段用来指定安装脚本</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>install: ./install-dependencies.sh
</code></pre></div><ul><li>如果有多个脚本，可以写成下面的形式</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>install:
 - command1
 - command2
</code></pre></div><ul><li>上面代码中，如果<code>command1</code>失败了，整个构建就会停下来，不再往下进行。</li> <li>如果不需要安装，即跳过安装阶段，就直接设为<code>true</code>。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>install: true
</code></pre></div><h5 id="_3-2、script-字段"><a href="#_3-2、script-字段" class="header-anchor">#</a> 3.2、script 字段</h5> <ul><li><code>script</code>字段用来指定构建或测试脚本</li></ul> <p><code>script: bundle exec thor build</code></p> <ul><li>如果有多个脚本，可以写成下面的形式</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>script:
 - command1
 - command2
</code></pre></div><blockquote><p><strong>注意</strong>，<code>script</code>与<code>install</code>不一样，如果<code>command1</code>失败，<code>command2</code>会继续执行。但是，整个构建阶段的状态是失败。如果<code>command2</code>只有在<code>command1</code>成功后才能执行，就要写成下面这样。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>script: command1 &amp;&amp; command2
</code></pre></div><h5 id="_3-3-实例-node-项目"><a href="#_3-3-实例-node-项目" class="header-anchor">#</a> 3.3 实例：Node 项目</h5> <ul><li><code>Node</code> 项目的环境需要写成下面这样</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>language: node_js
node_js:
  - <span class="token string">"8"</span>
</code></pre></div><ul><li>上面代码中，<code>node_js</code>字段用来指定 <code>Node</code> 版本。</li> <li><code>Node</code> 项目的<code>install</code>和<code>script</code>阶段都有默认脚本，可以省略
<ul><li><code>install</code>默认值：<code>npm install</code></li> <li><code>script</code>默认值：<code>npm test</code></li></ul></li></ul> <h5 id="_3-4-部署"><a href="#_3-4-部署" class="header-anchor">#</a> 3.4 部署</h5> <ul><li><code>script</code>阶段结束以后，还可以设置<a href="https://docs.travis-ci.com/user/notifications/" target="_blank" rel="noopener noreferrer">通知步骤（notification）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和<a href="https://docs.travis-ci.com/user/deployment/" target="_blank" rel="noopener noreferrer">部署步骤<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>（deployment），它们不是必须的</li></ul> <blockquote><p>部署的脚本可以在<code>script</code>阶段执行，也可以使用 <code>Travis</code> 为几十种常见服务提供的快捷部署功能。比如，要部署到 <code>Github Pages</code>，可以写成下面这样</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code>deploy:
  provider: pages
  skip_cleanup: <span class="token boolean">true</span>
  github_token: <span class="token variable">$GITHUB_TOKEN</span> <span class="token comment"># Set in travis-ci.org dashboard</span>
  on:
    branch: master
</code></pre></div><ul><li><a href="https://docs.travis-ci.com/user/deployment/" target="_blank" rel="noopener noreferrer">其他部署方式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h5 id="_3-5-钩子方法"><a href="#_3-5-钩子方法" class="header-anchor">#</a> 3.5 钩子方法</h5> <blockquote><p><code>Travis</code> 为上面这些阶段提供了7个钩子</p></blockquote> <ul><li><code>before_install</code>：install 阶段之前执行</li> <li><code>before_script</code>：script 阶段之前执行</li> <li><code>after_failure</code>：script 阶段失败时执行</li> <li><code>after_success</code>：script 阶段成功时执行</li> <li><code>before_deploy</code>：deploy 步骤之前执行</li> <li><code>after_deploy</code>：deploy 步骤之后执行</li> <li><code>after_script</code>：script 阶段之后执行</li></ul> <blockquote><p>完整的生命周期，从开始到结束是下面的流程</p></blockquote> <ul><li><p><code>before_install</code></p></li> <li><p><code>install</code></p></li> <li><p><code>before_script</code></p></li> <li><p><code>script</code></p></li> <li><p><code>aftersuccess or afterfailure</code></p></li> <li><p><code>[OPTIONAL] before_deploy</code></p></li> <li><p><code>[OPTIONAL] deploy</code></p></li> <li><p><code>[OPTIONAL] after_deploy</code></p></li> <li><p><code>after_script</code></p></li> <li><p>下面是一个before_install钩子的例子</p></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>before_install:
  - <span class="token function">sudo</span> <span class="token function">apt-get</span> -qq update
  - <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y libxml2-dev
</code></pre></div><blockquote><p>上面代码表示<code>before_install</code>阶段要做两件事，第一件事是要更新依赖，第二件事是安装<code>libxml2-dev</code>。用到的几个参数的含义如下：-qq表示减少中间步骤的输出，-y表示如果需要用户输入，总是输入yes</p></blockquote> <h5 id="_3-6-运行状态"><a href="#_3-6-运行状态" class="header-anchor">#</a> 3.6 运行状态</h5> <ul><li>最后，<code>Travis</code> 每次运行，可能会返回四种状态
<ul><li><code>passed</code>：运行成功，所有步骤的退出码都是0</li> <li><code>canceled</code>：用户取消执行</li> <li><code>errored</code>：<code>before_install</code>、<code>install</code>、<code>before_script</code>有非零退出码，运行会立即停止</li> <li><code>failed</code> ：<code>script</code>有非零状态码 ，会继续运行</li></ul></li></ul> <h4 id="四、使用技巧"><a href="#四、使用技巧" class="header-anchor">#</a> 四、使用技巧</h4> <h5 id="_4-1-环境变量"><a href="#_4-1-环境变量" class="header-anchor">#</a> 4.1 环境变量</h5> <ul><li><code>.travis.yml</code>的env字段可以定义环境变量,然后，脚本内部就使用这些变量了</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>env:
  - <span class="token assign-left variable">DB</span><span class="token operator">=</span>postgres
  - <span class="token assign-left variable">SH</span><span class="token operator">=</span>bash
  - <span class="token assign-left variable">PACKAGE_VERSION</span><span class="token operator">=</span><span class="token string">"1.0.*"</span>
</code></pre></div><blockquote><p>有些环境变量（比如用户名和密码）不能公开，这时可以通过 Travis 网站，写在每个仓库的设置页里面，Travis 会自动把它们加入环境变量。这样一来，脚本内部依然可以使用这些环境变量，但是只有管理员才能看到变量的值,<a href="https://docs.travis-ci.com/user/environment-variables" target="_blank" rel="noopener noreferrer">具体操作文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p><img src="http://www.ruanyifeng.com/blogimg/asset/2017/bg2017121903.png" alt=""></p> <h5 id="_4-2-加密信息"><a href="#_4-2-加密信息" class="header-anchor">#</a> 4.2 加密信息</h5> <ul><li>如果不放心保密信息明文存在 <code>Travis</code> 的网站，可以使用 <code>Travis</code> 提供的加密功能</li></ul></div> <!----> <div class="readMore-wrapper"><span class="readMore">阅读全文</span></div>
                    </div>
                            <p>这是一个信息提示框。</p>
                        </div>

                        <div class="note warning">
                            <div class="note-title"><i class="fas fa-exclamation-triangle"></i> 注意</div>
                            <p>这是一个警告提示框。</p>
                        </div>

                        <div class="note success">
                            <div class="note-title"><i class="fas fa-check-circle"></i> 成功</div>
                            <p>这是一个成功提示框。</p>
                        </div>

                        <h2>代码示例</h2>
                        <pre><code class="language-javascript">// 示例代码
function example() {
    console.log('Hello, FrontendHub!');
}
</code></pre>
                    </div>

                    <!-- 文章底部导航 -->
                    <nav class="article-nav">
                        <a href="#" class="prev-article">
                            <i class="fas fa-chevron-left"></i>
                            <span>上一篇</span>
                        </a>
                        <a href="#" class="next-article">
                            <span>下一篇</span>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </nav>
                </article>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4><i class="fas fa-code"></i> FrontendHub</h4>
                    <p>专注于前端技术学习与面试准备</p>
                </div>
                <div class="footer-section">
                    <h4>快速链接</h4>
                    <ul>
                        <li><a href="../../index.html">首页</a></li>
                        <li><a href="../index.html#courses">课程体系</a></li>
                        <li><a href="../index.html#resources">学习资源</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 FrontendHub. 用于个人学习使用.</p>
            </div>
        </div>
    </footer>

    <!-- 返回顶部按钮 -->
    <button class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script src="../../js/main.js"></script>
    <script src="../../js/content.js"></script>
</body>
</html>

