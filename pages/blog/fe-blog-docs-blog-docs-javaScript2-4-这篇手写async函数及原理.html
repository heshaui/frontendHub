<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¿™ç¯‡æ‰‹å†™asyncå‡½æ•°åŠåŸç† - FrontendHub</title>
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="../../css/content.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="content-page">
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <a href="../../index.html" style="color: inherit; text-decoration: none; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-code"></i>
                    <span>FrontendHub</span>
                </a>
            </div>
            <button class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-menu" id="navMenu">
                <li><a href="../../index.html">é¦–é¡µ</a></li>
                <li><a href="../index.html#features">ç‰¹è‰²</a></li>
                <li><a href="../index.html#courses">è¯¾ç¨‹</a></li>
                <li><a href="../index.html#resources">èµ„æº</a></li>
            </ul>
        </div>
    </nav>

    <!-- é¢åŒ…å±‘å¯¼èˆª -->
    <div class="breadcrumb">
        <div class="container">
            <a href="../../index.html"><i class="fas fa-home"></i> é¦–é¡µ</a>
            <i class="fas fa-chevron-right"></i>
            <span>è¿™ç¯‡æ‰‹å†™asyncå‡½æ•°åŠåŸç†</span>
        </div>
    </div>

    <!-- ä¸»è¦å†…å®¹åŒº -->
    <main class="content-main">
        <div class="container">
            <div class="content-layout">
                <!-- ä¾§è¾¹æ ç›®å½• -->
                <aside class="sidebar">
                    <div class="sidebar-sticky">
                        <h3><i class="fas fa-list"></i> ç›®å½•</h3>
                        <nav class="toc" id="toc">
                            <!-- ç›®å½•å°†é€šè¿‡JavaScriptè‡ªåŠ¨ç”Ÿæˆ -->
                        </nav>
                    </div>
                </aside>

                <!-- æ–‡ç« å†…å®¹ -->
                <article class="article">
                    <header class="article-header">
                        <h1>è¿™ç¯‡æ‰‹å†™asyncå‡½æ•°åŠåŸç†</h1>
                        <div class="article-meta">
                            <span><i class="far fa-calendar"></i> æ›´æ–°æ—¶é—´ï¼š2025-12-23</span>
                            <span><i class="far fa-clock"></i> é˜…è¯»æ—¶é•¿ï¼šçº¦ 15 åˆ†é’Ÿ</span>
                        </div>
                    </header>

                    <div class="article-content">
<div class="content__default"><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="header-anchor">#</a> æ­£æ–‡</h2> <p><code>ES8</code>æ¨å‡ºçš„<code>async/await</code>å…è®¸æˆ‘ä»¬ç”¨æ›´åŠ ä¼˜é›…çš„æ–¹å¼æ¥å®ç°å¼‚æ­¥ä»£ç ï¼Œä»æŸç§è§’åº¦ä¸Šæ¥è¯´ï¼Œå®ƒæ˜¯<code>Generator</code>å‡½æ•°çš„è¯­æ³•ç³–ï¼Œå°±åƒæˆ‘ä»¬ç»å¸¸è¯´<code>class</code>æ˜¯æ„é€ å‡½æ•°çš„è¯­æ³•ç³–ä¸€æ ·ã€‚</p> <h3 id="asyncæ¡ˆä¾‹"><a href="#asyncæ¡ˆä¾‹" class="header-anchor">#</a> asyncæ¡ˆä¾‹</h3> <p>åŸºæœ¬ç”¨æ³•å•¥çš„æˆ‘å°±ä¸è¯´äº†ï¼Œè¿™é‡Œç›´æ¥ä¸Šä¸€ä¸ªç®€å•çš„æ¡ˆä¾‹ï¼Œåé¢ä¸€æ­¥æ­¥çš„è½¬æ¢è¿‡ç¨‹éƒ½æ˜¯ä»¥æ­¤æ¡ˆä¾‹ä½œä¸ºåŸºç¡€ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">getData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">test</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data: '</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> data2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data2: '</span><span class="token punctuation">,</span> data2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token string">'success'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>é’ˆå¯¹äºä¸Šé¢çš„è¿™æ®µä»£ç ï¼Œç›¸ä¿¡å¤§å®¶éƒ½æ²¡æœ‰ä»€ä¹ˆç–‘é—®ï¼Œå¾ˆå¿«æˆ‘ä»¬å°±èƒ½è¯´å‡ºç­”æ¡ˆï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 1s åæ‰“å°å‡º</span>
<span class="token string">'data '</span> <span class="token string">'data'</span>
<span class="token comment">// 1s åæ‰“å°å‡º</span>
<span class="token string">'data2: '</span> <span class="token string">'data'</span>
<span class="token string">'success'</span>
</code></pre></div><h3 id="generatoræ¡ˆä¾‹"><a href="#generatoræ¡ˆä¾‹" class="header-anchor">#</a> Generatoræ¡ˆä¾‹</h3> <p>è®©æˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹<code>Generator</code>æœ€åŸºæœ¬çš„ä¸€äº›æ¦‚å¿µï¼š</p> <ul><li><code>function</code>åé¢åŠ ä¸Š<code>*</code>è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª<code>Generator</code>å‡½æ•°ï¼Œå¦‚<code>function* testG(){}</code></li> <li>å‡½æ•°å†…éƒ¨å¯ä»¥ä½¿ç”¨<code>yield</code>æ¥ä¸­æ–­å‡½æ•°çš„æ‰§è¡Œï¼Œå³å½“æ¯æ¬¡æ‰§è¡Œåˆ°<code>yield</code>è¯­å¥çš„æ—¶å€™ï¼Œå‡½æ•°æš‚åœæ‰§è¡Œ</li> <li>æš‚åœæ‰§è¡Œä¹‹åï¼Œéœ€è¦è°ƒç”¨<code>next()</code>æ‰ä¼šç»§ç»­æ‰§è¡Œ<code>Generator</code>å‡½æ•°ï¼Œç›´åˆ°ç¢°åˆ°å‡½æ•°å†…ä¸‹ä¸€ä¸ª<code>yield</code>åˆä¼šæš‚åœ</li> <li>ä»¥æ­¤å¾ªç¯ï¼Œç›´åˆ°å‡½æ•°å†…æœ‰<code>return</code>æˆ–è€…å‡½æ•°å†…ä»£ç å…¨éƒ¨æ‰§è¡Œå®Œ</li></ul> <p>å…¶ä¸­è¿˜æœ‰å¾ˆé‡è¦çš„ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œå°±æ˜¯æ¯æ¬¡è°ƒç”¨<code>next()</code>çš„è¿”å›å€¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šæœ‰ä¸¤ä¸ªå±æ€§ï¼š</p> <ul><li><code>value</code>ï¼š<code>yield</code>è¯­å¥åçš„è¡¨è¾¾å¼çš„ç»“æœ</li> <li><code>done</code>ï¼šå½“å‰çš„<code>Generator</code>å¯¹è±¡çš„é€»è¾‘å—æ˜¯å¦æ‰§è¡Œå®Œæˆ</li></ul> <p>å¦‚æœè¯´æˆ‘ä»¬æŠŠä¸Šé¢çš„æ¡ˆä¾‹è½¬æ¢ä¸º<code>Generator</code>æ¥å®ç°çš„è¯ï¼Œæˆ‘ä»¬æƒ³çš„å¯èƒ½ä¼šæ˜¯è¿™æ ·æ¥å†™ï¼š</p> <p><em>æ¡ˆä¾‹ä¸€ï¼š</em></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">getData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">testG</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data: '</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> data2 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data2: '</span><span class="token punctuation">,</span> data2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token string">'success'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> gen <span class="token operator">=</span> <span class="token function">testG</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ä¹‹åæ‰‹åŠ¨è°ƒç”¨3æ¬¡</span>
gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¯æ˜¯ä¸Šé¢ğŸ‘†çš„ä»£ç çœŸçš„ä¼šå’Œ<code>async</code>æ¡ˆä¾‹ä¸­çš„æ‰§è¡Œç»“æœä¸€æ ·å—ï¼Ÿ</p> <p>å½“æˆ‘æ‰“å¼€æ§åˆ¶å°çš„æ—¶å€™ï¼Œç»“æœå´å‡ºä¹æˆ‘çš„æ„æ–™ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>data: undefined
data2: undefined
</code></pre></div><p>What...?</p> <p>ä½ çš„<code>suceess</code>æ²¡æœ‰æ‰“å°å°±ç®—äº†ï¼Œä½ çš„<code>data</code>å’Œ<code>data2</code>ç«Ÿç„¶éƒ½è¿˜æ˜¯<code>undefined</code>ï¼Ÿè¿™å°±æœ‰ç‚¹éš¾ä»¥ç†è§£äº†ã€‚</p> <p>éš¾é“è¯´æ˜¯æˆ‘çš„è°ƒç”¨å§¿åŠ¿ä¸å¯¹å—...</p> <p>æœ¬ç€è‰¯å¥½çš„èŒä¸šç´ å…»ï¼Œæˆ‘å¯¹<code>Generator</code>ç ”ç©¶äº†ä¸€æ³¢ï¼Œç„¶åä¿®æ”¹äº†ä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼š</p> <p><em>æ¡ˆä¾‹äºŒï¼š</em></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">getData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">testG</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data: '</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> data2 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data2: '</span><span class="token punctuation">,</span> data2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token string">'success'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> gen <span class="token operator">=</span> <span class="token function">testG</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// æ‰‹åŠ¨è°ƒç”¨3æ¬¡ä¸”æŠŠæ¯æ¬¡çš„è¿”å›å€¼æ‰“å°å‡ºæ¥çœ‹çœ‹</span>
<span class="token keyword">var</span> dataPromise<span class="token operator">=</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataPromise<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> dataPromise2 <span class="token operator">=</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'è¿™ä¸ªå‚æ•°æ‰ä¼šè¢«èµ‹ç»™dataå˜é‡'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataPromise2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> dataPromise3 <span class="token operator">=</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'è¿™ä¸ªå‚æ•°æ‰ä¼šè¢«èµ‹ç»™data2å˜é‡'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataPromise3<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ä¸åŒä¹‹å¤„åœ¨äºæˆ‘æŠŠè°ƒç”¨ä¸‰æ¬¡çš„è¿”å›å€¼ç”¨äº†ä¸€ä¸ªå˜é‡æ¥ç››æ”¾ï¼Œå¹¶ä¸”åœ¨åé¢ä¸¤æ¬¡è°ƒç”¨<code>gen.next()</code>çš„æ—¶å€™ä¼ é€’äº†å‚æ•°è¿›å»ã€‚</p> <p>ç°åœ¨çš„è¾“å‡ºç»“æœä¸ºï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span><span class="token literal-property property">value</span><span class="token operator">:</span> Promise<span class="token punctuation">,</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span>
<span class="token string">'data:'</span><span class="token punctuation">,</span> <span class="token string">'è¿™ä¸ªå‚æ•°æ‰ä¼šè¢«èµ‹ç»™dataå˜é‡'</span>
<span class="token punctuation">{</span><span class="token literal-property property">value</span><span class="token operator">:</span> Promise<span class="token punctuation">,</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span>
<span class="token string">'data2:'</span><span class="token punctuation">,</span> <span class="token string">'è¿™ä¸ªå‚æ•°æ‰ä¼šè¢«èµ‹ç»™data2å˜é‡'</span>
<span class="token punctuation">{</span><span class="token literal-property property">value</span><span class="token operator">:</span> Promise<span class="token punctuation">,</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span>
</code></pre></div><p>What X 2...?</p> <p>å“ˆå“ˆå“ˆï¼Œæ˜¯ä¸æ˜¯æœ‰ç‚¹æ‘¸ä¸ç€å¤´è„‘äº†ï¼Œè¿™<code>data</code>å’Œ<code>data2</code>çš„è¿”å›å€¼éš¾é“ä¸æ˜¯<code>yield getData()</code>çš„ç»“æœå—ï¼Ÿ</p> <p>æˆ‘è¿™é‡Œçš„ä»£ç æ˜æ˜å°±æ˜¯<code>const data = yield getData()</code>å‘€ï¼Œå¯æ˜¯æ€ä¹ˆä¼šå˜æˆäº†<code>'è¿™ä¸ªå‚æ•°æ‰ä¼šè¢«èµ‹ç»™dataå˜é‡'</code>å‘¢ï¼Ÿ</p> <p>åŸæ¥æœ‰äº›çš„ä½ ä»¥ä¸ºå¹¶ä¸æ˜¯çœŸçš„ä½ ä»¥ä¸ºï¼Œè¿™é‡Œè¯¦ç»†æŠŠæ¯ä¸€æ­¥éƒ½åˆ†æä¸€ä¸‹ï¼š</p> <p><img src="https://s.poetries.top/gitee/2020/09/122.png" alt=""></p> <p>OKğŸ‘Œï¼Œç›¸ä¿¡èªæ˜çš„ä½ ç°åœ¨ä¸€å®šå¼„æ‡‚<code>Generator</code>çš„æ‰§è¡Œæœºåˆ¶äº†ï¼Œå®ƒå’Œæˆ‘ä»¬çš„<code>async</code>å‡½æ•°æ˜¯æœ‰ä¸€äº›åŒºåˆ«çš„ã€‚</p> <p>åœ¨<code>async</code>å‡½æ•°ä¸­ï¼Œ<code>const data = await getData()</code>ï¼Œè¿™ä¸ª<code>data</code>æ˜¯<code>getData()</code>ä¸­<code>resolve()</code>çš„ç»“æœã€‚</p> <p>è€Œ<code>generator</code>å‡½æ•°ä¸­ï¼Œ<code>const data = yield getData()</code>ï¼Œå…¶å®åªæ‰§è¡Œäº†<code>yield getData()</code>å‡½æ•°è€Œå·²å¹¶ä¸”ä¼šæŠŠè¿™ä¸ªå€¼ä½œä¸ºç¬¬ä¸€æ¬¡è°ƒç”¨<code>gen.next()</code>çš„è¿”å›å€¼ï¼Œä¹Ÿå°±æ˜¯è¢«<code>dataPromise</code>æ‰€æ¥æ”¶ã€‚</p> <p><code>data</code>éœ€è¦ç­‰åˆ°ä¸‹ä¸€æ¬¡è°ƒç”¨<code>gen.next()</code>æ—¶æ‰ä¼šè¢«èµ‹å€¼ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨æ¡ˆä¾‹ä¸€ä¸­<code>data</code>ä¼šæ˜¯<code>undefined</code>ï¼Œå› ä¸ºé‚£æ—¶å€™æˆ‘ä»¬è°ƒç”¨<code>gen.next()</code>æ˜¯æ²¡æœ‰ä¼ é€’ä»»ä½•å‚æ•°çš„ã€‚</p> <h3 id="generatoræ¡ˆä¾‹è½¬æ¢asyncæ¡ˆä¾‹"><a href="#generatoræ¡ˆä¾‹è½¬æ¢asyncæ¡ˆä¾‹" class="header-anchor">#</a> Generatoræ¡ˆä¾‹è½¬æ¢asyncæ¡ˆä¾‹</h3> <p>æ˜¾ç„¶ï¼Œä¸Šé¢ğŸ‘†ä¸¤ä¸ªæ¡ˆä¾‹çš„æ‰§è¡Œç»“æœå’Œ<code>async</code>æ¡ˆä¾‹ä¸­çš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„ï¼Œæˆ‘åªæ˜¯å°†å…¶åšäº†ä¸€äº›æ‹†åˆ†ä»¥ä¾¿è®©ä½ æ›´å¥½çš„ç†è§£æ¥ä¸‹æ¥æˆ‘è¦åšçš„äº‹æƒ…ã€‚</p> <p>å˜»å˜»ğŸ˜ï¼Œé‚£ä¹ˆå¦‚ä½•è®©æ¡ˆä¾‹äºŒèƒ½æ‰“å°å‡ºå’Œ<code>async</code>æ¡ˆä¾‹ä¸€æ ·çš„ç»“æœå‘¢ï¼Ÿ</p> <p>ç»†å¿ƒçš„å°ä¼™ä¼´å¯èƒ½å·²ç»æœ‰äº†ä¸€äº›æƒ³æ³•ï¼Œ<code>dataPromise</code>ä¸­ä¼šæœ‰è°ƒç”¨è¿”å›çš„<code>Promise</code>å¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå°±èƒ½æ‹¿åˆ°è¿™ä¸ª<code>Promise</code>çš„è¿”å›å€¼<code>'data'</code>äº†ï¼Œåªéœ€è¦ä½¿ç”¨<code>.then()</code>æ¥è¿›è¡Œä¸€ä¸ªé“¾å¼è°ƒç”¨ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">getData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">testG</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data: '</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> data2 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data2: '</span><span class="token punctuation">,</span> data2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token string">'success'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> gen <span class="token operator">=</span> <span class="token function">testG</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> dataPromise <span class="token operator">=</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dataPromise<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value1</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> dataPromise2 <span class="token operator">=</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>value1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  dataPromise2<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> dataPromise3 <span class="token operator">=</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>value2<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataPromise3<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>ç°åœ¨çš„ç»“æœå°±æ˜¯å’Œ<code>async</code>æ¡ˆä¾‹çš„ç»“æœä¸€æ ·å’¯ï¼š</p> <p>ï¼ˆå¦‚æœä½ å¯¹è¿™é“é¢˜çš„ç»“æœè¿˜æ˜¯æ¯”è¾ƒæ¨¡ç³Šçš„è¯è¯·å†ä»”ç»†çœ‹ä¸€ä¸‹æˆ‘åœ¨æ¡ˆä¾‹äºŒçš„é‚£ä¸€å¤§å¨ä»£ç æ³¨é‡Šå“¦ï¼‰</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 1s åæ‰“å°å‡º</span>
<span class="token string">'data '</span> <span class="token string">'data'</span>
<span class="token comment">// 1s åæ‰“å°å‡º</span>
<span class="token string">'data2: '</span> <span class="token string">'data'</span>
<span class="token string">'success'</span>
</code></pre></div><p>ï¼ˆæ³¨æ„âš ï¸ï¼Œåœ¨æ¯æ¬¡è°ƒç”¨<code>gen.next()</code>çš„æ—¶å€™ï¼Œå®ƒçš„è¿”å›å€¼æ˜¯ä¸€ä¸ª<code>{ value: {}, done: false }</code>è¿™æ ·çš„å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è¦ä½¿ç”¨è¿”å›çš„<code>Promise</code>çš„æ—¶å€™ï¼Œéœ€è¦ç”¨<code>dataPromise.value</code>æ¥è·å–ï¼‰</p> <h3 id="throw"><a href="#throw" class="header-anchor">#</a> throw()</h3> <p>åœ¨æ­£å¼è®²è§£ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å†æ¥è®¤è¯†ä¸€ä¸‹<code>Generator</code>çš„å¦ä¸€ä¸ªå®ä¾‹æ–¹æ³•<code>throw()</code>ï¼Œä¹‹æ‰€ä»¥è¯´åˆ°å®ƒï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬æœ€ç»ˆçš„ä»£ç éœ€è¦ç”¨åˆ°å®ƒã€‚</p> <p>å®ƒå’Œ<code>next()</code>ä¸€æ ·ï¼Œéƒ½æ˜¯å±äº<code>Generator.prototype</code>ä¸Šçš„æ–¹æ³•ï¼Œä¸”è¿”å›å€¼ä¹Ÿæ˜¯å’Œ<code>next()</code>ä¸€æ ·ã€‚</p> <p>è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„æ¡ˆä¾‹äº†è§£ä¸€ä¸‹å®ƒæ˜¯æ€æ ·ä½¿ç”¨çš„å“ˆï¼š</p> <p>(åˆ©ç”¨<code>while(true){}</code>å¾ªç¯ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå¯ä»¥æ— é™è°ƒç”¨çš„<code>Generator</code>å‡½æ•°)</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">gen</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">yield</span> <span class="token string">'LinDaiDai'</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> g <span class="token operator">=</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: 'LinDaiDai', done: false }</span>
g<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { value: 'LinDaiDai', done: false }</span>
g<span class="token punctuation">.</span><span class="token function">throw</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'é”™è¯¯'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error: 'é”™è¯¯'</span>
</code></pre></div><p>è€Œä¸”ä½ ä¼šå‘ç°ï¼Œå¹¶ä¸æ˜¯<code>throw</code>ä¸­ä¸€å®šè¦ä¼ ä¸€ä¸ª<code>new Error()</code>æ‰ä¼šè¢«é‡Œé¢çš„<code>catch</code>æ•è·ï¼Œä½ å°±ç®—æ˜¯ä¼ é€’ä¸€ä¸ªåˆ«çš„ç±»å‹çš„å€¼è¿›å»ï¼Œä¹Ÿä¼šï¼Œä¾‹å¦‚æˆ‘ç›´æ¥ä¼ é€’å­—ç¬¦ä¸²<code>'é”™è¯¯'</code>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>g<span class="token punctuation">.</span><span class="token function">throw</span><span class="token punctuation">(</span><span class="token string">'é”™è¯¯'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'é”™è¯¯'</span>
</code></pre></div><p>å®ƒä¹Ÿä¼šè¢«æ•è·ã€‚</p> <h3 id="generatorå®ç°async"><a href="#generatorå®ç°async" class="header-anchor">#</a> Generatorå®ç°async?</h3> <p>æˆ‘ä»¬åœ¨ææ‡‚äº†<code>Generator</code>çš„æ‰§è¡Œæœºåˆ¶ä¹‹åï¼Œå°±å¯ä»¥æ¥çœ‹çœ‹ï¼Œ<code>async</code>æ˜¯æ€æ ·ç”¨<code>Generator</code>æ¥å®ç°çš„äº†ã€‚</p> <p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç¡®å®šä¸€ä¸‹æˆ‘ä»¬è¦åšçš„äº‹æƒ…ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">getData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">testG</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// è¿™ä¸ªå°±æ˜¯ä¸Šé¢çš„é‚£ä¸ªæ¡ˆä¾‹</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data: '</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> data2 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data2: '</span><span class="token punctuation">,</span> data2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token string">'success'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// æˆ‘ä»¬éœ€è¦è®¾è®¡ä¸€ä¸ªè½¬æ¢å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">asyncToGenerator</span> <span class="token punctuation">(</span><span class="token parameter">genFunc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">var</span> test <span class="token operator">=</span> <span class="token function">asyncToGenerator</span><span class="token punctuation">(</span>testG<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>é‚£ä¹ˆå¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨çš„å…³é”®å°±æ˜¯åœ¨äºå®ç°ä¸€ä¸ª<code>asyncToGenerator</code>è½¬æ¢å‡½æ•°ï¼Œå®ƒæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p> <ul><li>æ¥æ”¶ä¸€ä¸ª<code>Generator</code>å‡½æ•°</li> <li>è¿”å›ä¸€ä¸ª<code>Promise</code></li></ul> <p>è€Œ<code>Generator</code>ä½ ä»¬ä¹Ÿçœ‹åˆ°äº†ï¼Œå®ƒæ˜¯å¾ˆæ‡’çš„ï¼Œéœ€è¦æˆ‘ä»¬æ¯è°ƒç”¨ä¸€æ¬¡<code>next()</code>å‡½æ•°å®ƒæ‰èµ°ä¸€æ­¥ï¼Œæ‰€ä»¥å¦‚ä½•è®©å®ƒè‡ªåŠ¨çš„æ‰§è¡Œæˆä¸ºäº†æˆ‘ä»¬éœ€è¦æ€è€ƒçš„ç‚¹ã€‚</p> <p>è¿™é‡Œä¹Ÿä¸å†å°æ°”äº†ï¼Œç›´æ¥ä¸Šæ™¨æ›¦è€å“¥çš„ä»£ç å†è¿›è¡Œè®²è§£å§ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">asyncToGenerator</span> <span class="token punctuation">(</span><span class="token parameter">genFunc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> gen <span class="token operator">=</span> <span class="token function">genFunc</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">function</span> <span class="token function">step</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> generatorResult<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          generatorResult <span class="token operator">=</span> gen<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> value<span class="token punctuation">,</span> done <span class="token punctuation">}</span> <span class="token operator">=</span> generatorResult<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">step</span><span class="token punctuation">(</span><span class="token string">"next"</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">step</span><span class="token punctuation">(</span><span class="token string">"throw"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token function">step</span><span class="token punctuation">(</span><span class="token string">"next"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> gen <span class="token operator">=</span> <span class="token function">asyncToGenerator</span><span class="token punctuation">(</span>testG<span class="token punctuation">)</span>
<span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>æ€ä¹ˆæ ·ï¼Ÿæ˜¯ä¸æ˜¯è§‰å¾—æ™¨æ›¦è€å“¥å¾ˆçŸ­å•Šï¼Œå‘¸ï¼Œå†™çš„å¾ˆç²¾ç®€å‘€ ğŸ˜„ã€‚</p> <p>å¦‚æœè§‰å¾—æœ‰ç‚¹åƒåŠ›çš„è¯æ²¡å…³ç³»ï¼Œä¼šå°†æ¯ä¸€æ­¥ä»”ç»†æ‹†åˆ†ç€è¯´ã€‚</p> <h4 id="_1-æ•´ä½“ç»“æ„"><a href="#_1-æ•´ä½“ç»“æ„" class="header-anchor">#</a> 1. æ•´ä½“ç»“æ„</h4> <p>è®©æˆ‘ä»¬æ¥è®¾æƒ³ä¸€ä¸‹<code>asyncToGenerator</code>çš„å¤§æ¦‚æ ·å­äº†ï¼Œå®ƒä¹Ÿè®¸æ˜¯é•¿è¿™æ ·çš„ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">asyncToGenerator</span> <span class="token punctuation">(</span><span class="token parameter">genFunc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¾ç…§è¦æ±‚ï¼Œæ¥æ”¶ä¸€ä¸ª<code>Generator</code>å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ª<code>Promise</code>ï¼Œä¸Šé¢è¿™ç§ç»“æ„æ˜¯å®Œå…¨æ»¡è¶³çš„ã€‚å¯æ˜¯å¦‚æœæ˜¯æƒ³è¦è¿”å›<code>Promise</code>çš„è¯ï¼Œä¸ºä»€ä¹ˆè¿˜è¦æŠŠå®ƒåŒ…åˆ°ä¸€ä¸ªå‡½æ•°é‡Œé¢å‘¢ï¼Œä¸åº”è¯¥æ˜¯è¿™æ ·å†™å—ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">asyncToGenerator</span> <span class="token punctuation">(</span><span class="token parameter">genFunc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å””...è¿™æ ·å†™å›ºç„¶ä¹Ÿå¯ä»¥ï¼Œä¸è¿‡åˆ«å¿˜äº†æˆ‘ä»¬çš„è°ƒç”¨æ–¹å¼ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> test <span class="token operator">=</span> <span class="token function">asyncToGenerator</span><span class="token punctuation">(</span>testG<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æˆ‘ä»¬ä¸€èˆ¬æ˜¯ä¼šæŠŠ<code>asyncToGenerator</code>çš„è¿”å›å€¼ç”¨ä¸€ä¸ªå˜é‡æ¥ç››æ”¾çš„ï¼Œæ‰€ä»¥å¦‚æœä½ ä¸åŒ…åˆ°å‡½æ•°é‡Œçš„è¯ï¼Œå°±åªèƒ½è¿™æ ·è°ƒç”¨äº†ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">asyncToGenerator</span><span class="token punctuation">(</span>testG<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>è¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚</p> <h4 id="_2-å¦‚ä½•ä¿è¯è‡ªåŠ¨è°ƒç”¨"><a href="#_2-å¦‚ä½•ä¿è¯è‡ªåŠ¨è°ƒç”¨" class="header-anchor">#</a> 2. å¦‚ä½•ä¿è¯è‡ªåŠ¨è°ƒç”¨</h4> <p>æœ‰äº†<code>asyncToGenerator</code>å‡½æ•°çš„æ•´ä½“ç»“æ„ä¹‹åæˆ‘ä»¬å°±è¦å¼€å§‹è€ƒè™‘å¦‚ä½•è®©å®ƒè‡ªåŠ¨è°ƒç”¨è¿™ä¸€ä¸ªä¸ªçš„<code>next()</code>å‘¢ï¼Ÿ</p> <p>å’¦ï½ä½ æ˜¯ä¸æ˜¯æƒ³åˆ°äº†ä»€ä¹ˆï¼Ÿ</p> <p>é€’å½’ï¼Ÿ</p> <p>å˜»å˜»ğŸ˜ï¼Œç¡®å®åƒè¿™ç§éœ€è¦å¾ªç¯è°ƒç”¨çš„æ—¶å€™ç¡®å®å®¹æ˜“è®©äººæƒ³åˆ°é€’å½’ï¼Œè¿™é‡Œå…¶å®ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p> <p>æ‰€ä»¥ç°åœ¨æˆ‘ä»¬å°±å¾—å…ˆç¡®å®šé€’å½’çš„ç»ˆæ­¢æ¡ä»¶æ˜¯ä»€ä¹ˆã€‚</p> <p>åœ¨<code>Generator</code>å‡½æ•°ä¸­ï¼Œä»€ä¹ˆæƒ…å†µæ‰ç®—æ˜¯è¯¥å¯¹è±¡çš„é€»è¾‘ä»£ç æ‰§è¡Œå®Œäº†å‘¢ï¼Ÿè¿™ä¸ªå…¶å®å‰é¢ä¹Ÿå·²ç»æåˆ°äº†ï¼Œå½“<code>è¿”å›çš„doneå±æ€§ä¸ºtrue</code>æ—¶å°±å¯ä»¥ç¡®å®šå·²ç»æ‰§è¡Œå®Œäº†ï¼Œé€’å½’ä¹Ÿè¯¥ç»“æŸäº†ã€‚</p> <p>çŸ¥é“äº†ç»ˆæ­¢çš„æ¡ä»¶ä¹‹åï¼Œæˆ‘ä»¬å°±éœ€è¦æŠŠæ•´ä¸ªé€’å½’ç»“æŸï¼Œç»“åˆä¸Šé¢ğŸ‘†æˆ‘ä»¬å·²ç»è®¾è®¡å¥½çš„æ•´ä½“ç»“æ„ï¼Œè¿™å…¶å®å¾ˆç®€å•ï¼Œç›´æ¥<code>return</code>ä¸€ä¸ª<code>resolve()</code>æˆ–è€…<code>reject()</code>å°±å¯ä»¥åšåˆ°ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">asyncToGenerator</span> <span class="token punctuation">(</span><span class="token parameter">genFunc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// ç»ˆæ­¢æ¡ä»¶æ»¡è¶³æ—¶,ç›´æ¥è°ƒç”¨reject()æ¥é€€å‡º, valueä¸ºæœ€ç»ˆçš„å€¼(åé¢ä¼šè¯´åˆ°)</span>
      <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// æˆ–è€… return reject(error);</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>OKğŸ‘Œï¼Œç»ˆæ­¢æ¡ä»¶å’Œæ€ä¹ˆç»ˆæ­¢éƒ½å·²ç»çŸ¥é“äº†ï¼Œè®©æˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹ã€‚</p> <p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ª<code>step</code>å‡½æ•°ï¼Œç„¶åé…åˆ<code>Promise.resolve()</code>æ¥å®ç°å¾ªç¯è°ƒç”¨ï¼Œç±»ä¼¼äºè¿™æ ·ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">asyncToGenerator</span> <span class="token punctuation">(</span><span class="token parameter">genFunc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">function</span> <span class="token function">step</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ‰€ä»¥è¿™æ—¶å€™æˆ‘ä»¬å°±å¾—çœ‹çœ‹<code>Promise.resolve(value)</code>ä¸­çš„<code>value</code>æ˜¯å“ªæ¥çš„äº†ï¼Œå®ƒå®é™…ä¸Šæ˜¯æˆ‘ä»¬åœ¨æ¯æ¬¡è°ƒç”¨<code>gen.next()</code>è¿”å›å€¼ä¸­çš„<code>value</code>ï¼Œå¯¹åº”ç€æ¡ˆä¾‹äºŒçš„ä»£ç ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">yield</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// ä¹Ÿå°±æ˜¯ getData()çš„è¿”å›å€¼</span>
<span class="token comment">// ä¹Ÿå°±æ˜¯ Promise{&lt;resolve&gt;, 'data'}</span>
</code></pre></div><p>æ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬çš„ä»£ç å°±å˜æˆäº†è¿™æ ·ï¼š</p> <div class="language-diff extra-class"><pre class="language-diff"><code>function asyncToGenerator (genFunc) {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return function () {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     const gen = genFunc.apply(this, arguments);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     return new Promise((resolve, reject) =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">     function step () {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       let generatorResult = gen.next();
</span><span class="token prefix inserted">+</span><span class="token line">       const { value, done } = generatorResult;
</span><span class="token prefix inserted">+</span><span class="token line">       if (done) {
</span><span class="token prefix inserted">+</span><span class="token line">          return resolve(value);
</span><span class="token prefix inserted">+</span><span class="token line">       } else {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         return Promise.resolve(value).then(val =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">            step()
</span><span class="token prefix unchanged"> </span><span class="token line">          })
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">      }
</span><span class="token prefix unchanged"> </span><span class="token line">     step();
</span><span class="token prefix unchanged"> </span><span class="token line">   })
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
</code></pre></div><p>è¿™æ®µä»£ç æˆ‘åŠ ä¸Šäº†ä¸¤ä¸ªåŠŸèƒ½ï¼š</p> <ol><li><code>const gen = getFunc.apply(this, arguments)</code>æ¥å®ç°ç±»ä¼¼<code>const gen = testG()</code>è¿™æ ·çš„ä»£ç ï¼Œæ˜¯ä¸ºäº†å…ˆè°ƒç”¨<code>generator</code>å‡½æ•°æ¥ç”Ÿæˆè¿­ä»£å™¨ã€‚</li> <li>åœ¨<code>setp</code>ä¸­è°ƒç”¨äº†<code>gen.next()</code>ï¼Œå¹¶ä¿å­˜ç»“æœåˆ°<code>generatorResult</code>ä¸Šï¼ŒåŒæ—¶åˆ¤æ–­ç»ˆæ­¢æ¡ä»¶<code>done</code>ã€‚</li></ol> <h4 id="_3-ä¼ å€¼ä»¥åŠå¼‚å¸¸å¤„ç†"><a href="#_3-ä¼ å€¼ä»¥åŠå¼‚å¸¸å¤„ç†" class="header-anchor">#</a> 3. ä¼ å€¼ä»¥åŠå¼‚å¸¸å¤„ç†</h4> <p>OKğŸ‘Œï¼Œå®Œæˆäº†ä¸Šè¿°æ­¥éª¤åï¼Œæ˜¾ç„¶è¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬è‡³å°‘è¿˜æœ‰ä¸¤ç‚¹æ²¡æœ‰è€ƒè™‘åˆ°ï¼š</p> <ul><li>æ²¡æœ‰æŠŠè°ƒç”¨<code>gen.next()</code>çš„ç»“æœä¼ é€’ç»™åé¢çš„<code>gen.next()</code></li> <li>æ²¡æœ‰å¯¹å¼‚å¸¸æƒ…å†µä½œå¤„ç†</li></ul> <p>é¦–å…ˆï¼Œå‰é¢ä¹Ÿæåˆ°äº†ï¼Œ<code>next()</code>å’Œ<code>throw()</code>è°ƒç”¨æ—¶çš„è¿”å›å€¼éƒ½æ˜¯è¿™æ ·çš„æ ¼å¼ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
</code></pre></div><p>é‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å°±å¯ä»¥æŠŠè¿™ä¸¤ä¸ªæ–¹æ³•åå½“æˆä¸€ä¸ªå‚æ•°ä¼ é€’åˆ°ä¸‹ä¸€ä¸ª<code>step</code>ä¸­å‘¢ï¼Ÿ</p> <p>è€Œæ¯æ¬¡<code>Promise.resolve(value)</code>è¿™é‡Œçš„ç»“æœæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠå®ƒå½“æˆå‚æ•°ä¼ é€’åˆ°ä¸‹ä¸€ä¸ª<code>step</code>ä¸­ã€‚</p> <p>æ‰€ä»¥ç°åœ¨å†è®©æˆ‘ä»¬æ¥çœ‹çœ‹æœ€ç»ˆçš„ä»£ç ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">asyncToGenerator</span> <span class="token punctuation">(</span><span class="token parameter">genFunc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> gen <span class="token operator">=</span> <span class="token function">genFunc</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">function</span> <span class="token function">step</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> generatorResult<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          generatorResult <span class="token operator">=</span> gen<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> value<span class="token punctuation">,</span> done <span class="token punctuation">}</span> <span class="token operator">=</span> generatorResult<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">step</span><span class="token punctuation">(</span><span class="token string">"next"</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">step</span><span class="token punctuation">(</span><span class="token string">"throw"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token function">step</span><span class="token punctuation">(</span><span class="token string">"next"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> gen <span class="token operator">=</span> <span class="token function">asyncToGenerator</span><span class="token punctuation">(</span>testG<span class="token punctuation">)</span>
<span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>æ–°åŠ çš„ä»£ç ä¸»è¦åšäº†è¿™ä¹ˆå‡ ä»¶äº‹ï¼š</p> <ol><li><code>step</code>å‡½æ•°å¢åŠ ä¸¤ä¸ªå­—æ®µï¼š<code>key</code>ä¸ºæ–¹æ³•å(<code>next</code>æˆ–è€…<code>throw</code>)ï¼›<code>arg</code>ä¸ºä¸Šä¸€æ¬¡<code>gen[key]()</code>çš„</li> <li>ä½¿ç”¨<code>try/catch</code>æ¥æ•è·æ‰§è¡Œ<code>gen[key](arg)</code>æ—¶çš„å¼‚å¸¸</li> <li><code>.then()</code>ä¸­å¢åŠ ç¬¬äºŒä¸ªå‚æ•°æ¥æ•è·å¼‚å¸¸</li></ol> <p>è¿™é‡Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œ<code>Promise.resolve(value)</code>ä¸­çš„<code>value</code>å®ƒæ˜¯ä¸€ä¸ª<code>Promise</code>ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p> <p>è®©æˆ‘ä»¬æ¥çœ‹çœ‹<code>generatorResult</code>ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> Promise<span class="token punctuation">{</span><span class="token operator">&lt;</span>resolve<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token string">'data'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
</code></pre></div><p>å¯¹åº”ç€æ¡ˆä¾‹äºŒï¼Œå…¶å®ä¹Ÿå°±æ˜¯<code>yield getData()</code>è¿™æ®µè¯­å¥ä¸­<code>getData()</code>è¿”å›çš„é‚£ä¸ª<code>Promise</code>ã€‚</p> <p>è€Œä¸‹ä¸€ä¸ª<code>step("next")</code>å¿…é¡»ç­‰<code>value</code>è¿™ä¸ª<code>Promise</code>è¢«<code>resolve</code>çš„æ—¶å€™æ‰ä¼šè¢«è°ƒç”¨ã€‚</p></div> <!----> <div class="readMore-wrapper"><span class="readMore">é˜…è¯»å…¨æ–‡</span></div>
                    </div>
                            <p>è¿™æ˜¯ä¸€ä¸ªä¿¡æ¯æç¤ºæ¡†ã€‚</p>
                        </div>

                        <div class="note warning">
                            <div class="note-title"><i class="fas fa-exclamation-triangle"></i> æ³¨æ„</div>
                            <p>è¿™æ˜¯ä¸€ä¸ªè­¦å‘Šæç¤ºæ¡†ã€‚</p>
                        </div>

                        <div class="note success">
                            <div class="note-title"><i class="fas fa-check-circle"></i> æˆåŠŸ</div>
                            <p>è¿™æ˜¯ä¸€ä¸ªæˆåŠŸæç¤ºæ¡†ã€‚</p>
                        </div>

                        <h2>ä»£ç ç¤ºä¾‹</h2>
                        <pre><code class="language-javascript">// ç¤ºä¾‹ä»£ç 
function example() {
    console.log('Hello, FrontendHub!');
}
</code></pre>
                    </div>

                    <!-- æ–‡ç« åº•éƒ¨å¯¼èˆª -->
                    <nav class="article-nav">
                        <a href="#" class="prev-article">
                            <i class="fas fa-chevron-left"></i>
                            <span>ä¸Šä¸€ç¯‡</span>
                        </a>
                        <a href="#" class="next-article">
                            <span>ä¸‹ä¸€ç¯‡</span>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </nav>
                </article>
            </div>
        </div>
    </main>

    <!-- é¡µè„š -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4><i class="fas fa-code"></i> FrontendHub</h4>
                    <p>ä¸“æ³¨äºå‰ç«¯æŠ€æœ¯å­¦ä¹ ä¸é¢è¯•å‡†å¤‡</p>
                </div>
                <div class="footer-section">
                    <h4>å¿«é€Ÿé“¾æ¥</h4>
                    <ul>
                        <li><a href="../../index.html">é¦–é¡µ</a></li>
                        <li><a href="../index.html#courses">è¯¾ç¨‹ä½“ç³»</a></li>
                        <li><a href="../index.html#resources">å­¦ä¹ èµ„æº</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 FrontendHub. ç”¨äºä¸ªäººå­¦ä¹ ä½¿ç”¨.</p>
            </div>
        </div>
    </footer>

    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script src="../../js/main.js"></script>
    <script src="../../js/content.js"></script>
</body>
</html>

