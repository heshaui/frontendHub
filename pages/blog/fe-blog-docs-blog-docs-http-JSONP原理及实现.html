<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="referrer" content="no-referrer">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSONPåŸç†åŠå®ç° - FrontendHub</title>
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="../../css/content.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="content-page">
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <a href="../../index.html" style="color: inherit; text-decoration: none; display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-code"></i>
                    <span>FrontendHub</span>
                </a>
            </div>
            <button class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-menu" id="navMenu">
                <li><a href="../../index.html">é¦–é¡µ</a></li>
                <li><a href="../index.html#features">ç‰¹è‰²</a></li>
                <li><a href="../index.html#courses">è¯¾ç¨‹</a></li>
                <li><a href="../index.html#resources">èµ„æº</a></li>
            </ul>
        </div>
    </nav>

    <!-- é¢åŒ…å±‘å¯¼èˆª -->
    <div class="breadcrumb">
        <div class="container">
            <a href="../../index.html"><i class="fas fa-home"></i> é¦–é¡µ</a>
            <i class="fas fa-chevron-right"></i>
            <span>JSONPåŸç†åŠå®ç°</span>
        </div>
    </div>

    <!-- ä¸»è¦å†…å®¹åŒº -->
    <main class="content-main">
        <div class="container">
            <div class="content-layout">
                <!-- ä¾§è¾¹æ ç›®å½• -->
                <aside class="sidebar">
                    <div class="sidebar-sticky">
                        <h3><i class="fas fa-list"></i> ç›®å½•</h3>
                        <nav class="toc" id="toc">
                            <!-- ç›®å½•å°†é€šè¿‡JavaScriptè‡ªåŠ¨ç”Ÿæˆ -->
                        </nav>
                    </div>
                </aside>

                <!-- æ–‡ç« å†…å®¹ -->
                <article class="article">
                    <header class="article-header">
                        <h1>JSONPåŸç†åŠå®ç°</h1>
                        <div class="article-meta">
                            <span><i class="far fa-calendar"></i> æ›´æ–°æ—¶é—´ï¼š2025-12-23</span>
                            <span><i class="far fa-clock"></i> é˜…è¯»æ—¶é•¿ï¼šçº¦ 15 åˆ†é’Ÿ</span>
                        </div>
                    </header>

                    <div class="article-content">
<div class="content__default"><h2 id="jsonpåŸç†åŠå®ç°"><a href="#jsonpåŸç†åŠå®ç°" class="header-anchor">#</a> JSONPåŸç†åŠå®ç°</h2> <h3 id="åŸºæœ¬åŸç†"><a href="#åŸºæœ¬åŸç†" class="header-anchor">#</a> åŸºæœ¬åŸç†</h3> <p>åŸºæœ¬åŸç†ï¼š ä¸»è¦å°±æ˜¯åˆ©ç”¨äº† <code>script</code> æ ‡ç­¾çš„<code>src</code>æ²¡æœ‰è·¨åŸŸé™åˆ¶æ¥å®Œæˆçš„ã€‚</p> <h3 id="æ‰§è¡Œè¿‡ç¨‹"><a href="#æ‰§è¡Œè¿‡ç¨‹" class="header-anchor">#</a> æ‰§è¡Œè¿‡ç¨‹</h3> <p>æ‰§è¡Œè¿‡ç¨‹ï¼š</p> <ul><li>å‰ç«¯å®šä¹‰ä¸€ä¸ªè§£æå‡½æ•°(å¦‚: <code>jsonpCallback = function (res) {}</code>)</li> <li>é€šè¿‡<code>params</code>çš„å½¢å¼åŒ…è£…<code>script</code>æ ‡ç­¾çš„è¯·æ±‚å‚æ•°ï¼Œå¹¶ä¸”å£°æ˜æ‰§è¡Œå‡½æ•°(å¦‚<code>cb=jsonpCallback</code>)</li> <li>åç«¯è·å–åˆ°å‰ç«¯å£°æ˜çš„æ‰§è¡Œå‡½æ•°(<code>jsonpCallback</code>)ï¼Œå¹¶ä»¥å¸¦ä¸Šå‚æ•°ä¸”è°ƒç”¨æ‰§è¡Œå‡½æ•°çš„æ–¹å¼ä¼ é€’ç»™å‰ç«¯</li> <li>å‰ç«¯åœ¨<code>script</code>æ ‡ç­¾è¿”å›èµ„æºçš„æ—¶å€™å°±ä¼šå»æ‰§è¡Œ<code>jsonpCallback</code>å¹¶é€šè¿‡å›è°ƒå‡½æ•°çš„æ–¹å¼æ‹¿åˆ°æ•°æ®äº†ã€‚</li></ul> <h3 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="header-anchor">#</a> ä¼˜ç¼ºç‚¹</h3> <p>ç¼ºç‚¹ï¼š</p> <ul><li>åªèƒ½è¿›è¡Œ<code>GET</code>è¯·æ±‚</li></ul> <p>ä¼˜ç‚¹ï¼š</p> <ul><li>å…¼å®¹æ€§å¥½ï¼Œåœ¨ä¸€äº›å¤è€çš„æµè§ˆå™¨ä¸­éƒ½å¯ä»¥è¿è¡Œ</li></ul> <h3 id="æ¡ˆä¾‹åˆ†æ"><a href="#æ¡ˆä¾‹åˆ†æ" class="header-anchor">#</a> æ¡ˆä¾‹åˆ†æ</h3> <p>å…ˆæ¥çœ‹çœ‹æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªä»€ä¹ˆæ•ˆæœï¼š</p> <p>åœ¨ä¸€ä¸ªå«<code>index.html</code>çš„æ–‡ä»¶ä¸­æœ‰ä»¥ä¸‹ä»£ç ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>text/javascript<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    window<span class="token punctuation">.</span><span class="token function-variable function">jsonpCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>http://localhost:8080/api/jsonp?id=1&amp;cb=jsonpCallback<span class="token punctuation">'</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>text/javascript<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ç„¶åæˆ‘æœ¬åœ°æœ‰ä¸€ä¸ªæ–‡ä»¶<code>server.js</code>å®ƒä¼šä½¿ç”¨<code>node</code>æä¾›ä¸€ä¸ªæœåŠ¡ï¼Œæ¥æ¨¡æ‹ŸæœåŠ¡å™¨ã€‚</p> <p>å¹¶ä¸”å®šä¹‰ä¸€ä¸ªæ¥å£<code>/api/jsonp</code>æ¥æŸ¥è¯¢<code>id</code>å¯¹åº”çš„æ•°æ®ã€‚</p> <p>å½“æˆ‘æ‰“å¼€<code>index.html</code>çš„æ—¶å€™å°±ä¼šåŠ è½½<code>script</code>æ ‡ç­¾ï¼Œå¹¶æ‰§è¡Œäº†æ­¤æ¬¡è·¨åŸŸè¯·æ±‚ã€‚</p> <h4 id="å‰æœŸå‡†å¤‡"><a href="#å‰æœŸå‡†å¤‡" class="header-anchor">#</a> å‰æœŸå‡†å¤‡</h4> <ul><li>æˆ‘åœ¨æœ¬åœ°æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹<code>node-cors</code></li> <li>å¹¶åœ¨æ­¤ç›®å½•ä¸‹<code>npm init</code>ï¼Œåˆå§‹åŒ–<code>package.json</code></li> <li>å®‰è£…<code>koa</code>(<code>node</code>çš„ä¸€ä¸ªè½»é‡çº§æ¡†æ¶)</li> <li>æ–°å»ºæ–‡ä»¶å¤¹<code>jsonp</code>ï¼Œå¹¶æ–°å»º<code>index.html</code>å’Œ<code>server.js</code>ï¼Œä¸€ä¸ªå†™å‰ç«¯ä»£ç ï¼Œä¸€ä¸ªå†™åç«¯</li></ul> <div class="language- extra-class"><pre class="language-text"><code>mkdir node-cors &amp;&amp; cd node-cors
npm init
cnpm i --save-dev koa
mkdir jsonp &amp;&amp; cd jsonp
touch index.html
touch server.js
</code></pre></div><h4 id="åç«¯ä»£ç "><a href="#åç«¯ä»£ç " class="header-anchor">#</a> åç«¯ä»£ç </h4> <p>ç”±äº<code>JSONP</code>çš„å®ç°éœ€è¦å‰åç«¯é…åˆï¼Œå…ˆæ¥å†™ä¸€ä¸‹åç«¯çš„å®ç°ï¼š</p> <p>ï¼ˆçœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œä¸‹é¢çš„<strong>å‰ç«¯ç®€å•å®ç°</strong>ä¼šåšè§£é‡Šï¼‰</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'title1'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'title2'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">'/api/jsonp'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> cb<span class="token punctuation">,</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
    <span class="token keyword">const</span> title <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>id <span class="token operator">==</span> id<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cb<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'listen 8080...'</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å†™å®Œä¹‹åï¼Œä¿å­˜ã€‚</p> <p>å¹¶åœ¨<code>jsonp</code>è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>node server.js
</code></pre></div><p>æ¥å¯åŠ¨æœåŠ¡ï¼Œå¯ä»¥çœ‹åˆ°ç¼–è¾‘å™¨çš„æ§åˆ¶å°ä¸­ä¼šæ‰“å°å‡º<code>"listen 8080..."</code></p> <h4 id="å‰ç«¯ç®€å•å®ç°"><a href="#å‰ç«¯ç®€å•å®ç°" class="header-anchor">#</a> å‰ç«¯ç®€å•å®ç°</h4> <p>OKğŸ‘Œï¼Œåç«¯å·²ç»å®ç°äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹å‰ç«¯æœ€ç®€å•çš„ä¸€ç§å®ç°æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯å†™æ­»ä¸€ä¸ª<code>script</code>å¹¶å‘é€è¯·æ±‚ï¼š</p> <p><code>index.html</code>ä¸­ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>text/javascript<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    window<span class="token punctuation">.</span><span class="token function-variable function">jsonpCallback</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>http://localhost:8080/api/jsonp?id=1&amp;cb=jsonpCallback<span class="token punctuation">'</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>text/javascript<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>è¿™ä¸¤ä¸ª<code>script</code>çš„æ„æ€æ˜¯ï¼š</p> <ul><li>ç¬¬ä¸€ä¸ªï¼Œåˆ›å»ºä¸€ä¸ª<code>jsonpCallback</code>å‡½æ•°ã€‚ä½†æ˜¯å®ƒè¿˜æ²¡æœ‰è¢«è°ƒç”¨</li> <li>ç¬¬äºŒä¸ªï¼ŒåŠ è½½<code>src</code>ä¸­çš„èµ„æºï¼Œå¹¶ç­‰å¾…è¯·æ±‚çš„å†…å®¹è¿”å›</li></ul> <p>æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯ï¼š</p> <ol><li><p>å½“æ‰§è¡Œåˆ°ç¬¬äºŒä¸ª<code>script</code>çš„æ—¶å€™ï¼Œç”±äºè¯·æ±‚äº†æˆ‘ä»¬çš„<code>8080</code>ç«¯å£ï¼Œå¹¶ä¸”æŠŠ<code>id</code>å’Œ<code>cb</code>è¿™ä¸¤ä¸ªå‚æ•°æ”¾åˆ°<code>URL</code>é‡Œã€‚é‚£ä¹ˆåå°å°±å¯ä»¥æ‹¿åˆ°<code>URL</code>é‡Œçš„è¿™ä¸¤ä¸ªå‚æ•°ã€‚</p></li> <li><p>ä¹Ÿå°±æ˜¯åœ¨<strong>åç«¯ä»£ç </strong>ä¸­çš„<code>const { id, cb } = ctx.query</code>è¿™é‡Œè·å–åˆ°äº†ã€‚</p></li> <li><p>é‚£ä¹ˆåç«¯åœ¨æ‹¿åˆ°è¿™ä¸¤ä¸ªå‚æ•°ä¹‹åï¼Œå¯èƒ½å°±ä¼šæ ¹æ®<code>id</code>æ¥è¿›è¡Œä¸€äº›æŸ¥è¯¢ï¼Œå½“ç„¶ï¼Œæˆ‘è¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿçš„æŸ¥è¯¢ï¼Œç”¨äº†ä¸€ä¸ªç®€å•çš„<code>find</code>æ¥è¿›è¡Œä¸€ä¸ªæŸ¥æ‰¾ã€‚æŸ¥æ‰¾åˆ°<code>id</code>ä¸º<code>1</code>çš„é‚£é¡¹å¹¶ä¸”å–<code>title</code>ã€‚</p></li> <li><p>ç¬¬äºŒä¸ªå‚æ•°<code>cb</code>ï¼Œæ‹¿åˆ°çš„å°±æ˜¯<code>"jsonpCallback"</code>äº†ï¼Œè¿™é‡Œä¹Ÿå°±æ˜¯å‘Šè¯‰åç«¯ï¼Œå‰ç«¯é‚£é‡Œæ˜¯ä¼šæœ‰ä¸€ä¸ªå«åš<code>jsonpCallback</code>çš„å‡½æ•°æ¥æ¥æ”¶åç«¯æƒ³è¦è¿”å›çš„æ•°æ®ï¼Œè€Œåç«¯ä½ åªéœ€è¦åœ¨è¿”å›ä½“ä¸­å†™å…¥<code>jsonpCallback()</code>å°±å¯ä»¥äº†ã€‚</p></li> <li><p>å‰ç«¯åœ¨å¾—åˆ°äº†åç«¯è¿”å›çš„å†…å®¹<code>jsonpCallback({"title":"title1"})</code>ï¼Œå‘ç°é‡Œé¢æ˜¯ä¸€æ®µæ‰§è¡Œå‡½æ•°çš„è¯­å¥ï¼Œå› æ­¤å°±ä¼šå»æ‰§è¡Œç¬¬ä¸€ä¸ª<code>script</code>ä¸­çš„<code>jsonpCallback</code>æ–¹æ³•äº†ï¼Œå¹¶ä¸”åˆæ˜¯å¸¦äº†å‚æ•°çš„ï¼Œæ‰€ä»¥æ­¤æ—¶æµè§ˆå™¨æ§åˆ¶å°ä¼šæ‰“å°å‡º<code>{ title: 'title1' }</code></p></li></ol> <p>ä»¥æ­¤æ¥è¾¾åˆ°ä¸€ä¸ªç®€å•çš„è·¨åŸŸçš„æ•ˆæœã€‚</p> <p>å…¶å®ä½ æƒ³æƒ³ï¼Œå¦‚æœæˆ‘ä»¬æŠŠç¬¬äºŒä¸ª<code>script</code>æ ‡ç­¾æ¢æˆä»¥ä¸‹ä»£ç ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿèƒ½è¾¾åˆ°åŒæ ·çš„æ•ˆæœå‘¢ï¼Ÿ</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- &lt;script src='http://localhost:8080/api/jsonp?id=1&amp;cb=jsonpCallback' type='text/javascript'&gt;&lt;/script&gt; --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token function">jsonpCallback</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'title1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="jqueryä¸­ajaxå®ç°"><a href="#jqueryä¸­ajaxå®ç°" class="header-anchor">#</a> jQueryä¸­ajaxå®ç°</h4> <p>ä¸Šé¢ğŸ‘†æˆ‘ä»¬ä»‹ç»äº†ç”¨<code>script</code>æ ‡ç­¾æ¥å®ç°ï¼Œåœ¨<code>jQuery</code>çš„<code>$.ajax()</code>æ–¹æ³•å…¶å®ä¹Ÿæä¾›äº†<code>jsonp</code>ã€‚</p> <p>è®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.bootcss.com/jquery/3.5.0/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">"http://localhost:8080/api/jsonp"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">dataType</span><span class="token operator">:</span> <span class="token string">"jsonp"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"get"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">jsonp</span><span class="token operator">:</span> <span class="token string">"cb"</span><span class="token punctuation">,</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>åœ¨<code>success</code>å›è°ƒä¸­åŒæ ·å¯ä»¥æ‹¿åˆ°æ•°æ®ã€‚</p> <h3 id="å°è£…ä¸€ä¸ªjsonpæ–¹æ³•"><a href="#å°è£…ä¸€ä¸ªjsonpæ–¹æ³•" class="header-anchor">#</a> å°è£…ä¸€ä¸ªJSONPæ–¹æ³•</h3> <p>ï¼ˆæ­¤ç« ä¼šä¸€æ­¥ä¸€æ­¥æ•™ä½ å¦‚ä½•å°è£…ä¸€ä¸ªæ¯”è¾ƒå®Œç¾çš„<code>JSONP</code>æ–¹æ³•ï¼‰</p> <h4 id="ç®€æ˜“ç‰ˆ"><a href="#ç®€æ˜“ç‰ˆ" class="header-anchor">#</a> ç®€æ˜“ç‰ˆ</h4> <p>å…ˆçœ‹ä¸‹æˆ‘ä»¬è¦å®ç°çš„åŠŸèƒ½</p> <p>å®šä¹‰ä¸€ä¸ª<code>JSONP</code>æ–¹æ³•ï¼Œå®ƒæ¥æ”¶å››ä¸ªå‚æ•°ï¼š</p> <ul><li>url</li> <li>params</li> <li>callbackKeyï¼šä¸åå°çº¦å®šçš„å›è°ƒå‡½æ•°æ˜¯ç”¨å“ªä¸ªå­—æ®µ(å¦‚<code>cb</code>)</li> <li>callbackï¼šæ‹¿åˆ°æ•°æ®ä¹‹åæ‰§è¡Œçš„å›è°ƒå‡½æ•°</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">function</span> <span class="token constant">JSONP</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token punctuation">,</span>
        params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        callbackKey <span class="token operator">=</span> <span class="token string">'cb'</span><span class="token punctuation">,</span>
        callback
    <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å®šä¹‰æœ¬åœ°çš„ä¸€ä¸ªcallbackçš„åç§°</span>
        <span class="token keyword">const</span> callbackName <span class="token operator">=</span> <span class="token string">'jsonpCallback'</span><span class="token punctuation">;</span>
        <span class="token comment">// æŠŠè¿™ä¸ªåç§°åŠ å…¥åˆ°å‚æ•°ä¸­: 'cb=jsonpCallback'</span>
        params<span class="token punctuation">[</span>callbackKey<span class="token punctuation">]</span> <span class="token operator">=</span> callbackName<span class="token punctuation">;</span>
        <span class="token comment">//  æŠŠè¿™ä¸ªcallbackåŠ å…¥åˆ°windowå¯¹è±¡ä¸­ï¼Œè¿™æ ·å°±èƒ½æ‰§è¡Œè¿™ä¸ªå›è°ƒäº†</span>
        window<span class="token punctuation">[</span>callbackName<span class="token punctuation">]</span> <span class="token operator">=</span> callback<span class="token punctuation">;</span>

        <span class="token comment">// å¾—åˆ°'id=1&amp;cb=jsonpCallback'</span>
        <span class="token keyword">const</span> paramString <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span>
        <span class="token comment">// åˆ›å»º script æ ‡ç­¾</span>
        <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        script<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>paramString<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token constant">JSONP</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://localhost:8080/api/jsonp'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">callbackKey</span><span class="token operator">:</span> <span class="token string">'cb'</span><span class="token punctuation">,</span>
        <span class="token function">callback</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>è¿™æ ·å†™æ‰“å¼€é¡µé¢ä¹Ÿå¯æ˜¯å¯ä»¥çœ‹åˆ°æ•ˆæœçš„ã€‚</p> <h4 id="åŒæ—¶å¤šä¸ªè¯·æ±‚"><a href="#åŒæ—¶å¤šä¸ªè¯·æ±‚" class="header-anchor">#</a> åŒæ—¶å¤šä¸ªè¯·æ±‚</h4> <p>ä¸Šé¢æˆ‘ä»¬è™½ç„¶å®ç°äº†<code>JSONP</code>ï¼Œä½†æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯å¦‚æœæˆ‘åŒæ—¶å¤šæ¬¡è°ƒç”¨<code>JSONP</code>ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">JSONP</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://localhost:8080/api/jsonp'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">callbackKey</span><span class="token operator">:</span> <span class="token string">'cb'</span><span class="token punctuation">,</span>
    <span class="token function">callback</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token comment">// No.1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token constant">JSONP</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://localhost:8080/api/jsonp'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">callbackKey</span><span class="token operator">:</span> <span class="token string">'cb'</span><span class="token punctuation">,</span>
    <span class="token function">callback</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token comment">// No.2</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæˆ‘è°ƒç”¨äº†ä¸¤æ¬¡<code>JSONP</code>ï¼Œåªæ˜¯ä¼ é€’çš„å‚æ•°ä¸åŒã€‚ä½†æ˜¯å¹¶ä¸ä¼šæŒ‰æˆ‘ä»¬é¢„æœŸçš„åœ¨<code>No.1å’ŒNo.2</code>ä¸­åˆ†åˆ«æ‰“å°ï¼Œè€Œæ˜¯éƒ½ä¼šåœ¨<code>No.2</code>ä¸­æ‰“å°å‡ºç»“æœã€‚è¿™æ˜¯å› ä¸ºåé¢ä¸€ä¸ª<code>callback</code>æŠŠ<code>JSONP</code>é‡Œå°è£…çš„ç¬¬ä¸€ä¸ª<code>callback</code>ç»™è¦†ç›–äº†ï¼Œå®ƒä»¬éƒ½æ˜¯å…±ç”¨çš„åŒä¸€ä¸ª<code>callbackName</code>ï¼Œä¹Ÿå°±æ˜¯<code>jsonpCallback</code>ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p> <p><img src="https://s.poetries.top/uploads/2025/10/12d494702b6e562a.png" alt=""></p> <p>ä¸¤æ¬¡ç»“æœéƒ½æ˜¯ä»<code>76</code>è¡Œæ‰“å°å‡ºæ¥çš„ã€‚</p> <p>æ‰€ä»¥æˆ‘ä»¬å¾—æ”¹é€ ä¸€ä¸‹ä¸Šé¢çš„<code>JSONP</code>æ–¹æ³•ï¼š</p> <ul><li>è®©<code>callbackName</code>æ˜¯ä¸€ä¸ªå”¯ä¸€çš„ï¼Œå¯ä»¥ä½¿ç”¨é€’å¢</li> <li>ä¸è¦æŠŠå›è°ƒå®šä¹‰åœ¨<code>window</code>ä¸­è¿™æ ·ä¼šæ±¡æŸ“å…¨å±€å˜é‡ï¼Œå¯ä»¥æŠŠå®ƒæ‰”åˆ°<code>JSON.xxx</code>ä¸­</li></ul> <p>OKğŸ‘Œï¼Œæ¥çœ‹çœ‹æ”¹é€ ä¹‹åçš„ä»£ç ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">function</span> <span class="token constant">JSONP</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token punctuation">,</span>
        params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        callbackKey <span class="token operator">=</span> <span class="token string">'cb'</span><span class="token punctuation">,</span>
        callback
    <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å®šä¹‰æœ¬åœ°çš„å”¯ä¸€callbackIdï¼Œè‹¥æ˜¯æ²¡æœ‰çš„è¯åˆ™åˆå§‹åŒ–ä¸º1</span>
        <span class="token constant">JSONP</span><span class="token punctuation">.</span>callbackId <span class="token operator">=</span> <span class="token constant">JSONP</span><span class="token punctuation">.</span>callbackId <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> callbackId <span class="token operator">=</span> <span class="token constant">JSONP</span><span class="token punctuation">.</span>callbackId<span class="token punctuation">;</span>
        <span class="token comment">// æŠŠè¦æ‰§è¡Œçš„å›è°ƒåŠ å…¥åˆ°JSONå¯¹è±¡ä¸­ï¼Œé¿å…æ±¡æŸ“window</span>
        <span class="token constant">JSONP</span><span class="token punctuation">.</span>callbacks <span class="token operator">=</span> <span class="token constant">JSONP</span><span class="token punctuation">.</span>callbacks <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token constant">JSONP</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">[</span>callbackId<span class="token punctuation">]</span> <span class="token operator">=</span> callback<span class="token punctuation">;</span>
        <span class="token comment">// æŠŠè¿™ä¸ªåç§°åŠ å…¥åˆ°å‚æ•°ä¸­: 'cb=JSONP.callbacks[1]'</span>
        params<span class="token punctuation">[</span>callbackKey<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">JSONP.callbacks[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>callbackId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

        <span class="token comment">// å¾—åˆ°'id=1&amp;cb=JSONP.callbacks[1]'</span>
        <span class="token keyword">const</span> paramString <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>params<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span>
        <span class="token comment">// åˆ›å»º script æ ‡ç­¾</span>
        <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        script<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>paramString<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// idè‡ªå¢ï¼Œä¿è¯å”¯ä¸€</span>
        <span class="token constant">JSONP</span><span class="token punctuation">.</span>callbackId<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token constant">JSONP</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://localhost:8080/api/jsonp'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">callbackKey</span><span class="token operator">:</span> <span class="token string">'cb'</span><span class="token punctuation">,</span>
        <span class="token function">callback</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token constant">JSONP</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://localhost:8080/api/jsonp'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">callbackKey</span><span class="token operator">:</span> <span class="token string">'cb'</span><span class="token punctuation">,</span>
        <span class="token function">callback</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ç°åœ¨è°ƒç”¨äº†ä¸¤æ¬¡å›è°ƒï¼Œä½†æ˜¯ä¼šåˆ†åˆ«æ‰§è¡Œ<code>JSONP.callbacks[1]</code>å’Œ<code>JSONP.callbacks[2]</code>ï¼š</p> <p><img src="https://s.poetries.top/uploads/2025/10/671ea601f844b5c2.png" alt=""></p> <h4 id="æœ€ç»ˆç‰ˆjsonpæ–¹æ³•"><a href="#æœ€ç»ˆç‰ˆjsonpæ–¹æ³•" class="header-anchor">#</a> æœ€ç»ˆç‰ˆJSONPæ–¹æ³•</h4> <p>å…¶å®ä¸Šé¢å·²ç»ç®—æ¯”è¾ƒå®Œç¾äº†ï¼Œä½†æ˜¯è¿˜ä¼šæœ‰ä¸€ä¸ªå°é—®é¢˜ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ç§æƒ…å†µï¼š</p> <p>æˆ‘æ”¹ä¸€ä¸‹åç«¯çš„ä»£ç </p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'title1'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'title2'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">'/api/jsonp'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> cb<span class="token punctuation">,</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
    <span class="token keyword">const</span> title <span class="token operator">=</span> items<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>id <span class="token operator">==</span> id<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cb<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>title<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>path <span class="token operator">===</span> <span class="token string">'/api/jsonps'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> cb<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cb<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> a<span class="token punctuation">,</span> b <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'listen 8080...'</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¢åŠ äº†ä¸€ä¸ª<code>/api/jsonps</code>çš„æ¥å£ã€‚</p> <p>ç„¶åå‰ç«¯ä»£ç å¢åŠ äº†ä¸€ä¸ªè¿™æ ·çš„è¯·æ±‚ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">JSONP</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://localhost:8080/api/jsonps'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token string">'2&amp;b=3'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token string">'4'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">callbackKey</span><span class="token operator">:</span> <span class="token string">'cb'</span><span class="token punctuation">,</span>
    <span class="token function">callback</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œå‚æ•°çš„<code>a</code>ä¸­ä¹Ÿä¼šæœ‰<code>b</code>è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™æ ·å°±å¯¼è‡´æˆ‘ä»¬è·å–åˆ°çš„æ•°æ®ä¸å¯¹äº†ï¼š</p> <p><img src="https://s.poetries.top/uploads/2025/10/f7e50ee36f531bd6.png" alt=""></p> <p>åå°å¹¶ä¸çŸ¥é“<code>a</code>çš„å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒåªä¼šæŒ‰ç…§<code>&amp;</code>æ¥æˆªå–å‚æ•°ã€‚</p> <p>æ‰€ä»¥ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨<strong>URIç¼–ç </strong>ã€‚</p> <p>ä¹Ÿå°±æ˜¯ä½¿ç”¨ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span><span class="token string">'2&amp;b=3'</span><span class="token punctuation">)</span>

<span class="token comment">// ç»“æœä¸º</span>
<span class="token string">"2%26b%3D3"</span>
</code></pre></div><p>åªéœ€è¦æ”¹ä¸€ä¸‹<code>JSONP</code>æ–¹æ³•ä¸­å‚æ•°çš„ç”Ÿæˆï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// å¾—åˆ°'id=1&amp;cb=JSONP.callbacks[1]'</span>
<span class="token keyword">const</span> paramString <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span>
</code></pre></div><p>æ¥çœ‹ä¸€ä¸‹å®Œæ•´ç‰ˆçš„<code>JSONP</code>æ–¹æ³•ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">function</span> <span class="token constant">JSONP</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token punctuation">,</span>
        params <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        callbackKey <span class="token operator">=</span> <span class="token string">'cb'</span><span class="token punctuation">,</span>
        callback
    <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å®šä¹‰æœ¬åœ°çš„å”¯ä¸€callbackIdï¼Œè‹¥æ˜¯æ²¡æœ‰çš„è¯åˆ™åˆå§‹åŒ–ä¸º1</span>
        <span class="token constant">JSONP</span><span class="token punctuation">.</span>callbackId <span class="token operator">=</span> <span class="token constant">JSONP</span><span class="token punctuation">.</span>callbackId <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> callbackId <span class="token operator">=</span> <span class="token constant">JSONP</span><span class="token punctuation">.</span>callbackId<span class="token punctuation">;</span>
        <span class="token comment">// æŠŠè¦æ‰§è¡Œçš„å›è°ƒåŠ å…¥åˆ°JSONå¯¹è±¡ä¸­ï¼Œé¿å…æ±¡æŸ“window</span>
        <span class="token constant">JSONP</span><span class="token punctuation">.</span>callbacks <span class="token operator">=</span> <span class="token constant">JSONP</span><span class="token punctuation">.</span>callbacks <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token constant">JSONP</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">[</span>callbackId<span class="token punctuation">]</span> <span class="token operator">=</span> callback<span class="token punctuation">;</span>
        <span class="token comment">// æŠŠè¿™ä¸ªåç§°åŠ å…¥åˆ°å‚æ•°ä¸­: 'cb=JSONP.callbacks[1]'</span>
        params<span class="token punctuation">[</span>callbackKey<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">JSONP.callbacks[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>callbackId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token comment">// å¾—åˆ°'id=1&amp;cb=JSONP.callbacks[1]'</span>
        <span class="token keyword">const</span> paramString <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>params<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span>
        <span class="token comment">// åˆ›å»º script æ ‡ç­¾</span>
        <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        script<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>paramString<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// idè‡ªå¢ï¼Œä¿è¯å”¯ä¸€</span>
        <span class="token constant">JSONP</span><span class="token punctuation">.</span>callbackId<span class="token operator">++</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token constant">JSONP</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://localhost:8080/api/jsonps'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token string">'2&amp;b=3'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token string">'4'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">callbackKey</span><span class="token operator">:</span> <span class="token string">'cb'</span><span class="token punctuation">,</span>
        <span class="token function">callback</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token constant">JSONP</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://localhost:8080/api/jsonp'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">callbackKey</span><span class="token operator">:</span> <span class="token string">'cb'</span><span class="token punctuation">,</span>
        <span class="token function">callback</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>æ³¨æ„âš ï¸ï¼š</p> <p><code>encodeURI</code>å’Œ<code>encodeURIComponent</code>çš„åŒºåˆ«ï¼š</p> <ul><li><code>encodeURI()</code>ä¸ä¼šå¯¹æœ¬èº«å±äºURIçš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œç¼–ç ï¼Œä¾‹å¦‚å†’å·ã€æ­£æ–œæ ã€é—®å·å’Œäº•å­—å·ï¼›</li> <li>è€Œ<code>encodeURIComponent()</code>åˆ™ä¼šå¯¹å®ƒå‘ç°çš„ä»»ä½•éæ ‡å‡†å­—ç¬¦è¿›è¡Œç¼–ç </li></ul> <p>ä¾‹å¦‚ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">'https://lindaidai.wang'</span>

<span class="token function">encodeURI</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token comment">// "https://lindaidai.wang"</span>

<span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token comment">// "https%3A%2F%2Flindaidai.wang"</span>
</code></pre></div><p>å¦å¤–ï¼Œå¯ä»¥ä½¿ç”¨<code>decodeURIComponent</code>æ¥è§£ç ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">decodeURIComponent</span><span class="token punctuation">(</span><span class="token string">"https%3A%2F%2Flindaidai.wang"</span><span class="token punctuation">)</span>
<span class="token comment">// 'https://lindaidai.wang'</span>
</code></pre></div><h3 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="header-anchor">#</a> å‚è€ƒæ–‡ç« </h3> <ul><li><a href="https://juejin.im/entry/57d11f5967f3560057c3f785" target="_blank" rel="noopener noreferrer">JSONPçš„å®ç°<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <!----> <div class="readMore-wrapper"><span class="readMore">é˜…è¯»å…¨æ–‡</span></div>
                    </div>
                            <p>è¿™æ˜¯ä¸€ä¸ªä¿¡æ¯æç¤ºæ¡†ã€‚</p>
                        </div>

                        <div class="note warning">
                            <div class="note-title"><i class="fas fa-exclamation-triangle"></i> æ³¨æ„</div>
                            <p>è¿™æ˜¯ä¸€ä¸ªè­¦å‘Šæç¤ºæ¡†ã€‚</p>
                        </div>

                        <div class="note success">
                            <div class="note-title"><i class="fas fa-check-circle"></i> æˆåŠŸ</div>
                            <p>è¿™æ˜¯ä¸€ä¸ªæˆåŠŸæç¤ºæ¡†ã€‚</p>
                        </div>

                        <h2>ä»£ç ç¤ºä¾‹</h2>
                        <pre><code class="language-javascript">// ç¤ºä¾‹ä»£ç 
function example() {
    console.log('Hello, FrontendHub!');
}
</code></pre>
                    </div>

                    <!-- æ–‡ç« åº•éƒ¨å¯¼èˆª -->
                    <nav class="article-nav">
                        <a href="#" class="prev-article">
                            <i class="fas fa-chevron-left"></i>
                            <span>ä¸Šä¸€ç¯‡</span>
                        </a>
                        <a href="#" class="next-article">
                            <span>ä¸‹ä¸€ç¯‡</span>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </nav>
                </article>
            </div>
        </div>
    </main>

    <!-- é¡µè„š -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4><i class="fas fa-code"></i> FrontendHub</h4>
                    <p>ä¸“æ³¨äºå‰ç«¯æŠ€æœ¯å­¦ä¹ ä¸é¢è¯•å‡†å¤‡</p>
                </div>
                <div class="footer-section">
                    <h4>å¿«é€Ÿé“¾æ¥</h4>
                    <ul>
                        <li><a href="../../index.html">é¦–é¡µ</a></li>
                        <li><a href="../index.html#courses">è¯¾ç¨‹ä½“ç³»</a></li>
                        <li><a href="../index.html#resources">å­¦ä¹ èµ„æº</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 FrontendHub. ç”¨äºä¸ªäººå­¦ä¹ ä½¿ç”¨.</p>
            </div>
        </div>
    </footer>

    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script src="../../js/main.js"></script>
    <script src="../../js/content.js"></script>
</body>
</html>

