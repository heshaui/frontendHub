<!-- Section: # 30 正则相关 -->
<div class="section-content" data-section-id="_30-正则相关">
<h2 id="_30-正则相关"><a href="#_30-正则相关" class="header-anchor">#</a> 30 正则相关</h2>
<h3 id="_1-实现千位分隔符"><a href="#_1-实现千位分隔符" class="header-anchor">#</a> 1 实现千位分隔符</h3>
<div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 保留三位小数</span>
<span class="token function">parseToMoney</span><span class="token punctuation">(</span><span class="token number">1234.56</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// return '1,234.56'</span>
<span class="token function">parseToMoney</span><span class="token punctuation">(</span><span class="token number">123456789</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// return '123,456,789'</span>
<span class="token function">parseToMoney</span><span class="token punctuation">(</span><span class="token number">1087654.321</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// return '1,087,654.321'</span>
</code></pre></div>
<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">parseToMoney</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  num <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>num<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> <span class="token punctuation">[</span>integer<span class="token punctuation">,</span> decimal<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> <span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  integer <span class="token operator">=</span> integer<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\d(?=(\d{3})+$)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">'</span></code><div class="article-content"><code>
                        <!-- 这里是从原HTML文件中提取的内容 -->
                        <p>这是一个内容页面模板。将原始HTML中的内容放在这里。</p>
                        
                        <h2>示例标题 1</h2>
                        <p>示例内容...</p>
                        
                        <h3>示例子标题 1.1</h3>
                        <p>更多示例内容...</p>

                        </code><div class="note info"><code>
                            <div class="note-title"><i class="fas fa-info-circle"></i> 提示</div>amp;,'<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> integer <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> <span class="token punctuation">(</span>decimal <span class="token operator">?</span> decimal <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></div></div></pre></div>
<h3 id="_2-判断是否是电话号码"><a href="#_2-判断是否是电话号码" class="header-anchor">#</a> 2 判断是否是电话号码</h3>
<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isPhone</span><span class="token punctuation">(</span><span class="token parameter">tel</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> regx <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^1[34578]\d{9}$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> regx<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>tel<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h3 id="_3-验证是否是邮箱"><a href="#_3-验证是否是邮箱" class="header-anchor">#</a> 3 验证是否是邮箱</h3>
<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isEmail</span><span class="token punctuation">(</span><span class="token parameter">email</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> regx <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^([a-zA-Z0-9_\-])+@([a-zA-Z0-9_\-])+(\.[a-zA-Z0-9_\-])+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> regx<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h3 id="_4-验证是否是身份证"><a href="#_4-验证是否是身份证" class="header-anchor">#</a> 4 验证是否是身份证</h3>
<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isCardNo</span><span class="token punctuation">(</span><span class="token parameter">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> regx <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> regx<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h3 id="_5-用正则写一个根据name获取cookie中的值的方法"><a href="#_5-用正则写一个根据name获取cookie中的值的方法" class="header-anchor">#</a> 5 用正则写一个根据name获取cookie中的值的方法</h3>
<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getCookie</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> match <span class="token operator">=</span> document<span class="token punctuation">.</span>cookie<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">'(^| )'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'=([^;]*)'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>match<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">unescape</span><span class="token punctuation">(</span>match<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<ol><li>获取页面上的<code>cookie</code>可以使用 <code>document.cookie</code></li></ol>
<p>这里获取到的是类似于这样的字符串：</p>
<div class="language- extra-class"><pre class="language-text"><code>'username=poetry; user-id=12345; user-roles=home, me, setting'
</code></pre></div>
<p><strong>可以看到这么几个信息：</strong></p>
<ul><li>每一个cookie都是由 <code>name=value</code> 这样的形式存储的</li> <li>每一项的开头可能是一个空串<code>''</code>(比如<code>username</code>的开头其实就是), 也可能是一个空字符串<code>' '</code>（比如<code>user-id</code>的开头就是）</li> <li>每一项用<code>";"</code>来区分</li> <li>如果某项中有多个值的时候，是用<code>","</code>来连接的(比如<code>user-roles</code>的值)</li> <li>每一项的结尾可能是有<code>";"</code>的(比如<code>username</code>的结尾)，也可能是没有的(比如<code>user-roles</code>的结尾)</li></ul>
<ol start="2"><li>所以我们将这里的正则拆分一下：</li></ol>
<ul><li><code>'(^| )'</code>表示的就是获取每一项的开头，因为我们知道如果<code>^</code>不是放在<code>[]</code>里的话就是表示开头匹配。所以这里<code>(^| )</code>的意思其实就被拆分为<code>(^)</code>表示的匹配<code>username</code>这种情况，它前面什么都没有是一个空串(你可以把<code>(^)</code>理解为<code>^</code>它后面还有一个隐藏的<code>''</code>)；而<code>|</code>表示的就是或者是一个<code>" "</code>(为了匹配<code>user-id</code>开头的这种情况)</li> <li><code>+name+</code>这没什么好说的</li> <li><code>=([^;]*)</code>这里匹配的就是<code>=</code>后面的值了，比如<code>poetry</code>；刚刚说了<code>^</code>要是放在<code>[]</code>里的话就表示<code>"除了^后面的内容都能匹配"</code>，也就是非的意思。所以这里<code>([^;]*)</code>表示的是除了<code>";"</code>这个字符串别的都匹配(<code>*</code>应该都知道什么意思吧，匹配0次或多次)</li> <li>有的大佬等号后面是这样写的<code>'=([^;]*)(;|$)'</code>，而最后为什么可以把<code>'(;|$)'</code>给省略呢？因为其实最后一个<code>cookie</code>项是没有<code>';'</code>的，所以它可以合并到<code>=([^;]*)</code>这一步。</li></ul>
<ol start="3"><li>最后获取到的<code>match</code>其实是一个长度为4的数组。比如：</li></ol>
<div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">[</span>
  <span class="token string">"username=poetry;"</span><span class="token punctuation">,</span>
  <span class="token string">""</span><span class="token punctuation">,</span>
  <span class="token string">"poetry"</span><span class="token punctuation">,</span>
  <span class="token string">";"</span>
<span class="token punctuation">]</span>
</code></pre></div>
<ul><li>第0项：全量</li> <li>第1项：开头</li> <li>第2项：中间的值</li> <li>第3项：结尾</li></ul>
<p>所以我们是要拿第2项<code>match[2]</code>的值。</p>
<ol start="4"><li>为了防止获取到的值是<code>%xxx</code>这样的字符序列，需要用<code>unescape()</code>方法解码。</li></ol>
</div>